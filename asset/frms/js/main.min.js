!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){},{}],2:[function(require,module,exports){var $,$inputCover,loadImage,renderImg,resizeCropImg,swal;$=require("../helper/selector.coffee").$,$inputCover=$(".js-input-cover"),swal=require("sweetalert"),loadImage=require("blueimp-load-image-npm"),renderImg=function(img){var $cover,$imgCover,$shadow,$title,height,imgUrl,width;return $imgCover=$(".js-img-cover"),$title=$(".js-article-title"),$shadow=$(".js-cover-shadow"),$cover=$imgCover.parentNode,width=img.width,height=img.height,$imgCover.src=img.toDataURL("image/jpeg",.7),$imgCover.style.width=width+"px",$imgCover.style.height=height+"px",$title.classList.remove("is-with-cover"),$shadow.classList.add("is-hidden"),$cover.removeAttribute("src"),$cover.removeAttribute("style"),$cover.classList.remove("is-cover-full"),$cover.classList.remove("is-cover-not-full"),$imgCover.classList.remove("is-hidden"),$imgCover.setAttribute("data-width",width),$imgCover.setAttribute("data-height",height),width>=1200&&2.2>width/height?($cover.classList.add("is-cover-full"),$title.classList.add("is-with-cover"),$shadow.classList.remove("is-hidden"),imgUrl=$imgCover.getAttribute("src"),$imgCover.classList.add("is-hidden"),$cover.style.backgroundImage="url('"+imgUrl+"')",$cover.style.backgroundSize="cover"):$cover.classList.add("is-cover-not-full"),$(".js-del-cover").classList.remove("is-hidden"),$(".js-cover").classList.remove("is-not-cover"),$inputCover.value=""},resizeCropImg=function(img){var height,options,width;return null==img.toDataURL?(swal({type:"error",title:"error",allowOutsideClick:!0}),!1):(options={},options.canvas=!0,width=img.width,height=img.height,width>=1920?options.maxWidth=1920:width>=1440?options.maxWidth=1440:width>=1200?options.maxWidth=1200:width>=960?options.maxWidth=960:width>=640&&(options.maxWidth=640),loadImage(img.toDataURL(),renderImg,options))},module.exports=function(){return loadImage($inputCover.files[0],resizeCropImg,{canvas:!0})}},{"../helper/selector.coffee":17,"blueimp-load-image-npm":21,sweetalert:31}],3:[function(require,module,exports){var $,$$,$editable,biRegex,blockRegex,em,p,ref,ref1,setCaret,strong,text,toggleCenter;ref=require("../helper/elementList.coffee"),p=ref.p,text=ref.text,strong=ref.strong,em=ref.em,ref1=require("../helper/selector.coffee"),$=ref1.$,$$=ref1.$$,setCaret=require("../helper/setCaret.coffee"),$editable=document.querySelector(".js-editable"),biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,blockRegex=/^(H1|H2|H3|P|BLOCKQUOTE|TEXTAREA|PRE)$/,toggleCenter=function($el){return biRegex.test($el.nodeName)&&($el=$el.parentNode,biRegex.test($el.nodeName)&&($el=$el.parentNode,biRegex.test($el.nodeName)&&($el=$el.parentNode,biRegex.test($el.nodeName)&&($el=$el.parentNode)))),blockRegex.test($el.nodeName)?$el.classList.toggle("is-center"):console.log},module.exports=function(){var $beginParent,$child,$endParent,i,isList,len,ref2,results,selection;if(selection=window.getSelection(),$beginParent=selection.anchorNode.parentNode,$endParent=selection.focusNode.parentNode,$beginParent===$endParent)return toggleCenter($beginParent);for(isList=!1,ref2=$editable.childNodes,results=[],i=0,len=ref2.length;len>i;i++)$child=ref2[i],selection.containsNode($child,!0)&&$child.innerHTML?results.push(toggleCenter($child)):results.push(void 0);return results}},{"../helper/elementList.coffee":15,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],4:[function(require,module,exports){var $,$editable,biRegex,blockquote1,blockquote2,code,getCaret,h2,h3,hangingPunc,p,ref,selectBlock,setCaret,setSelection;getCaret=require("../helper/getCaret.coffee"),setCaret=require("../helper/setCaret.coffee"),setSelection=require("../helper/setSelection.coffee"),hangingPunc=require("../normalize/hangingPunc.coffee"),ref=require("../helper/elementList.coffee"),p=ref.p,h2=ref.h2,h3=ref.h3,blockquote1=ref.blockquote1,blockquote2=ref.blockquote2,code=ref.code,$=require("../helper/selector.coffee").$,$editable=$(".js-editable"),biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,selectBlock=function($newEl){var $newElBegin,$newElLast;$newElBegin=$newEl,biRegex.test($newElBegin.firstChild.nodeName)&&($newElBegin=$newElBegin.firstChild,biRegex.test($newElBegin.firstChild.nodeName)&&($newElBegin=$newElBegin.firstChild,biRegex.test($newElBegin.firstChild.nodeName)&&($newElBegin=$newElBegin.firstChild,biRegex.test($newElBegin.firstChild.nodeName)&&($newElBegin=$newElBegin.firstChild)))),$newElLast=$newEl,biRegex.test($newElLast.lastChild.nodeName)&&($newElLast=$newElLast.lastChild,biRegex.test($newElLast.lastChild.nodeName)&&($newElLast=$newElLast.lastChild,biRegex.test($newElLast.lastChild.nodeName)&&($newElLast=$newElLast.lastChild,biRegex.test($newElLast.lastChild.nodeName)&&($newElLast=$newElLast.lastChild))));try{return hangingPunc(),setSelection($newElBegin.firstChild,0,$newElLast.lastChild,$newElLast.lastChild.textContent.length)}catch(undefined){}},module.exports=function(type){var $beginEl,$endEl,$newEl,beginOffset,eType,endOffset,hElement,ref1,ref2,selection;if(null==type&&(type=1),selection=window.getSelection(),$beginEl=selection.anchorNode,$endEl=selection.focusNode,beginOffset=selection.anchorOffset,endOffset=selection.focusOffset,hElement=h2(),eType="H2",1===type)hElement=h2(),eType="H2";else if(2===type)hElement=h3(),eType="H3";else if(3===type)hElement=blockquote1(),eType="BLOCKQUOTE";else if(4===type)hElement=blockquote2(),eType="BLOCKQUOTE";else{if(5!==type)return;hElement=code(),eType="PRE"}if(null!=(ref1=$beginEl.parentNode.firstChild.classList)?!ref1.contains("is-drop-cap"):!0){if(0===$beginEl.textContent.length)return $newEl=$beginEl.nodeName===eType?p():hElement,$newEl.innerHTML="<br>",$beginEl.parentNode.replaceChild($newEl,$beginEl),setCaret($newEl.lastChild,0);if($beginEl.parentNode.nodeName===eType)return $newEl=p(),$beginEl.parentNode.classList.contains("is-second")?3===type&&($newEl=blockquote1()):$beginEl.parentNode.classList.contains("is-second")||4===type&&($newEl=blockquote2()),$beginEl.parentNode.classList.contains("is-center")&&$newEl.classList.add("is-center"),$newEl.innerHTML=$beginEl.parentNode.innerHTML,$editable.replaceChild($newEl,$beginEl.parentNode),selectBlock($newEl);if(biRegex.test($beginEl.parentNode.nodeName)){if($newEl=hElement,$beginEl=$beginEl.parentNode,biRegex.test($beginEl.parentNode.nodeName)&&($beginEl=$beginEl.parentNode,biRegex.test($beginEl.parentNode.nodeName)&&($beginEl=$beginEl.parentNode)),null!=(ref2=$beginEl.parentNode.firstChild.classList)?ref2.contains("is-drop-cap"):void 0)return;return $beginEl.parentNode.nodeName===eType&&($newEl=p()),$beginEl.parentNode.classList.contains("is-center")&&$newEl.classList.add("is-center"),$newEl.innerHTML=$beginEl.parentNode.innerHTML,$editable.replaceChild($newEl,$beginEl.parentNode),selectBlock($newEl)}return/^(P|BLOCKQUOTE|H2|H3|PRE)$/.test($beginEl.parentNode.nodeName)?($newEl=hElement,$newEl.innerHTML=$beginEl.parentNode.innerHTML,"#text"!==$beginEl.nodeName?($newEl.innerHTML=$beginEl.innerHTML,$editable.replaceChild($newEl,$beginEl)):($beginEl.parentNode.classList.contains("is-center")&&$newEl.classList.add("is-center"),$editable.replaceChild($newEl,$beginEl.parentNode)),selectBlock($newEl)):void 0}}},{"../helper/elementList.coffee":15,"../helper/getCaret.coffee":16,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18,"../helper/setSelection.coffee":19,"../normalize/hangingPunc.coffee":35}],5:[function(require,module,exports){var $,$$,$editable,boldItalic,ref,setSelection;ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,setSelection=require("../helper/setSelection.coffee"),$editable=$(".js-editable"),boldItalic=function(tag){return"bold"===tag?document.execCommand("bold"):"italic"===tag?document.execCommand("italic"):void 0},module.exports=function(tag){var $beginParent,$child,$endParent,anchorNode,anchorOffset,beginCaret,elRegex,endCaret,focusNode,focusOffset,i,isHeading,j,k,l,len,ref1,ref2,ref3,ref4,selection;for(selection=window.getSelection(),document.execCommand("StyleWithCSS",!1,!1),elRegex=/^(B|I|STRONG|EM|P|A|BLOCKQUOTE|UL|OL|FIGURE|PRE)$/,anchorNode=selection.anchorNode,focusNode=selection.focusNode,anchorOffset=selection.anchorOffset,focusOffset=selection.focusOffset,$beginParent=anchorNode.parentNode,$endParent=focusNode.parentNode,beginCaret=anchorOffset,endCaret=focusOffset,i=j=ref1=anchorOffset;j>=0&&(beginCaret=i+1,!/^( |\-|&)$/.test(anchorNode.textContent[i]));i=j+=-1);if(/^( |\-|&)$/.test(focusNode.textContent[focusOffset-1]))endCaret=focusOffset-1;else for(i=k=ref2=focusOffset,ref3=focusNode.textContent.length;(ref3>=ref2?ref3>=k:k>=ref3)&&(endCaret=i,!/^( |\-|&)$/.test(focusNode.textContent[i]));i=ref3>=ref2?++k:--k);for(1===beginCaret&&beginCaret--,endCaret===focusNode.textContent.length&&endCaret--,setSelection(anchorNode,beginCaret,focusNode,endCaret+1),isHeading=!1,ref4=$editable.childNodes,l=0,len=ref4.length;len>l;l++)$child=ref4[l],selection.containsNode($child,!0)&&$child.innerHTML&&(elRegex.test($child.nodeName)||(isHeading=!0));return isHeading!==!0?boldItalic(tag):console.log("heading gak bisa di bold / italic")}},{"../helper/selector.coffee":17,"../helper/setSelection.coffee":19}],6:[function(require,module,exports){var $,$$,$editable,$tt,makeTooltip,ref,removeTooltip,setSelection,swal;ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,setSelection=require("../helper/setSelection.coffee"),$editable=$(".js-editable"),swal=require("sweetalert"),$tt=$(".js-tooltip-link"),makeTooltip=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;return bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$tt.innerHTML=""+el.href,$tt.style.display="block",$tt.style.top=topPos+height+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},removeTooltip=function($tt){return $tt.style.display="none"},module.exports=function(){var $beginParent,$endParent,anchorNode,anchorOffset,beginCaret,biRegex,elRegex,endCaret,focusNode,focusOffset,i,j,k,ref1,ref2,ref3,selection;for(selection=window.getSelection(),document.execCommand("StyleWithCSS",!1,!1),biRegex=/^(B|I|STRONG|EM|SPAN)$/,elRegex=/^(P|BLOCKQUOTE|FIGCAPTION|LI|UL|OL)$/,anchorNode=selection.anchorNode,focusNode=selection.focusNode,anchorOffset=selection.anchorOffset,focusOffset=selection.focusOffset,$beginParent=anchorNode.parentNode,$endParent=focusNode.parentNode,beginCaret=anchorOffset,endCaret=focusOffset,i=j=ref1=anchorOffset;j>=0&&(beginCaret=i+1," "!==anchorNode.textContent[i]);i=j+=-1);if(" "===focusNode.textContent[focusOffset-1])endCaret=focusOffset-1;else for(i=k=ref2=focusOffset,ref3=focusNode.textContent.length;(ref3>=ref2?ref3>=k:k>=ref3)&&(endCaret=i," "!==focusNode.textContent[i]);i=ref3>=ref2?++k:--k);return 1===beginCaret&&beginCaret--,endCaret===focusNode.textContent.length&&endCaret--,setSelection(anchorNode,beginCaret,focusNode,endCaret+1),biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode))),biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode,biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode,biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode))),"A"===$beginParent.nodeName?document.execCommand("unlink"):$beginParent===$endParent&&elRegex.test($beginParent.nodeName)?swal({title:"Insert link",text:"Link must valid",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"ex: framesia.com",allowOutsideClick:!0},function(inputValue){var $link,l,len,ref4,results;if(setSelection(anchorNode,beginCaret,focusNode,endCaret+1),inputValue===!1)return!1;if(""===inputValue)return!1;if(/^https?/.test(inputValue)||(inputValue="http://"+inputValue),/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(inputValue)){for(document.execCommand("createLink",!1,inputValue),swal.close(),ref4=$$(".js-editable a"),results=[],l=0,len=ref4.length;len>l;l++)$link=ref4[l],$link.addEventListener("mouseover",function(e){return makeTooltip($tt,this)}),results.push($link.addEventListener("mouseleave",function(e){return removeTooltip($tt)}));return results}return swal.showInputError("Not valid link!"),!1}):void 0}},{"../helper/selector.coffee":17,"../helper/setSelection.coffee":19,sweetalert:31}],7:[function(require,module,exports){var $,$$,$editable,biRegex,cap,ref,setCaret;cap=require("../helper/elementList.coffee").cap,ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,setCaret=require("../helper/setCaret.coffee"),$editable=$(".js-editable"),biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,module.exports=function(){var $beginParent,$cap,$endParent,$firstChild,capText,firstText,ref1,selection;if(selection=window.getSelection(),$beginParent=selection.anchorNode.parentNode,$endParent=selection.focusNode.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode)))),"P"===$beginParent.nodeName){if(null!=(ref1=$beginParent.firstChild.classList)?ref1.contains("is-drop-cap"):void 0)return capText=$beginParent.firstChild.textContent,$beginParent.removeChild($beginParent.firstChild),$firstChild=$beginParent.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild)))),firstText=$firstChild.textContent,$firstChild.nodeValue=capText+firstText;if(/^[A-Za-z0-9]/.test($beginParent.textContent))return $firstChild=$beginParent.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild,biRegex.test($firstChild.nodeName)&&($firstChild=$firstChild.firstChild)))),$cap=cap(),$cap.innerHTML=$beginParent.textContent[0].toUpperCase(),firstText=$firstChild.textContent,$firstChild.nodeValue=firstText.slice(1,+firstText.length+1||9e9),$beginParent.insertBefore($cap,$beginParent.firstChild)}}},{"../helper/elementList.coffee":15,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],8:[function(require,module,exports){var $,$$,$editable,$tt,$ttLink,alignImage,makeImageControl,makeTooltip,ref,removeTooltip;ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,$editable=$(".js-editable"),$tt=$(".js-tooltip-image"),$ttLink=$(".js-tooltip-link"),makeTooltip=function(e){var bodyRect,el,height,leftPos,linkRect,topPos,widthToCenter;return $ttLink=$(".js-tooltip-link"),el=e.target,bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$ttLink.innerHTML=""+el.href,el.getAttribute("data-href")&&($ttLink.innerHTML=""+el.getAttribute("data-href")),$ttLink.style.display="block",$ttLink.style.top=topPos+height+"px",$ttLink.style.left=leftPos+widthToCenter+"px",$ttLink.style.marginLeft="-"+$ttLink.offsetWidth/2+"px"},removeTooltip=function(){return $ttLink=$(".js-tooltip-link"),$ttLink.style.display="none"},makeImageControl=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;return bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$tt.style.display="block",$tt.style.top=topPos+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},alignImage=function(type){var $imgSelected;return $imgSelected=$(".is-img.is-selected"),$imgSelected.removeAttribute("width"),$imgSelected.removeAttribute("height"),$imgSelected.parentNode.classList.contains("b-figure--multi")||($imgSelected.parentNode.classList.remove("b-figure--left"),$imgSelected.parentNode.classList.remove("b-figure--center"),$imgSelected.parentNode.classList.remove("b-figure--full"),$imgSelected.parentNode.classList.remove("b-figure--right"),$imgSelected.parentNode.classList.add("b-figure--"+type)),$tt.style.display="none"},$(".js-img-left").addEventListener("click",function(e){return alignImage("left")}),$(".js-img-center").addEventListener("click",function(e){return alignImage("center")}),$(".js-img-right").addEventListener("click",function(e){return alignImage("right")}),$(".js-img-link").addEventListener("click",function(e){var $imgSelected;return $imgSelected=$(".is-img.is-selected"),$imgSelected.classList.contains("is-link")?($imgSelected.removeEventListener("mouseover",makeTooltip),$imgSelected.removeEventListener("mouseleave",removeTooltip),$imgSelected.removeAttribute("data-href"),$imgSelected.classList.remove("is-link"),$tt.style.display="none"):swal({title:"Masukkan Link",text:"Linknya harus yang valid ya :D",type:"input",showCancelButton:!0,closeOnConfirm:!1,animation:"slide-from-top",inputPlaceholder:"misalnya damaera.com",allowOutsideClick:!0},function(inputValue){return $tt.style.display="none",inputValue===!1?!1:""===inputValue?!1:(/^https?$/.test(inputValue)||(inputValue="http://"+inputValue),/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(inputValue)?($imgSelected.classList.add("is-link"),$imgSelected.setAttribute("data-href",inputValue),swal.close(),$imgSelected.addEventListener("mouseover",makeTooltip),$imgSelected.addEventListener("mouseleave",removeTooltip)):(swal.showInputError("Bukan Link yang valid!"),!1))})}),$(".js-img-full").addEventListener("click",function(e){return alignImage("full")}),$(".js-img-del").addEventListener("click",function(e){var $figure,$imgSelected;return $imgSelected=$(".is-img.is-selected"),$figure=$imgSelected.parentNode,$figure.removeChild($imgSelected),"IMG"!==$figure.firstChild.nodeName?$editable.removeChild($figure):$figure.childNodes.length>2?reposition($figure):(reposition($figure),$figure.width="auto",$figure.height="auto",$figure.classList.remove("b-figure--multi"),$figure.classList.add("b-figure--center")),$tt.style.display="none"})},{"../helper/selector.coffee":17}],9:[function(require,module,exports){},{}],10:[function(require,module,exports){var $,$$,$editable,biRegex,blockRegex,hr,p,ref,ref1,setCaret;ref=require("../helper/elementList.coffee"),hr=ref.hr,p=ref.p,ref1=require("../helper/selector.coffee"),$=ref1.$,$$=ref1.$$,setCaret=require("../helper/setCaret.coffee"),$editable=$(".js-editable"),biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,blockRegex=/^(H1|H2|H3|P|BLOCKQUOTE|LI|UL|OL)$/,module.exports=function(){var $beginParent,$endParent,$newHr,$newP,selection;return selection=window.getSelection(),$beginParent=selection.anchorNode.parentNode,$endParent=selection.focusNode.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode)))),"LI"===$beginParent.nodeName&&($beginParent=$beginParent.parentNode),$newHr=hr(),$newP=p(),$newP.innerHTML="<br>",null!=$beginParent.nextSibling?"HR"===$beginParent.nextSibling.nodeName?$editable.removeChild($beginParent.nextSibling):$editable.contains($beginParent)&&$editable.insertBefore($newHr,$beginParent.nextSibling):($editable.appendChild($newHr),$editable.appendChild($newP)),setCaret(selection.anchorNode,selection.anchorOffset)}},{"../helper/elementList.coffee":15,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],11:[function(require,module,exports){var $,$$,$editable,$inputImg,biRegex,figure,loadImage,makeImageControl,p,ref,ref1,removeImageControl,setSelection;ref=require("../helper/elementList.coffee"),figure=ref.figure,p=ref.p,ref1=require("../helper/selector.coffee"),$=ref1.$,$$=ref1.$$,setSelection=require("../helper/setSelection.coffee"),loadImage=require("blueimp-load-image-npm"),$editable=$(".js-editable"),biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,$inputImg=$(".js-input-img"),makeImageControl=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;return bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$tt.style.display="block",$tt.style.top=topPos+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},removeImageControl=function($tt){return $tt.style.display="none"},module.exports=function(){var $beginEl,$beginParent,$endEl,$endParent,resizeImg,selection;return $editable.addEventListener("click",function(e){var $imgSelected,i,len,ref2;if("IMG"!==e.target.nodeName){for(ref2=$$(".is-img.is-selected"),i=0,len=ref2.length;len>i;i++)$imgSelected=ref2[i],$imgSelected.classList.remove("is-selected");return removeImageControl($(".js-tooltip-image"))}}),$editable.addEventListener("keyup",function(e){return removeImageControl($(".js-tooltip-image"))}),selection=window.getSelection(),$beginEl=selection.anchorNode,$beginParent=$beginEl.parentNode,$endEl=selection.focusNode,$endParent=selection.focusNode.parentNode,biRegex.test($beginParent.nodeName)&&($beginEl=$beginParent,$beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginEl=$beginParent,$beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginEl=$beginParent,$beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginEl=$beginParent,$beginParent=$beginParent.parentNode)))),"LI"===$beginParent.nodeName&&($beginParent=$beginParent.parentNode),resizeImg=function(img){var $img,$newFigure,$newP,i,len,ref2;if(null==img.toDataURL)return swal({type:"error",title:"error"}),!1;for($newFigure="",$newFigure=img.width>=960?figure("full",img):img.width>=640?figure("center",img):figure("left",img),ref2=$newFigure.childNodes,i=0,len=ref2.length;len>i;i++)$img=ref2[i],"IMG"===$img.nodeName&&$img.addEventListener("click",function(e){var $imgSelected,j,len1,ref3;for(ref3=$$(".is-img.is-selected"),j=0,len1=ref3.length;len1>j;j++)$imgSelected=ref3[j],$imgSelected.classList.remove("is-selected");return this.classList.add("is-selected"),makeImageControl($(".js-tooltip-image"),this)});return $newP=p(),$newP.innerHTML="<br>",$beginParent===$editable?$beginEl===$editable.lastChild?($editable.replaceChild($newFigure,$beginEl),$editable.appendChild($newP)):$editable.replaceChild($newFigure,$beginEl):$editable.insertBefore($newFigure,$beginParent),setSelection($newFigure.lastChild,0,$newFigure.lastChild.lastChild,$newFigure.lastChild.textContent.length),$(".js-input-img").value=""},loadImage($inputImg.files[0],resizeImg,{canvas:!0,maxWidth:960})}},{"../helper/elementList.coffee":15,"../helper/selector.coffee":17,"../helper/setSelection.coffee":19,"blueimp-load-image-npm":21}],12:[function(require,module,exports){var p,setCaret;p=require("../helper/elementList.coffee").p,setCaret=require("../helper/setCaret.coffee"),module.exports=function(){var $beginParent,anchorNode,docId,embedText,fbPostEmbed,fbPostRegex,fbUser,fbVideEmbed,fbVideoRegex,formId,gdocEmbed,gdocRegex,gformEmbed,gformRegex,gmapData,gmapEmbed,gmapRegex,gsheetEmbed,gsheetRegex,gslideEmbed,gslideRegex,postId,punc,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9,scArtist,scEmbed,scRegex,scSong,selection,setEmbed,sheetId,slideId,text,twitEmbed,twitId,twitRegex,twitUser,videoId,w,ytEmbed,ytId,ytRegex;if(selection=window.getSelection(),anchorNode=selection.anchorNode,$beginParent=selection.anchorNode.parentNode,embedText=$beginParent.textContent,setEmbed=function(html){var $p,tmp;return tmp=document.createElement("P"),tmp.innerHTML=html,$p=p(),$p.innerHTML="<br>",""===embedText?($beginParent.parentNode.replaceChild($p,$beginParent),$p.parentNode.insertBefore(tmp.firstChild,$p),setCaret($p,0)):($beginParent.innerHTML="<br>",$beginParent.parentNode.insertBefore(tmp.firstChild,$beginParent),setCaret($beginParent,0))},"P"===$beginParent.nodeName){if(ytRegex=/^https?:\/\/(www\.)?youtube\.com\/watch\?v=([a-zA-Z0-9_-]+)/,scRegex=/^https?:\/\/(www\.)?soundcloud\.com\/([0-9a-z_-]+)\/([0-9a-z-]+)/,twitRegex=/^https?:\/\/(www\.)?twitter\.com\/([A-Za-z0-9_]+)\/status\/([0-9]+)/,fbPostRegex=/^https?:\/\/(www\.)?facebook\.com\/([A-Za-z0-9\.]+)\/posts\/([0-9]+)/,fbVideoRegex=/^https?:\/\/(www\.)?facebook\.com\/([A-Za-z0-9\.]+)\/videos\/([0-9]+)/,gformRegex=/^https?:\/\/docs\.google\.com\/forms\/d\/([0-9a-zA-Z-_]+)/,gdocRegex=/^https?:\/\/docs\.google\.com\/document\/d\/([0-9a-zA-Z-_]+)/,gsheetRegex=/^https?:\/\/docs\.google\.com\/spreadsheets\/d\/([0-9a-zA-Z-_]+)/,gslideRegex=/^https?:\/\/docs\.google\.com\/presentation\/d\/([0-9a-zA-Z-_]+)/,gmapRegex=/^<iframe src=("|“)https?:\/\/(www\.)?google\.com\/maps\/embed\?([A-Za-z0-9=!\.\%\+\-]+)(.*)<\/iframe>$/,ytRegex.test(embedText))return ref=ytRegex.exec(embedText),text=ref[0],w=ref[1],ytId=ref[2],ytEmbed="<iframe class='b-graf b-graf--frame--yt' contentEditable='false' width='100%' src='https://www.youtube.com/embed/"+ytId+"' frameborder='0' data-frame-id='"+ytId+"' data-origin='youtube'></iframe>",setEmbed(ytEmbed);if(scRegex.test(embedText))return ref1=scRegex.exec(embedText),text=ref1[0],w=ref1[1],scArtist=ref1[2],scSong=ref1[3],scEmbed="<iframe class='b-graf b-graf--frame--sc'  contentEditable='false' width='100%' height='166' scrolling='no' frameborder='no' data-frame-id='"+scArtist+"/"+scSong+"' data-origin='soundcloud' src='https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/"+scArtist+"/"+scSong+"&amp;color=F2635E&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false'></iframe>",setEmbed(scEmbed);if(twitRegex.test(embedText))return ref2=twitRegex.exec(embedText),text=ref2[0],w=ref2[1],twitUser=ref2[2],twitId=ref2[3],twitEmbed="<iframe class='b-graf b-graf--frame--twit' contentEditable='false' border=0 frameborder=0 data-frame-id='"+twitId+"' data-origin='twitter' src='/e/twitter?id="+twitId+"' width='100%' onload='resizeIframe(this)'></iframe>",setEmbed(twitEmbed);if(fbPostRegex.test(embedText))return ref3=fbPostRegex.exec(embedText),text=ref3[0],w=ref3[1],fbUser=ref3[2],postId=ref3[3],fbPostEmbed="<iframe class='b-graf b-graf--frame--fb-post' contentEditable='false' border=0 frameborder=0 data-frame-id='"+fbUser+"/"+postId+"' data-origin='facebook-post' src='/e/fb-post?user="+fbUser+"+id="+postId+"' width='100%' onload='resizeIframe(this)'></iframe>",setEmbed(fbPostEmbed);if(fbVideoRegex.test(embedText))return ref4=fbVideoRegex.exec(embedText),text=ref4[0],w=ref4[1],fbUser=ref4[2],videoId=ref4[3],fbVideEmbed="<iframe class='b-graf b-graf--frame--fb-post' contentEditable='false' border=0 frameborder=0 data-frame-id='"+fbUser+"/"+videoId+"' data-origin='facebook-video' src='/e/fb-video?user="+fbUser+"+id="+videoId+"' width='640' height='360'></iframe>",setEmbed(fbVideEmbed);if(gmapRegex.test(embedText))return ref5=gmapRegex.exec(embedText),text=ref5[0],punc=ref5[1],w=ref5[2],gmapData=ref5[3],gmapEmbed="<iframe class='b-graf b-graf--frame--gmap' contentEditable='false' data-src='"+gmapData+"' data-frame-id='"+gmapData+"' data-origin='google-map' src='https://www.google.com/maps/embed?"+gmapData+"' width='100%' height='450' frameborder=0 style='border:0;' allowfullscreen></iframe>",setEmbed(gmapEmbed);if(gsheetRegex.test(embedText))return ref6=gsheetRegex.exec(embedText),text=ref6[0],sheetId=ref6[1],gsheetEmbed="<iframe class='b-graf b-graf--frame--gsheet' contentEditable='false' data-frame-id='"+sheetId+"' data-origin='google-sheet' src='https://docs.google.com/spreadsheets/d/"+sheetId+"/pubhtml?widget=true&amp;headers=false' width='100%' height='450' frameborder=0 marginheight=0 marginwidth=0></iframe>",setEmbed(gsheetEmbed);if(gslideRegex.test(embedText))return ref7=gslideRegex.exec(embedText),text=ref7[0],slideId=ref7[1],gslideEmbed="<iframe class='b-graf b-graf--frame--gslide' contentEditable='false' data-frame-id='"+slideId+"' data-origin='google-slide' src='https://docs.google.com/presentation/d/"+slideId+"/embed?start=false&loop=false' allowfullscreen='true' mozallowfullscreen='true' webkitallowfullscreen='true' width='100%' height='389' frameborder=0 marginheight=0 marginwidth=0></iframe>",setEmbed(gslideEmbed);if(gdocRegex.test(embedText))return ref8=gdocRegex.exec(embedText),text=ref8[0],docId=ref8[1],console.log(docId),gdocEmbed="<iframe class='b-graf b-graf--frame--gdoc' contentEditable='false' data-frame-id='"+docId+"' data-origin='google-doc' src='https://docs.google.com/document/d/"+docId+"/pub?embedded=true' width='100%' height='450' frameborder=0 marginheight=0 marginwidth=0></iframe>",setEmbed(gdocEmbed);if(gformRegex.test(embedText))return ref9=gformRegex.exec(embedText),text=ref9[0],formId=ref9[1],gformEmbed="<iframe class='b-graf b-graf--frame--gform' contentEditable='false' data-frame-id='"+formId+"' data-origin='google-form' src='https://docs.google.com/forms/d/"+formId+"/viewform?embedded=true' width='100%' height='450' frameborder=0 marginheight=0 marginwidth=0></iframe>",setEmbed(gformEmbed)}}},{"../helper/elementList.coffee":15,"../helper/setCaret.coffee":18}],13:[function(require,module,exports){var li,ol,ref,setCaret,ul;ref=require("../helper/elementList.coffee"),ul=ref.ul,ol=ref.ol,li=ref.li,setCaret=require("../helper/setCaret.coffee"),module.exports=function(type){var $newEl,$thisElParent,innerText,selection;if(selection=window.getSelection(),$thisElParent=selection.anchorNode.parentNode,"P"===$thisElParent.nodeName){if(/^(\-&nbsp;|\+&nbsp;|\*&nbsp;)$/.test($thisElParent.innerHTML))$newEl=ul(),$newEl.innerHTML="<li><br></li>",$thisElParent.parentNode.replaceChild($newEl,$thisElParent);else if(/^(1\.&nbsp;)$/.test($thisElParent.innerHTML))$newEl=ol(),$newEl.innerHTML="<li><br></li>",$thisElParent.parentNode.replaceChild($newEl,$thisElParent);else if(/^(\- |\+ |\* )/.test($thisElParent.textContent))$newEl=ul(),innerText=$thisElParent.innerHTML.slice(2),$newEl.innerHTML="<li>"+innerText+"</li>",$thisElParent.parentNode.replaceChild($newEl,$thisElParent);else{if(!/^(1\. )/.test($thisElParent.textContent))return;$newEl=ol(),innerText=$thisElParent.innerHTML.slice(2),$newEl.innerHTML="<li>"+innerText+"</li>",$thisElParent.parentNode.replaceChild($newEl,$thisElParent)}return setCaret($newEl.firstChild.firstChild,0)}}},{"../helper/elementList.coffee":15,"../helper/setCaret.coffee":18}],14:[function(require,module,exports){var $,$$,$editable,$imgCover,$title,$titleParent,blockquote1,blockquote2,cap,code,figure,h2,h3,hr,li,loadImage,ol,p,purifyHtml,purifyImage,ref,ref1,toDom,toJson,ul;ref=require("./helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("./helper/elementList.coffee"),p=ref1.p,h2=ref1.h2,h3=ref1.h3,blockquote1=ref1.blockquote1,blockquote2=ref1.blockquote2,ul=ref1.ul,ol=ref1.ol,li=ref1.li,code=ref1.code,cap=ref1.cap,hr=ref1.hr,figure=ref1.figure,$editable=$(".js-editable"),$title=$(".js-title-input"),$imgCover=$(".js-img-cover"),$titleParent=$title.parentNode,
loadImage=require("blueimp-load-image-npm"),purifyHtml=function(html){return html.replace(/</g,"&lt;").replace(/&lt;(br)(.*?)>/g,"<br>").replace(/&lt;span (.*?)>[A-Z]/g,"").replace(/&lt;\/span>/g,"").replace(/&lt;(b|strong)>/g,"<strong>").replace(/&lt;\/(b|strong)>/g,"</strong>").replace(/&lt;(i|em)>/g,"<em>").replace(/&lt;\/(i|em)>/g,"</em>").replace(/&lt;a(.*?)href="((https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?)"(.*?)>/g,'<a href="$2">').replace(/&lt;\/a(.*?)>/g,"</a>")},purifyImage=function(data){return/data:image\/(jpeg|png);base64,\/(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})/},toDom=function(json){var $cap,$el,$li,i,item,j,k,len,len1,len2,list,ref2,ref3,ref4,tmpDom;for(tmpDom=document.createElement("DIV"),$title.value=json.title,json.isTitleCenter?$title.classList.add("is-center"):$title.classList.remove("is-center"),json.isCover?($imgCover.src=json.img[0].data,$(".js-del-cover").classList.remove("is-hidden"),$imgCover.parentNode.classList.remove("is-not-cover"),$imgCover.style.width=json.cover.width+"px",$imgCover.style.height=json.cover.height+"px"):($imgCover.removeAttribute("src"),$imgCover.removeAttribute("style"),$imgCover.parentNode.classList.add("is-not-cover"),$(".js-del-cover").classList.add("is-hidden")),ref2=json.data,i=0,len=ref2.length;len>i;i++){if(item=ref2[i],"P"===item.type)$el=p(),$el.innerHTML=item.content,item.isDropCap&&($cap=cap(),$cap.innerHTML=item.dropCapChar[0],$el.insertBefore($cap,$el.firstChild));else if("H2"===item.type)$el=h2(),$el.innerHTML=item.content;else if("H3"===item.type)$el=h3(),$el.innerHTML=item.content;else if("QUOTE1"===item.type)$el=blockquote1(),$el.innerHTML=item.content;else if("QUOTE2"===item.type)$el=blockquote2(),$el.innerHTML=item.content;else if("PRE"===item.type)$el=code(),$el.innerHTML=item.content;else if("HR"===item.type)$el=hr(),$el.innerHTML=item.content;else if("FIGURE"===item.type)item.img.data=json.img[item.img.id].data,$el=figure(item.figureAlign,item.img,item.caption);else if("UL"===item.type)for($el=ul(),ref3=item.list,j=0,len1=ref3.length;len1>j;j++)list=ref3[j],$li=li(),$li.innerHTML=list,$el.appendChild($li);else if("OL"===item.type)for($el=ol(),ref4=item.list,k=0,len2=ref4.length;len2>k;k++)list=ref4[k],$li=li(),$li.innerHTML=list,$el.appendChild($li);item.center&&$el.classList.add("is-center"),1===item.indent?$el.classList.add("is-indent1"):2===item.indent&&$el.classList.add("is-indent2"),tmpDom.appendChild($el)}return $editable.innerHTML=tmpDom.innerHTML},window.coverChanged=!1,toJson=function(){var $child,$grandChild,$img,data,domJson,i,imgCount,imgHeight,imgId,imgWidth,imgs,j,k,l,len,len1,len2,len3,len4,link,m,maxImgId,ref2,ref3,ref4,ref5,ref6,ref7,ref8;if(domJson={isCoverChanged:!1,isTitleCenter:!1,title:$title.value,isCover:!1,cover:{},data:[],img:[]},domJson.isCoverChanged=window.coverChanged,imgs=[],imgCount=-1,$("img.is-saved")){for(maxImgId=-1,ref2=$$("img.is-saved"),i=0,len=ref2.length;len>i;i++)$img=ref2[i],imgId=1*$img.getAttribute("image-id"),imgId>maxImgId&&(maxImgId=imgId);imgCount=maxImgId}for($titleParent.classList.contains("is-center")&&(domJson.isTitleCenter=!0),window.coverChanged===!0&&""!==$imgCover.src&&(domJson.isCover=!0,domJson.cover={width:$imgCover.getAttribute("data-width"),height:$imgCover.getAttribute("data-height"),data:$imgCover.src}),ref3=$editable.childNodes,j=0,len1=ref3.length;len1>j;j++)if($child=ref3[j],"#text"!==$child.nodeName&&"#comment"!==$child.nodeName){if($child.classList.contains("is-placeholder"))continue;if(data={},$child.classList.contains("is-center")&&(data.center=!0),$child.classList.contains("is-indent2")?data.indent=2:$child.classList.contains("is-indent1")&&(data.indent=1),"H2"===$child.nodeName)data.type="H2",data.content=purifyHtml($child.innerHTML);else if("H3"===$child.nodeName)data.type="H3",data.content=purifyHtml($child.innerHTML);else if("P"===$child.nodeName)data.type="P",(null!=(ref4=$child.firstChild)&&null!=(ref5=ref4.classList)?ref5.contains("is-drop-cap"):void 0)&&(data.isDropCap=!0,data.dropCapChar=$child.firstChild.textContent[0]),data.content=purifyHtml($child.innerHTML);else if("BLOCKQUOTE"===$child.nodeName)$child.classList.contains("is-second")?data.type="QUOTE2":data.type="QUOTE1",data.content=purifyHtml($child.innerHTML);else if("PRE"===$child.nodeName)data.type="PRE",data.content=purifyHtml($child.innerHTML);else if("HR"===$child.nodeName)data.type="HR";else if("FIGURE"===$child.nodeName)for(data.type="FIGURE",data.figureAlign="center",$child.classList.contains("b-figure--center")?data.figureAlign="center":$child.classList.contains("b-figure--left")?data.figureAlign="left":$child.classList.contains("b-figure--right")?data.figureAlign="right":$child.classList.contains("b-figure--full")&&(data.figureAlign="full"),data.img={},ref6=$child.childNodes,k=0,len2=ref6.length;len2>k;k++)$grandChild=ref6[k],"IMG"===$grandChild.nodeName?($grandChild.classList.contains("is-saved")?imgId=$grandChild.getAttribute("image-id"):(imgCount++,imgId=imgCount),$grandChild.offsetWidth>0&&$grandChild.offsetHeight>0?(imgWidth=$grandChild.offsetWidth,imgHeight=$grandChild.offsetHeight):(imgWidth=$grandChild.getAttribute("width"),imgHeight=$grandChild.getAttribute("height")),imgs.push({id:1*imgId,data:$grandChild.getAttribute("src")}),data.img={id:1*imgId,width:1*imgWidth,height:1*imgHeight},$grandChild.getAttribute("data-href")?(link=!0,data.img.href=$grandChild.getAttribute("data-href")):link=!1,data.img.link=link):"FIGCAPTION"===$grandChild.nodeName&&(data.caption=purifyHtml($grandChild.innerHTML));else if("UL"===$child.nodeName)for(data.type="UL",data.list=[],ref7=$child.childNodes,l=0,len3=ref7.length;len3>l;l++)$grandChild=ref7[l],"LI"===$grandChild.nodeName&&data.list.push(purifyHtml($grandChild.innerHTML));else if("OL"===$child.nodeName)for(data.type="OL",data.list=[],ref8=$child.childNodes,m=0,len4=ref8.length;len4>m;m++)$grandChild=ref8[m],"LI"===$grandChild.nodeName&&data.list.push(purifyHtml($grandChild.innerHTML));else"IFRAME"===$child.nodeName&&(data.type="IFRAME",data.frameId=$child.getAttribute("data-frame-id"),data.origin=$child.getAttribute("data-origin"));domJson.data.push(data),domJson.img=imgs}return domJson},module.exports={toJson:toJson,toDom:toDom}},{"./helper/elementList.coffee":15,"./helper/selector.coffee":17,"blueimp-load-image-npm":21}],15:[function(require,module,exports){module.exports={p:function(){var $p;return $p=document.createElement("P"),$p.classList.add("b-graf"),$p},h2:function(){var $h2;return $h2=document.createElement("H2"),$h2.classList.add("b-graf"),$h2.classList.add("b-graf--h2"),$h2},h3:function(){var $h3;return $h3=document.createElement("H3"),$h3.classList.add("b-graf"),$h3.classList.add("b-graf--h3"),$h3},ul:function(){var $ul;return $ul=document.createElement("UL"),$ul.classList.add("b-graf"),$ul.classList.add("b-graf--ulist"),$ul},ol:function(){var $ol;return $ol=document.createElement("OL"),$ol.classList.add("b-graf"),$ol.classList.add("b-graf--olist"),$ol},li:function(){var $li;return $li=document.createElement("LI")},blockquote1:function(){var $blockquote;return $blockquote=document.createElement("BLOCKQUOTE"),$blockquote.classList.add("b-graf"),$blockquote.classList.add("b-graf--quote1"),$blockquote},blockquote2:function(){var $blockquote;return $blockquote=document.createElement("BLOCKQUOTE"),$blockquote.classList.add("b-graf"),$blockquote.classList.add("b-graf--quote2"),$blockquote.classList.add("is-second"),$blockquote},code:function(){var $code;return $code=document.createElement("PRE"),$code.classList.add("b-graf"),$code.classList.add("b-graf--code"),$code},cap:function(){var $cap;return $cap=document.createElement("SPAN"),$cap.classList.add("b-graf"),$cap.classList.add("b-graf--drop-cap"),$cap.classList.add("is-drop-cap"),$cap.contentEditable=!1,$cap},hr:function(){var $hr;return $hr=document.createElement("HR"),$hr.classList.add("b-graf"),$hr.classList.add("b-graf--divider"),$hr.contentEditable=!1,$hr},text:function(text){var $textNode;return $textNode=document.createTextNode(text)},figure:function(type,img,caption){var $caption,$figure,$img,altText,figureClass,placeholderText;return null==type&&(type="center"),null==caption&&(caption="deskripsi gambar (opsional)"),figureClass=type,placeholderText=caption,altText=caption,"deskripsi gambar (opsional)"===caption&&(altText=""),$figure=document.createElement("FIGURE"),$caption=document.createElement("FIGCAPTION"),$figure.classList.add("b-figure"),$figure.classList.add("b-figure--"+figureClass),$caption.classList.add("b-figure__figcaption"),$caption.classList.add("is-figcaption"),$caption.innerHTML=placeholderText,$caption.contentEditable=!0,$img=document.createElement("IMG"),$img.classList.add("b-figure__img"),$img.classList.add("is-img"),"CANVAS"===img.nodeName?$img.src=img.toDataURL("image/jpeg",.7):$img.src=img.data,$img.setAttribute("alt",altText),$img.setAttribute("data-width",img.width),$img.setAttribute("data-height",img.height),img.link&&($img.setAttribute("data-href",img.href),$img.classList.add("is-link")),$figure.appendChild($img),$figure.appendChild($caption),$figure.contentEditable=!1,$figure},iframe:function(link){}}},{}],16:[function(require,module,exports){module.exports=function(){var selection;return selection=window.getSelection(),selection.anchorOffset}},{}],17:[function(require,module,exports){var $,$$;$=function(el){return document.querySelector(el)},$$=function(el){return document.querySelectorAll(el)},module.exports={$:$,$$:$$}},{}],18:[function(require,module,exports){module.exports=function(el,position){var range,selection;return selection=window.getSelection(),range=document.createRange(),range.setStart(el,position),range.collapse(!0),selection.removeAllRanges(),selection.addRange(range)}},{}],19:[function(require,module,exports){module.exports=function(el1,position1,el2,position2){var range,selection;return selection=window.getSelection(),range=document.createRange(),range.setStart(el1,position1),range.setEnd(el2,position2),selection.removeAllRanges(),selection.addRange(range)}},{}],20:[function(require,module,exports){var $,$$,$btn,$editable,$inputLink,$title,$titleParent,$toolbar,$tt,$ttil,addCover,addListener,alignCenter,articleInit,autoLink,blockElement,boldItalic,charTransform,command,createLink,dropCap,hangingPunc,i,imageControl,insertCode,insertHr,insertImage,isTitleFocus,len,makeEmbed,makeImageControl,makeList,makeTooltip,normalizedEditable,oldValue,onPaste,onUndo,ref,ref1,ref2,removeImageControl,removeTooltip,setCaret,setSelection,setUndo,swal,timer,toDom,toJson,toolbarListener;for(swal=require("sweetalert"),setSelection=require("./helper/setSelection.coffee"),setCaret=require("./helper/setCaret.coffee"),blockElement=require("./command/blockElement.coffee"),boldItalic=require("./command/boldItalic.coffee"),makeList=require("./command/makeList.coffee"),alignCenter=require("./command/alignCenter.coffee"),createLink=require("./command/createLink.coffee"),insertHr=require("./command/insertHr.coffee"),makeEmbed=require("./command/makeEmbed.coffee"),insertImage=require("./command/insertImage.coffee"),imageControl=require("./command/imageControl.coffee"),insertCode=require("./command/insertCode.coffee"),dropCap=require("./command/dropCap.coffee"),addCover=require("./command/addCover.coffee"),normalizedEditable=require("./normalize/normalizeEditable.coffee"),toolbarListener=require("./normalize/toolbarListener.coffee"),onPaste=require("./normalize/onPaste.coffee"),onUndo=require("./normalize/onUndo.coffee"),charTransform=require("./normalize/charTransform.coffee"),hangingPunc=require("./normalize/hangingPunc.coffee"),autoLink=require("./normalize/autoLink.coffee"),ref=require("./domParse.coffee"),toJson=ref.toJson,toDom=ref.toDom,ref1=require("./helper/selector.coffee"),$=ref1.$,$$=ref1.$$,$editable=$(".js-editable"),$toolbar=$(".js-toolbar"),articleInit=JSON.stringify(toJson()),localStorage.setItem("article-init",articleInit),timer="",oldValue=JSON.stringify(toJson()),document.addEventListener("keyup",function(e){return clearTimeout(timer),timer=setTimeout(function(){var newValue;if(!e.ctrlKey&&!e.metaKey)return newValue=JSON.stringify(toJson()),newValue!==oldValue?(onUndo.stack.execute(new onUndo.editCommand($editable,oldValue,newValue)),oldValue=newValue):void 0},250)}),document.addEventListener("keydown",function(e){if(e.ctrlKey||e.metaKey)if(90===e.keyCode){e.preventDefault();try{return onUndo.stack.canUndo(),onUndo.stack.undo(),addListener()}catch(undefined){}}else if(89===e.keyCode){e.preventDefault();try{return onUndo.stack.canRedo(),onUndo.stack.redo(),addListener()}catch(undefined){}}}),setUndo=function(){var newValue;return newValue=JSON.stringify(toJson()),onUndo.stack.execute(new onUndo.editCommand($editable,oldValue,newValue,oldValue=newValue))},document.addEventListener("keydown",function(e){if(9===e.which)return e.preventDefault();if(e.ctrlKey||e.metaKey){if(/^(66|73|85|49|50|51|52|53|69|75|79|83)$/.test(e.which)&&e.preventDefault(),66===e.keyCode)return $(".js-bold").click();if(73===e.keyCode)return $(".js-italic").click();if(49===e.keyCode)return $(".js-heading1").click();if(50===e.keyCode)return $(".js-heading2").click();if(51===e.keyCode)return $(".js-quote1").click();if(52===e.keyCode)return $(".js-quote2").click();if(53===e.keyCode)return $(".js-code").click();if(69===e.keyCode)return $(".js-center").click();if(75===e.keyCode)return $(".js-link").click();if(83===e.keyCode)return $(".js-save").click();if(191===e.keyCode)return $(".js-help").click()}}),makeImageControl=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;return bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$tt.style.display="block",$tt.style.top=topPos+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},makeTooltip=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;if(bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,el.href)$tt.innerHTML=""+el.href;else{if(!el.getAttribute("data-href"))return;$tt.innerHTML=""+el.getAttribute("data-href")}return $tt.style.display="block",$tt.style.top=topPos+height+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},removeTooltip=function($tt){return $tt.style.display="none"},$tt=$(".js-tooltip-link"),removeImageControl=function($tt){return $tt.style.display="none"},$editable.addEventListener("click",function(e){var $imgSelected,i,len,ref2;if("IMG"!==e.target.nodeName){for(ref2=$$(".is-img.is-selected"),i=0,len=ref2.length;len>i;i++)$imgSelected=ref2[i],$imgSelected.classList.remove("is-selected");return removeImageControl($(".js-tooltip-image"))}}),$editable.addEventListener("keyup",function(e){return removeImageControl($(".js-tooltip-image"))}),addListener=function(){var $img,$link,i,j,k,len,len1,len2,ref2,ref3,ref4,results;for(ref2=$$(".js-editable img.is-link"),i=0,len=ref2.length;len>i;i++)$link=ref2[i],$link.addEventListener("mouseover",function(e){return makeTooltip($tt,this)}),$link.addEventListener("mouseleave",function(e){return removeTooltip($tt)});for(ref3=$$(".js-editable a"),j=0,len1=ref3.length;len1>j;j++)$link=ref3[j],$link.addEventListener("mouseover",function(e){return makeTooltip($tt,this)}),$link.addEventListener("mouseleave",function(e){return removeTooltip($tt)});for(ref4=$$(".is-img"),results=[],k=0,len2=ref4.length;len2>k;k++)$img=ref4[k],results.push($img.addEventListener("click",function(e){var $imgSelected,l,len3,ref5;for(ref5=$$(".is-img.is-selected"),l=0,len3=ref5.length;len3>l;l++)$imgSelected=ref5[l],$imgSelected.classList.remove("is-selected");return this.classList.add("is-selected"),makeImageControl($(".js-tooltip-image"),this)}));return results},$inputLink=$(".js-input-link"),$ttil=$(".js-tooltip-input-link"),$inputLink.addEventListener("blur",function(e){return e.preventDefault(),$inputLink.value="",$ttil.style.display="none"}),$inputLink.addEventListener("keyup",function(e){return 13===e.keyCode?setTimeout(addListener(),1e3):void 0}),addListener(),ref2=$$(".js-tooltip-image button"),i=0,len=ref2.length;len>i;i++)$btn=ref2[i],$btn.addEventListener("click",function(e){return setUndo()});command=function(e,cb){var $beginParent,$endParent,anchorNode,focusNode,ref3,selection;return e.preventDefault(),selection=window.getSelection(),ref3=window.getSelection(),anchorNode=ref3.anchorNode,focusNode=ref3.focusNode,null===anchorNode||null===focusNode?cb(!1):($beginParent=anchorNode.parentNode,$endParent=focusNode.parentNode,$editable.contains($beginParent)?(cb(!0),addListener(),setUndo()):cb(!1))},$(".js-heading1").onclick=function(e){return command(e,function(res){return res?blockElement(1):void 0})},$(".js-heading2").onclick=function(e){return command(e,function(res){return res?blockElement(2):void 0})},$(".js-quote1").onclick=function(e){return command(e,function(res){return res?(blockElement(4),alignCenter(),boldItalic("italic")):void 0})},$(".js-quote2").onclick=function(e){return command(e,function(res){return res?blockElement(3):void 0})},$(".js-code").onclick=function(e){return command(e,function(res){return res?blockElement(5):void 0})},$(".js-bold").onclick=function(e){return command(e,function(res){return res?boldItalic("bold"):void 0})},$(".js-italic").onclick=function(e){return command(e,function(res){return res?boldItalic("italic"):void 0})},$title=$("textarea"),$titleParent=$title.parentNode,isTitleFocus=!1,$title.onfocus=function(e){return $titleParent.classList.contains("is-center")?$(".js-center").classList.add("is-active"):$(".js-center").classList.remove("is-active"),isTitleFocus=!0},$editable.addEventListener("click",function(e){return isTitleFocus=!1}),$editable.addEventListener("keyup",function(e){return isTitleFocus=!1}),$(".js-center").onclick=function(e){return isTitleFocus&&(isTitleFocus=!1,$titleParent.classList.contains("is-center")?$titleParent.classList.remove("is-center"):($(".js-center").classList.add("is-active"),$titleParent.classList.add("is-center"))),command(e,function(res){return res?alignCenter():void 0})},$(".js-drop-cap").onclick=function(e){return command(e,function(res){return res?dropCap():void 0})},$(".js-link").onclick=function(e){return command(e,function(res){return res?createLink():void 0})},$(".js-hr").onclick=function(e){return command(e,function(res){return res?insertHr():void 0})},$(".js-img").onclick=function(e){return command(e,function(res){return res?$(".js-input-img").click():void 0})},$(".js-help").onclick=function(e){return swal({title:"Help",text:'<h3>Shortcut</h3>\n<table>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">B</span></td>\n    <td>Bold</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">I</span></td>\n    <td>Italic</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">K</span></td>\n    <td>Link</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">E</span></td>\n    <td>Align center</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">1</span></td>\n    <td>Big heading</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">2</span></td>\n    <td>Small heading</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">3</span></td>\n    <td>Big quote</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">4</span></td>\n    <td>Small quote</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">5</span></td>\n    <td>Code block</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">Z</span></td>\n    <td>Undo</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">Y</span></td>\n    <td>Redo</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">S</span></td>\n    <td>Save article</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">O</span></td>\n    <td>Open saved article</td>\n  </tr>\n  <tr>\n    <td><span>Cmd</span> + <span class="btn">?</span></td>\n    <td>Help</td>\n  </tr>\n</table>',html:!0,allowOutsideClick:!0})},$(".js-input-img").onchange=function(e){return insertImage(),setTimeout(setUndo(),500),$(".js-input-img").value=""},$(".js-add-cover").onclick=function(e){return window.coverChanged=!0,$(".js-input-cover").click()},$(".js-del-cover").onclick=function(e){var $cover,$imgCover,$shadow;return window.coverChanged=!0,$imgCover=$(".js-img-cover"),$cover=$imgCover.parentNode,$title=$(".js-article-title"),$shadow=$(".js-cover-shadow"),$title.classList.remove("is-with-cover"),$shadow.classList.add("is-hidden"),$cover.removeAttribute("src"),$cover.removeAttribute("style"),$cover.classList.remove("is-cover-full"),$cover.classList.remove("is-cover-not-full"),$imgCover.removeAttribute("src"),$imgCover.removeAttribute("style"),$imgCover.classList.remove("is-hidden"),this.classList.add("is-hidden"),$(".js-cover").classList.add("is-not-cover"),setUndo()},$(".js-input-cover").onchange=function(e){return addCover(),setTimeout(setUndo(),500)},$editable.addEventListener("keyup",function(e){if(e.ctrlKey||e.metaKey);else if(17!==e.keyCode)return charTransform(),makeList(),hangingPunc()}),$editable.addEventListener("keydown",function(e){return 13===e.which?makeEmbed():32===e.keyCode?autoLink(e):void 0}),$editable.addEventListener("click",function(e){var $figcaption,j,len1,ref3,results;for(ref3=$$(".is-figcaption"),results=[],j=0,len1=ref3.length;len1>j;j++)$figcaption=ref3[j],"description (optional)"===$figcaption.textContent?results.push($figcaption.innerHTML="<br>"):results.push(void 0);return results}),$(".js-open").onclick=function(e){var articleData;return articleData=JSON.parse(localStorage.getItem("article")),articleData?(toDom(articleData),addListener(),setUndo()):void 0},$(".js-save").onclick=function(e){var articleData;return articleData=JSON.stringify(toJson()),localStorage.setItem("article",articleData)}},{"./command/addCover.coffee":2,"./command/alignCenter.coffee":3,"./command/blockElement.coffee":4,"./command/boldItalic.coffee":5,"./command/createLink.coffee":6,"./command/dropCap.coffee":7,"./command/imageControl.coffee":8,"./command/insertCode.coffee":9,"./command/insertHr.coffee":10,"./command/insertImage.coffee":11,"./command/makeEmbed.coffee":12,"./command/makeList.coffee":13,"./domParse.coffee":14,"./helper/selector.coffee":17,"./helper/setCaret.coffee":18,"./helper/setSelection.coffee":19,"./normalize/autoLink.coffee":33,"./normalize/charTransform.coffee":34,"./normalize/hangingPunc.coffee":35,"./normalize/normalizeEditable.coffee":36,"./normalize/onPaste.coffee":37,"./normalize/onUndo.coffee":38,"./normalize/toolbarListener.coffee":39,sweetalert:31}],21:[function(require,module,exports){"use strict";var loadImage=require("./load-image");module.exports=loadImage},{"./load-image":22}],22:[function(require,module,exports){"use strict";var loadImage=function(file,callback,options){var url,oUrl,img=document.createElement("img");if(img.onerror=callback,img.onload=function(){!oUrl||options&&options.noRevoke||loadImage.revokeObjectURL(oUrl),callback&&callback(loadImage.scale(img,options))},loadImage.isInstanceOf("Blob",file)||loadImage.isInstanceOf("File",file))url=oUrl=loadImage.createObjectURL(file),img._type=file.type;else{if("string"!=typeof file)return!1;url=file,options&&options.crossOrigin&&(img.crossOrigin=options.crossOrigin)}return url?(img.src=url,img):loadImage.readFile(file,function(e){var target=e.target;target&&target.result?img.src=target.result:callback&&callback(e)})},urlAPI=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;loadImage.isInstanceOf=function(type,obj){return Object.prototype.toString.call(obj)==="[object "+type+"]"},loadImage.transformCoordinates=function(){},loadImage.getTransformedOptions=function(img,options){var newOptions,i,width,height,aspectRatio=options.aspectRatio;if(!aspectRatio)return options;newOptions={};for(i in options)options.hasOwnProperty(i)&&(newOptions[i]=options[i]);return newOptions.crop=!0,width=img.naturalWidth||img.width,height=img.naturalHeight||img.height,width/height>aspectRatio?(newOptions.maxWidth=height*aspectRatio,newOptions.maxHeight=height):(newOptions.maxWidth=width,newOptions.maxHeight=width/aspectRatio),newOptions},loadImage.renderImageToCanvas=function(canvas,img,sourceX,sourceY,sourceWidth,sourceHeight,destX,destY,destWidth,destHeight){var ctx=canvas.getContext("2d");return ctx.beginPath(),ctx.moveTo(0,0),ctx.lineTo(0,destHeight),ctx.lineTo(destWidth,destHeight),ctx.lineTo(destWidth,0),ctx.fillStyle="#FFFFFF",ctx.fill(),ctx.drawImage(img,sourceX,sourceY,sourceWidth,sourceHeight,destX,destY,destWidth,destHeight),canvas},loadImage.hasCanvasOption=function(options){return options.canvas||options.crop||options.aspectRatio},loadImage.scale=function(img,options){options=options||{};var maxWidth,maxHeight,minWidth,minHeight,sourceWidth,sourceHeight,sourceX,sourceY,tmp,canvas=document.createElement("canvas"),useCanvas=img.getContext||loadImage.hasCanvasOption(options)&&canvas.getContext,width=img.naturalWidth||img.width,height=img.naturalHeight||img.height,destWidth=width,destHeight=height,scaleUp=function(){var scale=Math.max((minWidth||destWidth)/destWidth,(minHeight||destHeight)/destHeight);scale>1&&(destWidth*=scale,destHeight*=scale)},scaleDown=function(){var scale=Math.min((maxWidth||destWidth)/destWidth,(maxHeight||destHeight)/destHeight);1>scale&&(destWidth*=scale,destHeight*=scale)};return useCanvas&&(options=loadImage.getTransformedOptions(img,options),sourceX=options.left||0,sourceY=options.top||0,options.sourceWidth?(sourceWidth=options.sourceWidth,void 0!==options.right&&void 0===options.left&&(sourceX=width-sourceWidth-options.right)):sourceWidth=width-sourceX-(options.right||0),options.sourceHeight?(sourceHeight=options.sourceHeight,void 0!==options.bottom&&void 0===options.top&&(sourceY=height-sourceHeight-options.bottom)):sourceHeight=height-sourceY-(options.bottom||0),destWidth=sourceWidth,destHeight=sourceHeight),maxWidth=options.maxWidth,maxHeight=options.maxHeight,minWidth=options.minWidth,minHeight=options.minHeight,useCanvas&&maxWidth&&maxHeight&&options.crop?(destWidth=maxWidth,destHeight=maxHeight,tmp=sourceWidth/sourceHeight-maxWidth/maxHeight,0>tmp?(sourceHeight=maxHeight*sourceWidth/maxWidth,void 0===options.top&&void 0===options.bottom&&(sourceY=(height-sourceHeight)/2)):tmp>0&&(sourceWidth=maxWidth*sourceHeight/maxHeight,void 0===options.left&&void 0===options.right&&(sourceX=(width-sourceWidth)/2))):((options.contain||options.cover)&&(minWidth=maxWidth=maxWidth||minWidth,minHeight=maxHeight=maxHeight||minHeight),options.cover?(scaleDown(),scaleUp()):(scaleUp(),scaleDown())),useCanvas?(canvas.width=destWidth,canvas.height=destHeight,loadImage.transformCoordinates(canvas,options),loadImage.renderImageToCanvas(canvas,img,sourceX,sourceY,sourceWidth,sourceHeight,0,0,destWidth,destHeight)):(img.width=destWidth,img.height=destHeight,img)},loadImage.createObjectURL=function(file){return urlAPI?urlAPI.createObjectURL(file):!1},loadImage.revokeObjectURL=function(url){return urlAPI?urlAPI.revokeObjectURL(url):!1},loadImage.readFile=function(file,callback,method){if(window.FileReader){var fileReader=new FileReader;if(fileReader.onload=fileReader.onerror=callback,method=method||"readAsDataURL",fileReader[method])return fileReader[method](file),fileReader}return!1},module.exports=loadImage},{}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var defaultParams={title:"",text:"",type:null,allowOutsideClick:!1,showConfirmButton:!0,showCancelButton:!1,closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",confirmButtonColor:"#8CD4F5",cancelButtonText:"Cancel",imageUrl:null,imageSize:null,timer:null,customClass:"",html:!1,animation:!0,allowEscapeKey:!0,inputType:"text",inputPlaceholder:"",inputValue:"",showLoaderOnConfirm:!1};exports["default"]=defaultParams,module.exports=exports["default"]},{}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _colorLuminance=require("./utils"),_hasClass$isDescendant=(require("./handle-swal-dom"),require("./handle-dom")),handleButton=function(event,params,modal){function shouldSetConfirmButtonColor(color){targetedConfirm&&params.confirmButtonColor&&(target.style.backgroundColor=color)}var normalColor,hoverColor,activeColor,e=event||window.event,target=e.target||e.srcElement,targetedConfirm=-1!==target.className.indexOf("confirm"),targetedOverlay=-1!==target.className.indexOf("sweet-overlay"),modalIsVisible=_hasClass$isDescendant.hasClass(modal,"visible"),doneFunctionExists=params.doneFunction&&"true"===modal.getAttribute("data-has-done-function");switch(targetedConfirm&&params.confirmButtonColor&&(normalColor=params.confirmButtonColor,hoverColor=_colorLuminance.colorLuminance(normalColor,-.04),activeColor=_colorLuminance.colorLuminance(normalColor,-.14)),e.type){case"mouseover":shouldSetConfirmButtonColor(hoverColor);break;case"mouseout":shouldSetConfirmButtonColor(normalColor);break;case"mousedown":shouldSetConfirmButtonColor(activeColor);break;case"mouseup":shouldSetConfirmButtonColor(hoverColor);break;case"focus":var $confirmButton=modal.querySelector("button.confirm"),$cancelButton=modal.querySelector("button.cancel");targetedConfirm?$cancelButton.style.boxShadow="none":$confirmButton.style.boxShadow="none";break;case"click":var clickedOnModal=modal===target,clickedOnModalChild=_hasClass$isDescendant.isDescendant(modal,target);if(!clickedOnModal&&!clickedOnModalChild&&modalIsVisible&&!params.allowOutsideClick)break;targetedConfirm&&doneFunctionExists&&modalIsVisible?handleConfirm(modal,params):doneFunctionExists&&modalIsVisible||targetedOverlay?handleCancel(modal,params):_hasClass$isDescendant.isDescendant(modal,target)&&"BUTTON"===target.tagName&&sweetAlert.close()}},handleConfirm=function(modal,params){var callbackValue=!0;_hasClass$isDescendant.hasClass(modal,"show-input")&&(callbackValue=modal.querySelector("input").value,callbackValue||(callbackValue="")),params.doneFunction(callbackValue),params.closeOnConfirm&&sweetAlert.close(),params.showLoaderOnConfirm&&sweetAlert.disableButtons()},handleCancel=function(modal,params){var functionAsStr=String(params.doneFunction).replace(/\s/g,""),functionHandlesCancel="function("===functionAsStr.substring(0,9)&&")"!==functionAsStr.substring(9,10);functionHandlesCancel&&params.doneFunction(!1),params.closeOnCancel&&sweetAlert.close()};exports["default"]={handleButton:handleButton,handleConfirm:handleConfirm,handleCancel:handleCancel},module.exports=exports["default"]},{"./handle-dom":25,"./handle-swal-dom":27,"./utils":30}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var hasClass=function(elem,className){return new RegExp(" "+className+" ").test(" "+elem.className+" ")},addClass=function(elem,className){hasClass(elem,className)||(elem.className+=" "+className)},removeClass=function(elem,className){var newClass=" "+elem.className.replace(/[\t\r\n]/g," ")+" ";if(hasClass(elem,className)){for(;newClass.indexOf(" "+className+" ")>=0;)newClass=newClass.replace(" "+className+" "," ");elem.className=newClass.replace(/^\s+|\s+$/g,"")}},escapeHtml=function(str){var div=document.createElement("div");return div.appendChild(document.createTextNode(str)),div.innerHTML},_show=function(elem){elem.style.opacity="",elem.style.display="block"},show=function(elems){if(elems&&!elems.length)return _show(elems);for(var i=0;i<elems.length;++i)_show(elems[i])},_hide=function(elem){elem.style.opacity="",elem.style.display="none"},hide=function(elems){if(elems&&!elems.length)return _hide(elems);
for(var i=0;i<elems.length;++i)_hide(elems[i])},isDescendant=function(parent,child){for(var node=child.parentNode;null!==node;){if(node===parent)return!0;node=node.parentNode}return!1},getTopMargin=function(elem){elem.style.left="-9999px",elem.style.display="block";var padding,height=elem.clientHeight;return padding="undefined"!=typeof getComputedStyle?parseInt(getComputedStyle(elem).getPropertyValue("padding-top"),10):parseInt(elem.currentStyle.padding),elem.style.left="",elem.style.display="none","-"+parseInt((height+padding)/2)+"px"},fadeIn=function(elem,interval){if(+elem.style.opacity<1){interval=interval||16,elem.style.opacity=0,elem.style.display="block";var last=+new Date,tick=function(_tick){function tick(){return _tick.apply(this,arguments)}return tick.toString=function(){return _tick.toString()},tick}(function(){elem.style.opacity=+elem.style.opacity+(new Date-last)/100,last=+new Date,+elem.style.opacity<1&&setTimeout(tick,interval)});tick()}elem.style.display="block"},fadeOut=function(elem,interval){interval=interval||16,elem.style.opacity=1;var last=+new Date,tick=function(_tick2){function tick(){return _tick2.apply(this,arguments)}return tick.toString=function(){return _tick2.toString()},tick}(function(){elem.style.opacity=+elem.style.opacity-(new Date-last)/100,last=+new Date,+elem.style.opacity>0?setTimeout(tick,interval):elem.style.display="none"});tick()},fireClick=function(node){if("function"==typeof MouseEvent){var mevt=new MouseEvent("click",{view:window,bubbles:!1,cancelable:!0});node.dispatchEvent(mevt)}else if(document.createEvent){var evt=document.createEvent("MouseEvents");evt.initEvent("click",!1,!1),node.dispatchEvent(evt)}else document.createEventObject?node.fireEvent("onclick"):"function"==typeof node.onclick&&node.onclick()},stopEventPropagation=function(e){"function"==typeof e.stopPropagation?(e.stopPropagation(),e.preventDefault()):window.event&&window.event.hasOwnProperty("cancelBubble")&&(window.event.cancelBubble=!0)};exports.hasClass=hasClass,exports.addClass=addClass,exports.removeClass=removeClass,exports.escapeHtml=escapeHtml,exports._show=_show,exports.show=show,exports._hide=_hide,exports.hide=hide,exports.isDescendant=isDescendant,exports.getTopMargin=getTopMargin,exports.fadeIn=fadeIn,exports.fadeOut=fadeOut,exports.fireClick=fireClick,exports.stopEventPropagation=stopEventPropagation},{}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _stopEventPropagation$fireClick=require("./handle-dom"),_setFocusStyle=require("./handle-swal-dom"),handleKeyDown=function(event,params,modal){var e=event||window.event,keyCode=e.keyCode||e.which,$okButton=modal.querySelector("button.confirm"),$cancelButton=modal.querySelector("button.cancel"),$modalButtons=modal.querySelectorAll("button[tabindex]");if(-1!==[9,13,32,27].indexOf(keyCode)){for(var $targetElement=e.target||e.srcElement,btnIndex=-1,i=0;i<$modalButtons.length;i++)if($targetElement===$modalButtons[i]){btnIndex=i;break}9===keyCode?($targetElement=-1===btnIndex?$okButton:btnIndex===$modalButtons.length-1?$modalButtons[0]:$modalButtons[btnIndex+1],_stopEventPropagation$fireClick.stopEventPropagation(e),$targetElement.focus(),params.confirmButtonColor&&_setFocusStyle.setFocusStyle($targetElement,params.confirmButtonColor)):13===keyCode?("INPUT"===$targetElement.tagName&&($targetElement=$okButton,$okButton.focus()),$targetElement=-1===btnIndex?$okButton:void 0):27===keyCode&&params.allowEscapeKey===!0?($targetElement=$cancelButton,_stopEventPropagation$fireClick.fireClick($targetElement,e)):$targetElement=void 0}};exports["default"]=handleKeyDown,module.exports=exports["default"]},{"./handle-dom":25,"./handle-swal-dom":27}],27:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};Object.defineProperty(exports,"__esModule",{value:!0});var _hexToRgb=require("./utils"),_removeClass$getTopMargin$fadeIn$show$addClass=require("./handle-dom"),_defaultParams=require("./default-params"),_defaultParams2=_interopRequireWildcard(_defaultParams),_injectedHTML=require("./injected-html"),_injectedHTML2=_interopRequireWildcard(_injectedHTML),modalClass=".sweet-alert",overlayClass=".sweet-overlay",sweetAlertInitialize=function(){var sweetWrap=document.createElement("div");for(sweetWrap.innerHTML=_injectedHTML2["default"];sweetWrap.firstChild;)document.body.appendChild(sweetWrap.firstChild)},getModal=function(_getModal){function getModal(){return _getModal.apply(this,arguments)}return getModal.toString=function(){return _getModal.toString()},getModal}(function(){var $modal=document.querySelector(modalClass);return $modal||(sweetAlertInitialize(),$modal=getModal()),$modal}),getInput=function(){var $modal=getModal();return $modal?$modal.querySelector("input"):void 0},getOverlay=function(){return document.querySelector(overlayClass)},setFocusStyle=function($button,bgColor){var rgbColor=_hexToRgb.hexToRgb(bgColor);$button.style.boxShadow="0 0 2px rgba("+rgbColor+", 0.8), inset 0 0 0 1px rgba(0, 0, 0, 0.05)"},openModal=function(callback){var $modal=getModal();_removeClass$getTopMargin$fadeIn$show$addClass.fadeIn(getOverlay(),10),_removeClass$getTopMargin$fadeIn$show$addClass.show($modal),_removeClass$getTopMargin$fadeIn$show$addClass.addClass($modal,"showSweetAlert"),_removeClass$getTopMargin$fadeIn$show$addClass.removeClass($modal,"hideSweetAlert"),window.previousActiveElement=document.activeElement;var $okButton=$modal.querySelector("button.confirm");$okButton.focus(),setTimeout(function(){_removeClass$getTopMargin$fadeIn$show$addClass.addClass($modal,"visible")},500);var timer=$modal.getAttribute("data-timer");if("null"!==timer&&""!==timer){var timerCallback=callback;$modal.timeout=setTimeout(function(){var doneFunctionExists=(timerCallback||null)&&"true"===$modal.getAttribute("data-has-done-function");doneFunctionExists?timerCallback(null):sweetAlert.close()},timer)}},resetInput=function(){var $modal=getModal(),$input=getInput();_removeClass$getTopMargin$fadeIn$show$addClass.removeClass($modal,"show-input"),$input.value=_defaultParams2["default"].inputValue,$input.setAttribute("type",_defaultParams2["default"].inputType),$input.setAttribute("placeholder",_defaultParams2["default"].inputPlaceholder),resetInputError()},resetInputError=function(event){if(event&&13===event.keyCode)return!1;var $modal=getModal(),$errorIcon=$modal.querySelector(".sa-input-error");_removeClass$getTopMargin$fadeIn$show$addClass.removeClass($errorIcon,"show");var $errorContainer=$modal.querySelector(".sa-error-container");_removeClass$getTopMargin$fadeIn$show$addClass.removeClass($errorContainer,"show")},fixVerticalPosition=function(){var $modal=getModal();$modal.style.marginTop=_removeClass$getTopMargin$fadeIn$show$addClass.getTopMargin(getModal())};exports.sweetAlertInitialize=sweetAlertInitialize,exports.getModal=getModal,exports.getOverlay=getOverlay,exports.getInput=getInput,exports.setFocusStyle=setFocusStyle,exports.openModal=openModal,exports.resetInput=resetInput,exports.resetInputError=resetInputError,exports.fixVerticalPosition=fixVerticalPosition},{"./default-params":23,"./handle-dom":25,"./injected-html":28,"./utils":30}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var injectedHTML='<div class="sweet-overlay" tabIndex="-1"></div><div class="sweet-alert"><div class="sa-icon sa-error">\n      <span class="sa-x-mark">\n        <span class="sa-line sa-left"></span>\n        <span class="sa-line sa-right"></span>\n      </span>\n    </div><div class="sa-icon sa-warning">\n      <span class="sa-body"></span>\n      <span class="sa-dot"></span>\n    </div><div class="sa-icon sa-info"></div><div class="sa-icon sa-success">\n      <span class="sa-line sa-tip"></span>\n      <span class="sa-line sa-long"></span>\n\n      <div class="sa-placeholder"></div>\n      <div class="sa-fix"></div>\n    </div><div class="sa-icon sa-custom"></div><h2>Title</h2>\n    <p>Text</p>\n    <fieldset>\n      <input type="text" tabIndex="3" />\n      <div class="sa-input-error"></div>\n    </fieldset><div class="sa-error-container">\n      <div class="icon">!</div>\n      <p>Not valid!</p>\n    </div><div class="sa-button-container">\n      <button class="cancel" tabIndex="2">Cancel</button>\n      <div class="sa-confirm-button-container">\n        <button class="confirm" tabIndex="1">OK</button><div class="la-ball-fall">\n          <div></div>\n          <div></div>\n          <div></div>\n        </div>\n      </div>\n    </div></div>';exports["default"]=injectedHTML,module.exports=exports["default"]},{}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _isIE8=require("./utils"),_getModal$getInput$setFocusStyle=require("./handle-swal-dom"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide=require("./handle-dom"),alertTypes=["error","warning","info","success","input","prompt"],setParameters=function(params){var modal=_getModal$getInput$setFocusStyle.getModal(),$title=modal.querySelector("h2"),$text=modal.querySelector("p"),$cancelBtn=modal.querySelector("button.cancel"),$confirmBtn=modal.querySelector("button.confirm");if($title.innerHTML=params.html?params.title:_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.escapeHtml(params.title).split("\n").join("<br>"),$text.innerHTML=params.html?params.text:_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.escapeHtml(params.text||"").split("\n").join("<br>"),params.text&&_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.show($text),params.customClass)_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass(modal,params.customClass),modal.setAttribute("data-custom-class",params.customClass);else{var customClass=modal.getAttribute("data-custom-class");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.removeClass(modal,customClass),modal.setAttribute("data-custom-class","")}if(_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.hide(modal.querySelectorAll(".sa-icon")),params.type&&!_isIE8.isIE8()){var _ret=function(){for(var validType=!1,i=0;i<alertTypes.length;i++)if(params.type===alertTypes[i]){validType=!0;break}if(!validType)return logStr("Unknown alert type: "+params.type),{v:!1};var typesWithIcons=["success","error","warning","info"],$icon=void 0;-1!==typesWithIcons.indexOf(params.type)&&($icon=modal.querySelector(".sa-icon.sa-"+params.type),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.show($icon));var $input=_getModal$getInput$setFocusStyle.getInput();switch(params.type){case"success":_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon,"animate"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon.querySelector(".sa-tip"),"animateSuccessTip"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon.querySelector(".sa-long"),"animateSuccessLong");break;case"error":_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon,"animateErrorIcon"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon.querySelector(".sa-x-mark"),"animateXMark");break;case"warning":_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon,"pulseWarning"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon.querySelector(".sa-body"),"pulseWarningIns"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass($icon.querySelector(".sa-dot"),"pulseWarningIns");break;case"input":case"prompt":$input.setAttribute("type",params.inputType),$input.value=params.inputValue,$input.setAttribute("placeholder",params.inputPlaceholder),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.addClass(modal,"show-input"),setTimeout(function(){$input.focus(),$input.addEventListener("keyup",swal.resetInputError)},400)}}();if("object"==typeof _ret)return _ret.v}if(params.imageUrl){var $customIcon=modal.querySelector(".sa-icon.sa-custom");$customIcon.style.backgroundImage="url("+params.imageUrl+")",_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.show($customIcon);var _imgWidth=80,_imgHeight=80;if(params.imageSize){var dimensions=params.imageSize.toString().split("x"),imgWidth=dimensions[0],imgHeight=dimensions[1];imgWidth&&imgHeight?(_imgWidth=imgWidth,_imgHeight=imgHeight):logStr("Parameter imageSize expects value with format WIDTHxHEIGHT, got "+params.imageSize)}$customIcon.setAttribute("style",$customIcon.getAttribute("style")+"width:"+_imgWidth+"px; height:"+_imgHeight+"px")}modal.setAttribute("data-has-cancel-button",params.showCancelButton),params.showCancelButton?$cancelBtn.style.display="inline-block":_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.hide($cancelBtn),modal.setAttribute("data-has-confirm-button",params.showConfirmButton),params.showConfirmButton?$confirmBtn.style.display="inline-block":_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.hide($confirmBtn),params.cancelButtonText&&($cancelBtn.innerHTML=_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.escapeHtml(params.cancelButtonText)),params.confirmButtonText&&($confirmBtn.innerHTML=_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide.escapeHtml(params.confirmButtonText)),params.confirmButtonColor&&($confirmBtn.style.backgroundColor=params.confirmButtonColor,$confirmBtn.style.borderLeftColor=params.confirmLoadingButtonColor,$confirmBtn.style.borderRightColor=params.confirmLoadingButtonColor,_getModal$getInput$setFocusStyle.setFocusStyle($confirmBtn,params.confirmButtonColor)),modal.setAttribute("data-allow-outside-click",params.allowOutsideClick);var hasDoneFunction=!!params.doneFunction;modal.setAttribute("data-has-done-function",hasDoneFunction),params.animation?"string"==typeof params.animation?modal.setAttribute("data-animation",params.animation):modal.setAttribute("data-animation","pop"):modal.setAttribute("data-animation","none"),modal.setAttribute("data-timer",params.timer)};exports["default"]=setParameters,module.exports=exports["default"]},{"./handle-dom":25,"./handle-swal-dom":27,"./utils":30}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var extend=function(a,b){for(var key in b)b.hasOwnProperty(key)&&(a[key]=b[key]);return a},hexToRgb=function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?parseInt(result[1],16)+", "+parseInt(result[2],16)+", "+parseInt(result[3],16):null},isIE8=function(){return window.attachEvent&&!window.addEventListener},logStr=function(string){window.console&&window.console.log("SweetAlert: "+string)},colorLuminance=function(hex,lum){hex=String(hex).replace(/[^0-9a-f]/gi,""),hex.length<6&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),lum=lum||0;var c,i,rgb="#";for(i=0;3>i;i++)c=parseInt(hex.substr(2*i,2),16),c=Math.round(Math.min(Math.max(0,c+c*lum),255)).toString(16),rgb+=("00"+c).substr(c.length);return rgb};exports.extend=extend,exports.hexToRgb=hexToRgb,exports.isIE8=isIE8,exports.logStr=logStr,exports.colorLuminance=colorLuminance},{}],31:[function(require,module,exports){"use strict";var _interopRequireWildcard=function(obj){return obj&&obj.__esModule?obj:{"default":obj}};Object.defineProperty(exports,"__esModule",{value:!0});var previousWindowKeyDown,lastFocusedButton,sweetAlert,swal,_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation=require("./modules/handle-dom"),_extend$hexToRgb$isIE8$logStr$colorLuminance=require("./modules/utils"),_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition=require("./modules/handle-swal-dom"),_handleButton$handleConfirm$handleCancel=require("./modules/handle-click"),_handleKeyDown=require("./modules/handle-key"),_handleKeyDown2=_interopRequireWildcard(_handleKeyDown),_defaultParams=require("./modules/default-params"),_defaultParams2=_interopRequireWildcard(_defaultParams),_setParameters=require("./modules/set-params"),_setParameters2=_interopRequireWildcard(_setParameters);exports["default"]=sweetAlert=swal=function(){function argumentOrDefault(key){var args=customizations;return void 0===args[key]?_defaultParams2["default"][key]:args[key]}var customizations=arguments[0];if(_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.addClass(document.body,"stop-scrolling"),_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.resetInput(),void 0===customizations)return _extend$hexToRgb$isIE8$logStr$colorLuminance.logStr("SweetAlert expects at least 1 attribute!"),!1;var params=_extend$hexToRgb$isIE8$logStr$colorLuminance.extend({},_defaultParams2["default"]);switch(typeof customizations){case"string":params.title=customizations,params.text=arguments[1]||"",params.type=arguments[2]||"";break;case"object":if(void 0===customizations.title)return _extend$hexToRgb$isIE8$logStr$colorLuminance.logStr('Missing "title" argument!'),!1;params.title=customizations.title;for(var customName in _defaultParams2["default"])params[customName]=argumentOrDefault(customName);params.confirmButtonText=params.showCancelButton?"Confirm":_defaultParams2["default"].confirmButtonText,params.confirmButtonText=argumentOrDefault("confirmButtonText"),params.doneFunction=arguments[1]||null;break;default:return _extend$hexToRgb$isIE8$logStr$colorLuminance.logStr('Unexpected type of argument! Expected "string" or "object", got '+typeof customizations),!1}_setParameters2["default"](params),_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.fixVerticalPosition(),_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.openModal(arguments[1]);for(var modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal(),$buttons=modal.querySelectorAll("button"),buttonEvents=["onclick","onmouseover","onmouseout","onmousedown","onmouseup","onfocus"],onButtonEvent=function(e){return _handleButton$handleConfirm$handleCancel.handleButton(e,params,modal)},btnIndex=0;btnIndex<$buttons.length;btnIndex++)for(var evtIndex=0;evtIndex<buttonEvents.length;evtIndex++){var btnEvt=buttonEvents[evtIndex];$buttons[btnIndex][btnEvt]=onButtonEvent}_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getOverlay().onclick=onButtonEvent,previousWindowKeyDown=window.onkeydown;var onKeyEvent=function(e){return _handleKeyDown2["default"](e,params,modal)};window.onkeydown=onKeyEvent,window.onfocus=function(){setTimeout(function(){void 0!==lastFocusedButton&&(lastFocusedButton.focus(),lastFocusedButton=void 0)},0)},swal.enableButtons()},sweetAlert.setDefaults=swal.setDefaults=function(userParams){if(!userParams)throw new Error("userParams is required");if("object"!=typeof userParams)throw new Error("userParams has to be a object");_extend$hexToRgb$isIE8$logStr$colorLuminance.extend(_defaultParams2["default"],userParams)},sweetAlert.close=swal.close=function(){var modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal();_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.fadeOut(_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getOverlay(),5),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.fadeOut(modal,5),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass(modal,"showSweetAlert"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.addClass(modal,"hideSweetAlert"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass(modal,"visible");var $successIcon=modal.querySelector(".sa-icon.sa-success");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($successIcon,"animate"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($successIcon.querySelector(".sa-tip"),"animateSuccessTip"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($successIcon.querySelector(".sa-long"),"animateSuccessLong");var $errorIcon=modal.querySelector(".sa-icon.sa-error");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($errorIcon,"animateErrorIcon"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($errorIcon.querySelector(".sa-x-mark"),"animateXMark");var $warningIcon=modal.querySelector(".sa-icon.sa-warning");return _hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($warningIcon,"pulseWarning"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($warningIcon.querySelector(".sa-body"),"pulseWarningIns"),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($warningIcon.querySelector(".sa-dot"),"pulseWarningIns"),setTimeout(function(){var customClass=modal.getAttribute("data-custom-class");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass(modal,customClass)},300),_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass(document.body,"stop-scrolling"),window.onkeydown=previousWindowKeyDown,window.previousActiveElement&&window.previousActiveElement.focus(),lastFocusedButton=void 0,clearTimeout(modal.timeout),!0},sweetAlert.showInputError=swal.showInputError=function(errorMessage){var modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal(),$errorIcon=modal.querySelector(".sa-input-error");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.addClass($errorIcon,"show");var $errorContainer=modal.querySelector(".sa-error-container");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.addClass($errorContainer,"show"),$errorContainer.querySelector("p").innerHTML=errorMessage,setTimeout(function(){sweetAlert.enableButtons()},1),modal.querySelector("input").focus()},sweetAlert.resetInputError=swal.resetInputError=function(event){if(event&&13===event.keyCode)return!1;var $modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal(),$errorIcon=$modal.querySelector(".sa-input-error");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($errorIcon,"show");var $errorContainer=$modal.querySelector(".sa-error-container");_hasClass$addClass$removeClass$escapeHtml$_show$show$_hide$hide$isDescendant$getTopMargin$fadeIn$fadeOut$fireClick$stopEventPropagation.removeClass($errorContainer,"show")},sweetAlert.disableButtons=swal.disableButtons=function(event){var modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal(),$confirmButton=modal.querySelector("button.confirm"),$cancelButton=modal.querySelector("button.cancel");$confirmButton.disabled=!0,$cancelButton.disabled=!0},sweetAlert.enableButtons=swal.enableButtons=function(event){var modal=_sweetAlertInitialize$getModal$getOverlay$getInput$setFocusStyle$openModal$resetInput$fixVerticalPosition.getModal(),$confirmButton=modal.querySelector("button.confirm"),$cancelButton=modal.querySelector("button.cancel");$confirmButton.disabled=!1,$cancelButton.disabled=!1},"undefined"!=typeof window?window.sweetAlert=window.swal=sweetAlert:_extend$hexToRgb$isIE8$logStr$colorLuminance.logStr("SweetAlert is a frontend module!"),module.exports=exports["default"]},{"./modules/default-params":23,"./modules/handle-click":24,"./modules/handle-dom":25,"./modules/handle-key":26,"./modules/handle-swal-dom":27,"./modules/set-params":29,"./modules/utils":30}],32:[function(require,module,exports){(function(){function extend(target,ref){var name,value;for(name in ref)value=ref[name],void 0!==value&&(target[name]=value);return target}var ctor=function(){},inherits=function(parent,protoProps){var child;return child=protoProps&&protoProps.hasOwnProperty("constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},ctor.prototype=parent.prototype,child.prototype=new ctor,protoProps&&extend(child.prototype,protoProps),child.prototype.constructor=child,child.__super__=parent.prototype,child},Undo={version:"0.1.15"};Undo.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},extend(Undo.Stack.prototype,{execute:function(command){this._clearRedo(),command.execute(),this.commands.push(command),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),Undo.Command=function(name){this.name=name};var up=new Error("override me!");extend(Undo.Command.prototype,{execute:function(){throw up},undo:function(){throw up},redo:function(){this.execute()}}),Undo.Command.extend=function(protoProps){var child=inherits(this,protoProps);return child.extend=Undo.Command.extend,child},"function"==typeof define&&define.amd?define(Undo):"undefined"!=typeof module&&module.exports?module.exports=Undo:this.Undo=Undo}).call(this)},{}],33:[function(require,module,exports){var $,$editable,$toolbar,$tt,makeTooltip,removeTooltip,setCaret;setCaret=require("../helper/setCaret.coffee"),$=require("../helper/selector.coffee").$,$editable=$(".js-editable"),$toolbar=$(".js-toolbar"),$tt=$(".js-tooltip-link"),makeTooltip=function($tt,el){var bodyRect,height,leftPos,linkRect,topPos,widthToCenter;return bodyRect=document.body.getBoundingClientRect(),linkRect=el.getBoundingClientRect(),leftPos=linkRect.left-bodyRect.left,topPos=linkRect.top-bodyRect.top,widthToCenter=linkRect.width/2,height=linkRect.height,$tt.innerHTML=""+el.href,$tt.style.display="block",$tt.style.top=topPos+height+"px",$tt.style.left=leftPos+widthToCenter+"px",$tt.style.marginLeft="-"+$tt.offsetWidth/2+"px"},removeTooltip=function($tt){return $tt.style.display="none"},module.exports=function(e){var $afterText,$link,$newLink,$newText,$thisEl,idx,linkRegex,matchText,ref,selection;if(selection=window.getSelection(),$thisEl=selection.anchorNode,32===e.which){if(linkRegex=/https?:\/\/([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/g,"A"===$thisEl.parentNode)return $link=$thisEl.splitText(selection.anchorOffset);if(linkRegex.test($thisEl.textContent))return e.preventDefault(),matchText=$thisEl.textContent.match(linkRegex)[0],$newLink=document.createElement("A"),idx=$thisEl.textContent.indexOf(matchText),$afterText=$thisEl.splitText(idx+matchText.length),$link=$thisEl.splitText(idx),$newLink.innerHTML=matchText,$newLink.href=matchText,$thisEl.parentNode.replaceChild($newLink,$link),$newText=document.createTextNode(" "),""===(null!=(ref=$newLink.nextSibling)?ref.nodeValue:void 0)?$newLink.parentNode.appendChild($newText):$newLink.parentNode.insertBefore($newText,$newLink.nextSibling),$newLink.addEventListener("mouseover",function(e){return makeTooltip($tt,this)}),$newLink.addEventListener("mouseleave",function(e){return removeTooltip($tt)}),setCaret($newText,1)}}},{"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],34:[function(require,module,exports){var $,setCaret;setCaret=require("../helper/setCaret.coffee"),$=require("../helper/selector.coffee").$,module.exports=function(){var anchorNode,anchorOffset,biRegex,rpl,selection,textContent;return selection=window.getSelection(),anchorNode=selection.anchorNode,anchorOffset=selection.anchorOffset,textContent=anchorNode.textContent,biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,rpl=function(regex,newText){var $text,ref,tmp;if(biRegex.test(anchorNode.parentNode)&&(anchorNode=anchorNode.parentNode,biRegex.test(anchorNode.parentNode)&&(anchorNode=anchorNode.parentNode,biRegex.test(anchorNode.parentNode)&&(anchorNode=anchorNode.parentNode,biRegex.test(anchorNode.parentNode)&&(anchorNode=anchorNode.parentNode)))),"PRE"===(null!=(ref=anchorNode.parentNode)?ref.nodeName:void 0));else if(regex.test(textContent))return textContent=textContent.replace(regex,newText),tmp=document.createElement("DIV"),tmp.innerHTML=textContent,$text=tmp.firstChild,anchorNode.parentNode.replaceChild($text,anchorNode),setCaret($text,anchorOffset)},rpl(/\.\.\./g,"&#8202;&hellip;&#8202;"),rpl(/\-\-/g,"&#8202;&mdash;&#8202;"),rpl(/1\/2/g,"&#8202;&#8202;&frac12;"),rpl(/1\/4/g,"&#8202;&#8202;&frac14;"),rpl(/3\/4/g,"&#8202;&#8202;&frac34;"),rpl(/(\d|½|¼|¾)"/g,"$1&Prime;"),rpl(/(\d|½|¼|¾)'/g,"$1&prime;"),rpl(/(\d+)-(\d+)/g,"$1&ndash;$2"),rpl(/"(\w)/g,"&ldquo;$1"),rpl(/(\S)"/g,"$1&rdquo;"),rpl(/'(\w)/g,"&lsquo;$1"),rpl(/(\S)'/g,"$1&rsquo;"),rpl(/(\w)‘(\w)/g,"$1&rsquo;$2")}},{"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],35:[function(require,module,exports){var $,$editable,$toolbar,setCaret;setCaret=require("../helper/setCaret.coffee"),$=require("../helper/selector.coffee").$,$editable=$(".js-editable"),$toolbar=$(".js-toolbar"),module.exports=function(){var $beginParent,anchorNode,anchorOffset,biRegex,selection,textContent,textHtml;return selection=window.getSelection(),anchorNode=selection.anchorNode,anchorOffset=selection.anchorOffset,null!==anchorNode?($beginParent=anchorNode.parentNode,textContent=anchorNode.textContent,textHtml=anchorNode.parentNode.innerHTML,biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode)))),/^(P|BLOCKQUOTE|H2|H3)$/.test($beginParent.nodeName)?(/^("|“)$/.test($beginParent.textContent[0])?$beginParent.classList.add("is-indent2"):$beginParent.classList.remove("is-indent2"),/^('|‘)$/.test($beginParent.textContent[0])?$beginParent.classList.add("is-indent1"):$beginParent.classList.remove("is-indent1")):void 0):void 0}},{"../helper/selector.coffee":17,"../helper/setCaret.coffee":18
}],36:[function(require,module,exports){var $,$$,$editable,blockquote,getCaret,h2,h3,p,ref,ref1,setCaret;getCaret=require("../helper/getCaret.coffee"),setCaret=require("../helper/setCaret.coffee"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("../helper/elementList.coffee"),p=ref1.p,h2=ref1.h2,h3=ref1.h3,blockquote=ref1.blockquote,$editable=$(".js-editable"),$editable.addEventListener("drop",function(e){return setTimeout(function(){var $allSpan,$span,i,len,results;for($allSpan=$$(".js-editable span"),results=[],i=0,len=$allSpan.length;len>i;i++)$span=$allSpan[i],results.push($span.outerHTML=$span.innerHTML);return results},100)}),$editable.addEventListener("keyup",function(e){var scTop,selection;return 13===e.keyCode&&(selection=window.getSelection(),scTop=selection.anchorNode.offsetTop||selection.anchorNode.parentNode.offsetTop)?window.scrollTo(0,scTop+100):void 0}),$editable.addEventListener("dragstart",function(e){var ref2,ref3;(null!=(ref2=e.target)&&null!=(ref3=ref2.classList)?ref3.contains("is-img"):void 0)&&e.preventDefault()}),$editable.addEventListener("keydown",function(e){var $blankP,$thisEl,biRegex,selection;if(selection=window.getSelection(),$thisEl=selection.anchorNode,biRegex=/^(B|I|EM|STRONG|A|SPAN)$/,biRegex.test($thisEl.parentNode.nodeName)&&($thisEl=$thisEl.parentNode,biRegex.test($thisEl.parentNode.nodeName)&&($thisEl=$thisEl.parentNode,biRegex.test($thisEl.parentNode.nodeName)&&($thisEl=$thisEl.parentNode,biRegex.test($thisEl.parentNode.nodeName)&&($thisEl=$thisEl.parentNode)))),$blankP=p(),$blankP.innerHTML="<br>","FIGCAPTION"===$thisEl.parentNode.nodeName||"FIGCAPTION"===$thisEl.nodeName){if(13===e.which)return e.preventDefault();if(selection.anchorOffset===$thisEl.textContent.length&&46===e.which)return e.preventDefault();if(0===selection.anchorOffset&&8===e.which)return e.preventDefault()}else if("LI"===$thisEl.nodeName){if(8===e.which&&null==$thisEl.nextSibling)return e.preventDefault(),null!=$thisEl.parentNode.nextSibling?$editable.insertBefore($blankP,$thisEl.parentNode.nextSibling):$editable.appendChild($blankP),$thisEl.parentNode.removeChild($thisEl),setCaret($blankP,0)}else{if($thisEl.parentNode.classList.contains("is-placeholder"))return $thisEl.parentNode.classList.remove("is-placeholder"),$thisEl.parentNode.classList.remove("b-graf--placeholder"),$thisEl.parentNode.innerHTML="<br>";if(13===e.which&&!e.shiftKey&&selection.anchorOffset===$thisEl.parentNode.lastChild.textContent.length&&"LI"!==$thisEl.parentNode.nodeName)return e.preventDefault(),null!=$thisEl.parentNode.nextSibling?$editable.insertBefore($blankP,$thisEl.parentNode.nextSibling):$editable.appendChild($blankP),setCaret($blankP,0)}}),$editable.addEventListener("keyup",function(e){var $allFont,$allSpan,$allStyled,$font,$newP,$prevEl,$span,$styled,$thisEl,i,j,k,len,len1,len2,placeholder,ref2,ref3,ref4,ref5,ref6,ref7,ref8,selection;for($allSpan=$$(".js-editable span"),i=0,len=$allSpan.length;len>i;i++)$span=$allSpan[i],(null!=(ref2=$span.classList)?ref2.contains("is-drop-cap"):void 0)?console.log:(null!=(ref3=$span.classList)?ref3.contains("is-small-caps"):void 0)?console.log:$span.outerHTML=$span.innerHTML;for($allFont=$$(".js-editable font"),j=0,len1=$allFont.length;len1>j;j++)$font=$allFont[j],$font.outerHTML=$font.innerHTML;for($allStyled=$$(".js-editable *[style]"),k=0,len2=$allStyled.length;len2>k;k++)$styled=$allStyled[k],$styled.removeAttribute("style");if(selection=window.getSelection(),$thisEl=selection.anchorNode,!e.ctrlKey&&!e.metaKey){if(13===e.which){if(e.shiftKey)return;/^(DIV|P|BLOCKQUOTE|PRE)$/.test($thisEl.nodeName)?($newP=p(),$newP.innerHTML="<br>",$editable.replaceChild($newP,$thisEl),setCaret($newP,0)):"DIV"===$thisEl.parentNode.nodeName?($newP=p(),$newP.innerHTML="<br>",$editable.replaceChild($newP,$thisEl.parentNode),setCaret($newP,0)):"LI"===$thisEl.parentNode.nodeName?$thisEl.parentNode.parentNode.lastChild===$thisEl.parentNode&&"<br>"===$thisEl.parentNode.innerHTML&&($thisEl.parentNode.parentNode.removeChild($thisEl.parentNode),$newP=p(),$newP.innerHTML="<br>",$editable.appendChild($newP),setCaret($newP,0)):/^(H2|H3|BLOCKQUOTE|PRE)$/.test($thisEl.parentNode.nodeName)&&($prevEl=$thisEl.parentNode.previousSibling,""===$prevEl.textContent&&($newP=p(),$newP.innerHTML="<br>",$editable.replaceChild($newP,$prevEl)))}else{if(/^(H2|H3|BLOCKQUOTE|P|PRE)$/.test($thisEl.nodeName))return;if("DIV"===$thisEl.parentNode.nodeName&&$thisEl!==$editable)return $newP=p(),$newP.innerHTML="<br>",$editable.replaceChild($newP,$thisEl),void setCaret($newP,0)}return placeholder={paragraph:"content&hellip;"},$newP="<p class='b-graf b-graf--placeholder is-placeholder'>"+placeholder.paragraph+"<br></p>",""===$editable.textContent?($editable.innerHTML=$newP,setCaret($editable.firstChild,0)):(null!=(ref4=$editable.firstChild)&&null!=(ref5=ref4.classList)?ref5.contains("is-placeholder"):void 0)||("#text"===$editable.firstChild.nodeName&&1===$editable.childNodes.length?($editable.innerHTML=$newP,setCaret($editable.firstChild,0)):""===$editable.firstChild.innerHTML?($editable.firstChild.innerHTML=$newP,setCaret($editable.firstChild,0)):"<p></p>"===$editable.firstChild.innerHTML?($editable.firstChild.innerHTML="<br>",setCaret($editable.firstChild,0)):"DIV"===$editable.firstChild.nodeName&&($editable.firstChild.innerHTML=$newP,setCaret($editable.firstChild,0))),"#text"===(null!=(ref6=$editable.childNodes[$editable.childNodes.length-3])?ref6.nodeName:void 0)&&$editable.removeChild($editable.childNodes[$editable.childNodes.length-3]),"#text"===(null!=(ref7=$editable.childNodes[$editable.childNodes.length-2])?ref7.nodeName:void 0)&&$editable.removeChild($editable.childNodes[$editable.childNodes.length-2]),"#text"===(null!=(ref8=$editable.childNodes[$editable.childNodes.length-1])?ref8.nodeName:void 0)?$editable.removeChild($editable.childNodes[$editable.childNodes.length-1]):void 0}})},{"../helper/elementList.coffee":15,"../helper/getCaret.coffee":16,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18}],37:[function(require,module,exports){var $,$$,$editable,blockquote1,blockquote2,charTransform,code,getCaret,h2,h3,hangingPunc,hr,ol,p,purify,ref,ref1,setCaret,ul;getCaret=require("../helper/getCaret.coffee"),setCaret=require("../helper/setCaret.coffee"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("../helper/elementList.coffee"),p=ref1.p,h2=ref1.h2,h3=ref1.h3,blockquote1=ref1.blockquote1,blockquote2=ref1.blockquote2,code=ref1.code,ul=ref1.ul,ol=ref1.ol,hr=ref1.hr,$editable=$(".js-editable"),hangingPunc=require("./hangingPunc.coffee"),charTransform=require("./charTransform.coffee"),purify=function(text){var transformed;return text||(text=""),transformed=text.replace(/</g,"&lt;").replace(/\.\.\./g,"&#8202;&hellip;&#8202;").replace(/\-\-/g,"&#8202;&mdash;&#8202;").replace(/1\/2/g,"&#8202;&#8202;&frac12;").replace(/1\/4/g,"&#8202;&#8202;&frac14;").replace(/3\/4/g,"&#8202;&#8202;&frac34;").replace(/(\d|½|¼|¾)"/g,"$1&Prime;").replace(/(\d|½|¼|¾)'/g,"$1&prime;").replace(/(\d+)-(\d+)/g,"$1&ndash;$2").replace(/([0-9])"/g,"$1&Prime;").replace(/([0-9])'/g,"$1&prime;").replace(/"(\w)/g,"&ldquo;$1").replace(/(\S)"/g,"$1&rdquo;").replace(/'(\w)/g,"&lsquo;$1").replace(/(\S)'/g,"$1&rsquo;")},$editable.addEventListener("paste",function(e){var $beginParent,$child,$div,$el,$elChild,$h,$newEl,$p,anchorNode,biRegex,html,i,isHTML,j,len,len1,plainText,ref2,ref3,selection,tag,tmp,transformed;if(e.preventDefault(),selection=window.getSelection(),anchorNode=selection.anchorNode,$beginParent=anchorNode.parentNode,biRegex=/^(B|I|STRONG|EM|A)$/,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode))),html=e.clipboardData.getData("text/html"),isHTML=!0,$newEl="",""===html&&(plainText=e.clipboardData.getData("text/plain"),html=plainText,isHTML=!1,$newEl=purify(html)),$div=document.createElement("DIV"),$div.innerHTML=html,isHTML)for(ref2=$div.childNodes,i=0,len=ref2.length;len>i;i++)if($child=ref2[i],/^(H1|H2|H3|H4|H5|H6)$/.test($child.nodeName))$h=/^(H1|H2)$/.test($child.nodeName)?h2():/^(H3|H4)$/.test($child.nodeName)?h3():blockquote1(),/^("|“)$/.test($child.textContent[0])?$h.classList.add("is-indent2"):$h.classList.remove("is-indent2"),/^('|‘)$/.test($child.textContent[0])?$h.classList.add("is-indent1"):$h.classList.remove("is-indent1"),transformed=purify($child.textContent),$h.innerHTML=transformed,tmp=document.createElement("DIV"),tmp.appendChild($h),$newEl+=tmp.innerHTML;else if(/^(P|BLOCKQUOTE|PRE|UL|OL)$/.test($child.nodeName)){for("P"===$child.nodeName?$el=p():"BLOCKQUOTE"===$child.nodeName?$el=blockquote2():"PRE"===$child.nodeName?$el=code():"UL"===$child.nodeName?$el=ul():"OL"===$child.nodeName&&($el=ol()),/^("|“)$/.test($child.textContent[0])?$el.classList.add("is-indent2"):$el.classList.remove("is-indent2"),/^('|‘)$/.test($child.textContent[0])?$el.classList.add("is-indent1"):$el.classList.remove("is-indent1"),tmp=document.createElement("DIV"),ref3=$child.childNodes,j=0,len1=ref3.length;len1>j;j++)$elChild=ref3[j],transformed=purify($elChild.textContent),/^(B|STRONG|EM|I|A|LI)$/.test($elChild.nodeName)?(tag=$elChild.nodeName.toLowerCase(),"A"===$elChild.nodeName?$el.innerHTML+="<"+tag+" href="+$elChild.href+">"+transformed+"</"+tag+">":$el.innerHTML+="<"+tag+">"+transformed+"</"+tag+">"):"BR"===$elChild.nodeName?$el.innerHTML+="<br>":$el.innerHTML+=""+transformed;tmp.appendChild($el),$newEl+=tmp.innerHTML}else"HR"===$child.nodeName?($el=hr(),tmp=document.createElement("DIV"),tmp.appendChild($el),$newEl+=tmp.innerHTML):/^(#text|#comment)$/.test($child.nodeName)||(tmp=document.createElement("DIV"),transformed=purify($child.textContent),/^(B|STRONG|EM|I|A|LI)$/.test($child.nodeName)?(tag=$child.nodeName.toLowerCase(),"A"===$child.nodeName?tmp.innerHTML+="<"+tag+" href="+$child.href+">"+transformed+"</"+tag+">":tmp.innerHTML+="<"+tag+">"+transformed+"</"+tag+">"):tmp.innerHTML+=""+transformed,$newEl+=tmp.innerHTML);return selection.deleteFromDocument(),isHTML&&($p=p(),$p.innerHTML="<br>",""===$editable.textContent?$editable.appendChild($p):$beginParent===$editable.lastChild?$editable.appendChild($p):$beginParent.parentNode===$editable&&null!=$beginParent.nextSibling?$editable.insertBefore($p,$beginParent.nextSibling):$beginParent===$editable&&($beginParent=anchorNode,$editable.insertBefore($p,anchorNode.nextSibling)),setCaret($p,0)),document.execCommand("insertHTML",!1,$newEl)})},{"../helper/elementList.coffee":15,"../helper/getCaret.coffee":16,"../helper/selector.coffee":17,"../helper/setCaret.coffee":18,"./charTransform.coffee":34,"./hangingPunc.coffee":35}],38:[function(require,module,exports){var Undo,editCommand,setCaret,setSelection,stack,toDom;Undo=require("undo.js"),stack=new Undo.Stack,setCaret=require("../helper/setCaret.coffee"),setSelection=require("../helper/setSelection.coffee"),toDom=require("../domParse.coffee").toDom,editCommand=Undo.Command.extend({constructor:function(editable,oldValue,newValue){return this.editable=editable,this.oldValue=oldValue,this.newValue=newValue},execute:function(){},undo:function(){return toDom(JSON.parse(this.oldValue)),this.editable.blur()},redo:function(){return toDom(JSON.parse(this.newValue)),this.editable.blur()}}),module.exports={stack:stack,editCommand:editCommand}},{"../domParse.coffee":14,"../helper/setCaret.coffee":18,"../helper/setSelection.coffee":19,"undo.js":32}],39:[function(require,module,exports){var $,$$,$disbtn,$editable,$img,$titleInput,$toolbar,addListenerMulti,hangingPunc,i,len,ref,ref1,toolbarChange;for(hangingPunc=require("./hangingPunc.coffee"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,$editable=$(".js-editable"),$toolbar=$(".js-toolbar"),$titleInput=$(".js-title-input"),$img=$$(".is-img"),$titleInput.addEventListener("focus",function(e){var $toolbarItem,i,len,ref1;for(ref1=$$(".js-toolbar button"),i=0,len=ref1.length;len>i;i++)$toolbarItem=ref1[i],$toolbarItem.classList.add("is-disabled");return $(".js-center").classList.remove("is-disabled"),$(".js-help").classList.remove("is-disabled")}),$editable.addEventListener("blur",function(){var $toolbarItem,anchorNode,i,len,ref1;if(anchorNode=window.getSelection().anchorNode,$editable.contains(anchorNode)){for(ref1=$$(".js-toolbar button"),i=0,len=ref1.length;len>i;i++)$toolbarItem=ref1[i],$toolbarItem.classList.add("is-disabled"),$toolbarItem.classList.remove("is-active");return $(".js-help").classList.remove("is-disabled")}}),addListenerMulti=function(el,s,fn){var ev,evts,i,len,results;for(evts=s.split(" "),results=[],i=0,len=evts.length;len>i;i++)ev=evts[i],results.push(el.addEventListener(ev,fn,!1));return results},$editable.addEventListener("blur",function(){var $toolbarItem,i,len,ref1,results;for(ref1=$$(".js-toolbar button"),results=[],i=0,len=ref1.length;len>i;i++)$toolbarItem=ref1[i],$toolbarItem.classList.remove("is-active"),results.push($toolbarItem.classList.add("is-disabled"));return results}),$editable.addEventListener("focus",function(){var $toolbarItem,i,len,ref1,results;for(ref1=$$(".js-toolbar button"),results=[],i=0,len=ref1.length;len>i;i++)$toolbarItem=ref1[i],results.push($toolbarItem.classList.remove("is-disabled"));return results}),ref1=$$(".is-disabled"),i=0,len=ref1.length;len>i;i++)$disbtn=ref1[i],$disbtn.addEventListener("click",function(e){return e.preventDefault()});$toolbar.addEventListener("click",function(e){return hangingPunc(),toolbarChange(e)}),addListenerMulti($editable,"keyup click",function(e){return toolbarChange(e)}),toolbarChange=function(e){var $beginParent,$btn,$elActive,$endParent,$target,anchorNode,biRegex,focusNode,j,k,len1,len2,range,ref2,ref3,ref4,ref6,ref7,ref8,ref9,selection,toggleElement,toggleInline;if("click"===e.type&&($target=e.target,$target.classList.contains("is-img"))){for(ref2=$$(".js-tooltip-image button"),j=0,len1=ref2.length;len1>j;j++)$btn=ref2[j],$btn.classList.remove("is-active");$target.parentNode.classList.contains("b-figure--left")?$(".js-img-left").classList.add("is-active"):$target.parentNode.classList.contains("b-figure--right")?$(".js-img-right").classList.add("is-active"):$target.parentNode.classList.contains("b-figure--center")?$(".js-img-center").classList.add("is-active"):$target.parentNode.classList.contains("b-figure--full")&&$(".js-img-full").classList.add("is-active"),$target.classList.contains("is-link")&&$(".js-img-link").classList.add("is-active")}if(selection=window.getSelection(),range=document.createRange(),anchorNode=selection.anchorNode,focusNode=selection.focusNode,null!==anchorNode)return $beginParent=anchorNode.parentNode,$endParent=focusNode.parentNode,biRegex=/^(B|I|STRONG|EM|A|SPAN)$/,toggleInline=function(regex,button){return regex.test($beginParent.nodeName||regex.test(anchorNode.nodeName))?$(button).classList.add("is-active"):regex.test($beginParent.parentNode.nodeName)?$(button).classList.add("is-active"):regex.test($beginParent.parentNode.parentNode.nodeName)?$(button).classList.add("is-active"):$(button).classList.remove("is-active")},toggleInline(/^(B|STRONG)$/,".js-bold"),toggleInline(/^(EM|I)$/,".js-italic"),toggleInline(/^(A)$/,".js-link"),biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode,biRegex.test($beginParent.nodeName)&&($beginParent=$beginParent.parentNode)))),biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode,biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode,biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode,biRegex.test($endParent.nodeName)&&($endParent=$endParent.parentNode)))),toggleElement=function(el,button){return $beginParent.nodeName===el||anchorNode.nodeName===el?$(button).classList.add("is-active"):$(button).classList.remove("is-active")},toggleElement("H2",".js-heading1"),toggleElement("H3",".js-heading2"),toggleElement("PRE",".js-code"),$beginParent.classList.contains("is-center")?$(".js-center").classList.add("is-active"):$(".js-center").classList.remove("is-active"),(null!=(ref4=$beginParent.firstChild.classList)?ref4.contains("is-drop-cap"):void 0)?$(".js-drop-cap").classList.add("is-active"):$(".js-drop-cap").classList.remove("is-active"),"BLOCKQUOTE"===$beginParent.nodeName||"BLOCKQUOTE"===anchorNode.nodeName?$beginParent.classList.contains("is-second")?($(".js-quote1").classList.add("is-active"),$(".js-quote2").classList.remove("is-active")):($(".js-quote2").classList.add("is-active"),$(".js-quote1").classList.remove("is-active")):($(".js-quote1").classList.remove("is-active"),$(".js-quote2").classList.remove("is-active")),"LI"===$beginParent.nodeName?"HR"===(null!=(ref6=$beginParent.parentNode)&&null!=(ref7=ref6.nextSibling)?ref7.nodeName:void 0)?$(".js-hr").classList.add("is-active"):$(".js-hr").classList.remove("is-active"):"HR"===(null!=(ref8=$beginParent.nextSibling)?ref8.nodeName:void 0)?$(".js-hr").classList.add("is-active"):$(".js-hr").classList.remove("is-active"),"LI"===$beginParent.nodeName?($(".js-heading1").classList.add("is-disabled"),$(".js-heading2").classList.add("is-disabled"),$(".js-quote1").classList.add("is-disabled"),$(".js-quote2").classList.add("is-disabled"),$(".js-code").classList.add("is-disabled")):(null!=(ref9=$beginParent.firstChild.classList)?ref9.contains("is-drop-cap"):void 0)?($(".js-heading1").classList.add("is-disabled"),$(".js-heading2").classList.add("is-disabled"),$(".js-quote1").classList.add("is-disabled"),$(".js-quote2").classList.add("is-disabled"),$(".js-code").classList.add("is-disabled")):($(".js-heading1").classList.remove("is-disabled"),$(".js-heading2").classList.remove("is-disabled"),$(".js-quote1").classList.remove("is-disabled"),$(".js-quote2").classList.remove("is-disabled"),$(".js-code").classList.remove("is-disabled")),"P"!==$beginParent.nodeName?$(".js-drop-cap").classList.add("is-disabled"):/^[a-zA-Z0-9]/.test($beginParent.textContent[0])?$(".js-drop-cap").classList.remove("is-disabled"):$(".js-drop-cap").classList.add("is-disabled"),/^(H2|H3)$/.test($beginParent.nodeName)?($(".js-link").classList.add("is-disabled"),$(".js-bold").classList.add("is-disabled"),$(".js-italic").classList.add("is-disabled")):($(".js-link").classList.remove("is-disabled"),$(".js-bold").classList.remove("is-disabled"),$(".js-italic").classList.remove("is-disabled")),"FIGCAPTION"===$beginParent.nodeName&&($(".js-heading1").classList.add("is-disabled"),$(".js-heading2").classList.add("is-disabled"),$(".js-quote1").classList.add("is-disabled"),$(".js-quote2").classList.add("is-disabled"),$(".js-code").classList.add("is-disabled"),$(".js-center").classList.add("is-disabled")),"PRE"===$beginParent.nodeName?$(".js-link").classList.add("is-disabled"):void 0;for(ref3=$$(".is-active"),k=0,len2=ref3.length;len2>k;k++)$elActive=ref3[k],$elActive.classList.remove("is-active"),$elActive.classList.add("is-disabled")}},{"../helper/selector.coffee":17,"./hangingPunc.coffee":35}],40:[function(require,module,exports){var $,langCatalog;$=require("./selector.coffee").$,langCatalog=LANG_CATALOG,module.exports={__:function(str){return langCatalog[str]||""},__n:function(str1,str2,str3){return 1===str3?langCatalog[str1].one.replace(/%s|%d/g,str3)||"":langCatalog[str1].other.replace(/%s|%d/g,str3)||""}}},{"./selector.coffee":41}],41:[function(require,module,exports){var $,$$;$=function(el){return document.querySelector(el)},$$=function(el){return document.querySelectorAll(el)},module.exports={$:$,$$:$$}},{}],42:[function(require,module,exports){var $,$addCollection,horsey,imgUrl,request,swal;$=require("../helper/selector.coffee").$,request=require("superagent"),swal=require("sweetalert"),horsey=require("horsey"),imgUrl="http://localhost:80/fr-img/",$addCollection=$(".js-add-to-collection"),$addCollection&&($addCollection.onclick=function(e){var $inputCol,articleId,autocompleteCollection,collectionId,collections,cols2;return articleId=this.getAttribute("data-article-id"),collectionId="",collections=[],swal({title:"Add to collection",type:"input",text:"search collection",closeOnConfirm:!1,showCancelButton:!0,showConfirmButton:!0,showLoaderOnConfirm:!0,customClass:"js-modal-collection"},function(confirm){var postData;return confirm?(postData={articleId:articleId,collectionId:collectionId,_csrf:CSRF},request.post("/c/add-article").set("Accept","application/json").send(postData).end(function(end,res){var resData;return resData=JSON.parse(res.text),swal(resData.error?{title:"Error",type:"error",text:resData.message||(resData.message="Not success")}:{title:"Success",type:"success",text:"Your article has been added to <a href='/c/"+resData.collection.username+"'><b class='text-green'>"+resData.collection.name+"</b></a>"})})):swal.close()}),$inputCol=$(".js-modal-collection").querySelector("input"),cols2=[],autocompleteCollection=horsey($inputCol,{render:function(li,suggestion){return li.innerHTML="<span class='i-user__ava'>\n  <img src='"+imgUrl+"col/"+suggestion._id+"-50.jpg'>\n</span>\n<span>\n  "+suggestion.text+" &middot; ("+suggestion.value+") &middot; <b>"+suggestion.follower_count+"</b>\n</span>"},suggestions:function(value,done){return request.get("/s/collections?q="+value).set("Accept","application/json").end(function(end,res){var col,cols,i,len;for(cols=JSON.parse(res.text),cols2=[],i=0,len=cols.length;len>i;i++)col=cols[i],col.value=""+col.username,col.text=col.name,delete col.username,delete col.name,cols2.push(col);return done(cols2)})}}),$inputCol.addEventListener("horsey-selected",function(e){var col,i,inputValue,len,results;for(inputValue=$inputCol.value,results=[],i=0,len=cols2.length;len>i;i++)col=cols2[i],col.value===inputValue?results.push(collectionId=col._id):results.push(void 0);return results})})},{"../helper/selector.coffee":41,horsey:72,superagent:116,sweetalert:127}],43:[function(require,module,exports){var $,$$,ref,swal;ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,swal=require("sweetalert"),module.exports={"delete":function(){var $deleteArticle,i,len,ref1,results;for(ref1=$$(".js-delete-article"),results=[],i=0,len=ref1.length;len>i;i++)$deleteArticle=ref1[i],results.push($deleteArticle.onclick=function(e){return swal({title:"Confirmation",text:"Are you sure?",showCancelButton:!0,showConfirmButton:!0},function(confirm){var $form;return confirm?($form=e.target.parentNode.querySelector(".js-delete-article-form"),$form.submit()):void 0})});return results},publish:function(){var $publishArticle,i,len,ref1,results;for(ref1=$$(".js-publish-article"),results=[],i=0,len=ref1.length;len>i;i++)$publishArticle=ref1[i],results.push($publishArticle.onclick=function(e){return swal({title:"Confirmation",text:"Are you sure?",showCancelButton:!0,showConfirmButton:!0},function(confirm){var $form;return confirm?($form=e.target.parentNode.querySelector(".js-publish-article-form"),$form.submit()):void 0})});return results}}},{"../helper/selector.coffee":41,sweetalert:127}],44:[function(require,module,exports){var $,$autoUser,assetUrl,autoCompleteOptions,horsey,imgUrl,ref,request;$=require("../helper/selector.coffee").$,horsey=require("horsey"),request=require("superagent"),$autoUser=$(".js-auto-user"),ref=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref.imgUrl,assetUrl=ref.assetUrl,$autoUser&&(autoCompleteOptions={anchor:"@",render:function(li,suggestion){return li.innerHTML="<span class='i-user__ava'>\n  <img src='"+imgUrl+"ava/"+suggestion._id+"-50.jpg'>\n</span>\n<span>\n  "+suggestion.text+" &middot; ("+suggestion.value+")\n</span>"},filter:function(q,suggestion){return suggestion},suggestions:function(value,done){var uname,valArr,valLn1;return value=value.replace(/@/g,""),valArr=value.split(" "),valLn1=valArr.length-1,uname=valArr[valLn1],request.get("/s/users?q="+uname).set("Accept","application/json").end(function(end,res){var i,len,user,users,users2;for(users=JSON.parse(res.text),users2=[],i=0,len=users.length;len>i;i++)user=users[i],user.value="@"+user.username,user.text=user.name,delete user.username,delete user.name,users2.push(user);return done(users2)})}},horsey($autoUser,autoCompleteOptions))},{"../../../../code/framesia/configClient.coffee":128,"../helper/selector.coffee":41,horsey:72,superagent:116}],45:[function(require,module,exports){var $,$jsArticle,articleId,beginTime,checkPercent,counter,delay,firstScroll,readInPercent,readingTime,request,seenInPercent,timeout;$=require("../helper/selector.coffee").$,$jsArticle=$(".js-article"),request=require("superagent"),$jsArticle&&(timeout=null,delay=300,beginTime=new Date,seenInPercent=0,readInPercent=0,readingTime=1*$jsArticle.getAttribute("data-reading-time"),articleId=$jsArticle.getAttribute("data-article-id"),articleId&&(socket.emit("view-article",{articleId:articleId}),counter=0,firstScroll=0,checkPercent=function(){var currentDate,height,ref,top;return ref=$jsArticle.getBoundingClientRect(),top=ref.top,height=ref.height,currentDate=new Date,0===firstScroll&&(beginTime=new Date),firstScroll++,seenInPercent=(window.innerHeight-top)/$jsArticle.offsetHeight*100,readInPercent=(currentDate-beginTime)/readingTime*100,seenInPercent>40&&readInPercent>40?(0===counter&&socket.emit("read-article",{articleId:articleId}),counter++):void 0},checkPercent(),window.addEventListener("scroll",function(e){return clearTimeout(timeout),timeout=setTimeout(function(){return checkPercent()},delay)})))},{"../helper/selector.coffee":41,superagent:116}],46:[function(require,module,exports){var $,$jsUsernameCol,$jsUsernameExist,$jsUsernameUser,request,usernameInit;$=require("../helper/selector.coffee").$,$jsUsernameUser=$(".js-username-user"),$jsUsernameCol=$(".js-username-col"),$jsUsernameExist=$(".js-username-exist"),request=require("superagent"),$jsUsernameUser&&(usernameInit=$jsUsernameUser.value,$jsUsernameUser.onkeyup=function(e){var val;return val=this.value,val!==usernameInit&&/[a-zA-Z0-9-]{3,16}/.test(val)?request.get("/u/"+this.value+"?check=true").end(function(err,res){var exist;return exist=JSON.parse(res.text),exist?$jsUsernameExist.classList.remove("is-hidden"):$jsUsernameExist.classList.add("is-hidden")}):void 0}),$jsUsernameCol&&(usernameInit=$jsUsernameCol.value,$jsUsernameCol.onkeyup=function(e){var val;return val=this.value,val!==usernameInit&&/[a-zA-Z0-9-]{3,30}/.test(val)?request.get("/c/"+this.value+"?check=true").end(function(err,res){var exist;return exist=JSON.parse(res.text),exist?$jsUsernameExist.classList.remove("is-hidden"):$jsUsernameExist.classList.add("is-hidden")}):void 0})},{"../helper/selector.coffee":41,superagent:116}],47:[function(require,module,exports){var $,$switch1,$switch2,ref;$=require("../helper/selector.coffee").$,$switch1=$(".js-switch1"),$switch2=$(".js-switch2"),null!=$switch1&&($switch1.onchange=function(e){return $switch1.checked?$switch2.classList.remove("is-hidden"):($switch2.classList.add("is-hidden"),$switch2.querySelector("input").checked=!1)}),null!=(ref=$(".js-delete-col"))&&(ref.onclick=function(e){return $(".js-form-delete-col").classList.toggle("is-hidden")})},{"../helper/selector.coffee":41}],48:[function(require,module,exports){var $,$$,$$acceptArticle,$$mainFeatured,$$makeFeatured,$$rejectArticle,$$removeArticle,$$removeFeatured,$$removeMainFeatured,$acceptArticle,$formAcceptArticle,$formMainFeatured,$formMakeFeatured,$formRejectArticle,$formRemoveArticle,$formRemoveFeatured,$formRemoveMainFeatured,$inputAcceptArticle,$inputMainFeatured,$inputMakeFeatured,$inputRejectArticle,$inputRemoveArticle,$inputRemoveFeatured,$inputRemoveMainFeatured,$mainFeatured,$makeFeatured,$rejectArticle,$removeArticle,$removeFeatured,$removeMainFeatured,i,j,k,l,len,len1,len2,len3,len4,len5,len6,m,n,o,ref;for(ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,$$removeMainFeatured=$$(".js-remove-main-featured"),$inputRemoveMainFeatured=$(".js-input-remove-main-featured"),$formRemoveMainFeatured=$(".js-form-remove-main-featured"),i=0,len=$$removeMainFeatured.length;len>i;i++)$removeMainFeatured=$$removeMainFeatured[i],$removeMainFeatured.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputRemoveMainFeatured.value=articleId,$formRemoveMainFeatured.submit()};for($$removeFeatured=$$(".js-remove-featured"),$inputRemoveFeatured=$(".js-input-remove-featured"),$formRemoveFeatured=$(".js-form-remove-featured"),j=0,len1=$$removeFeatured.length;len1>j;j++)$removeFeatured=$$removeFeatured[j],$removeFeatured.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputRemoveFeatured.value=articleId,$formRemoveFeatured.submit()};for($$mainFeatured=$$(".js-main-featured"),$inputMainFeatured=$(".js-input-main-featured"),$formMainFeatured=$(".js-form-main-featured"),k=0,len2=$$mainFeatured.length;len2>k;k++)$mainFeatured=$$mainFeatured[k],$mainFeatured.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputMainFeatured.value=articleId,$formMainFeatured.submit()};for($$makeFeatured=$$(".js-make-featured"),$inputMakeFeatured=$(".js-input-make-featured"),$formMakeFeatured=$(".js-form-make-featured"),l=0,len3=$$makeFeatured.length;len3>l;l++)$makeFeatured=$$makeFeatured[l],$makeFeatured.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputMakeFeatured.value=articleId,$formMakeFeatured.submit()};for($$removeArticle=$$(".js-remove-article"),$inputRemoveArticle=$(".js-input-remove-article"),$formRemoveArticle=$(".js-form-remove-article"),m=0,len4=$$removeArticle.length;len4>m;m++)$removeArticle=$$removeArticle[m],$removeArticle.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputRemoveArticle.value=articleId,$formRemoveArticle.submit()};for($$acceptArticle=$$(".js-accept-article"),$inputAcceptArticle=$(".js-input-accept-article"),$formAcceptArticle=$(".js-form-accept-article"),n=0,len5=$$acceptArticle.length;len5>n;n++)$acceptArticle=$$acceptArticle[n],$acceptArticle.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputAcceptArticle.value=articleId,$formAcceptArticle.submit()};for($$rejectArticle=$$(".js-reject-article"),$inputRejectArticle=$(".js-input-reject-article"),$formRejectArticle=$(".js-form-reject-article"),o=0,len6=$$rejectArticle.length;len6>o;o++)$rejectArticle=$$rejectArticle[o],$rejectArticle.onclick=function(e){var articleId;return articleId=this.getAttribute("data-article-id"),$inputRejectArticle.value=articleId,$formRejectArticle.submit()}},{"../helper/selector.coffee":41}],49:[function(require,module,exports){var $,$acceptRequest,$formAcceptRequest,$formMakeAdmin,$formQuitCollection,$formRemoveAdmin,$formRemoveMember,$formRemoveRequest,$inputAcceptRequest,$inputMakeAdmin,$inputRemoveAdmin,$inputRemoveMember,$inputRemoveRequest,$makeAdmin,$quitCollection,$removeAdmin,$removeMember,$removeRequest,$requestJoin,collectionId,request;$=require("../helper/selector.coffee").$,request=require("superagent"),$makeAdmin=$(".js-make-admin"),$inputMakeAdmin=$(".js-input-make-admin"),$formMakeAdmin=$(".js-form-make-admin"),null!=$makeAdmin&&($makeAdmin.onclick=function(e){var userId;return userId=this.getAttribute("data-user-id"),$inputMakeAdmin.value=userId,$formMakeAdmin.submit()}),$removeAdmin=$(".js-remove-admin"),$inputRemoveAdmin=$(".js-input-remove-admin"),$formRemoveAdmin=$(".js-form-remove-admin"),null!=$removeAdmin&&($removeAdmin.onclick=function(e){var userId;return userId=this.getAttribute("data-user-id"),$inputRemoveAdmin.value=userId,$formRemoveAdmin.submit()}),$removeMember=$(".js-remove-member"),$inputRemoveMember=$(".js-input-remove-member"),$formRemoveMember=$(".js-form-remove-member"),null!=$removeMember&&($removeMember.onclick=function(e){var userId;return userId=this.getAttribute("data-user-id"),$inputRemoveMember.value=userId,$formRemoveMember.submit();
}),$acceptRequest=$(".js-accept-request"),$inputAcceptRequest=$(".js-input-accept-request"),$formAcceptRequest=$(".js-form-accept-request"),null!=$acceptRequest&&($acceptRequest.onclick=function(e){var userId;return userId=this.getAttribute("data-user-id"),$inputAcceptRequest.value=userId,$formAcceptRequest.submit()}),$removeRequest=$(".js-remove-request"),$inputRemoveRequest=$(".js-input-remove-request"),$formRemoveRequest=$(".js-form-remove-request"),null!=$removeRequest&&($removeRequest.onclick=function(e){var userId;return userId=this.getAttribute("data-user-id"),$inputRemoveRequest.value=userId,$formRemoveRequest.submit()}),$quitCollection=$(".js-quit-collection"),$formQuitCollection=$(".js-form-quit-collection"),null!=$quitCollection&&($quitCollection.onclick=function(e){return $formQuitCollection.submit()}),$requestJoin=$(".js-request-join"),$requestJoin&&(collectionId=$requestJoin.getAttribute("data-collection-id"),request.get("/c/request-join/"+collectionId).set("Accept","application/json").end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.requested?$follow.innerHTML="Requested":void 0}),$requestJoin.onclick=function(e){return this.setAttribute("disabled",!0),request.post("/c/request-join/"+collectionId).send({_csrf:CSRF}).set("Accept","application/json").end(function(err,res){var resData;return $requestJoin.removeAttribute("disabled"),resData=JSON.parse(res.text),resData.error?void 0:$requestJoin.innerHTML="Requested"})})},{"../helper/selector.coffee":41,superagent:116}],50:[function(require,module,exports){var $,$$,ref,ref1,ref2,ref3,ref4,request;request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,null!=(ref1=$(".js-article-comment"))&&(ref1.onclick=function(e){return document.body.classList.contains("is-show")?($(".js-comment").classList.remove("is-show"),document.body.classList.remove("is-show")):($(".js-comment").classList.add("is-show"),document.body.classList.add("is-show"))}),null!=(ref2=$(".js-comment-close"))&&(ref2.onclick=function(e){return $(".js-article-comment").click()}),null!=(ref3=$(".js-comment-input"))&&(ref3.onkeydown=function(e){var limitText;return limitText=200-this.value.length,$(".js-comment-limit").textContent=limitText,8===e.keyCode||46===e.keyCode?!0:!(0>=limitText)}),null!=(ref4=$(".js-comment-submit"))&&(ref4.onclick=function(e){var $commentInput,$commentSubmit,articleId,inputValue;return $commentInput=$(".js-comment-input"),$commentSubmit=$(".js-comment-submit"),inputValue=$commentInput.value,articleId=$commentInput.getAttribute("data-article-id"),$commentInput.disabled=!0,$commentSubmit.disabled=!0,request.post("/c").send({content:inputValue,article_id:articleId,_csrf:CSRF}).set("Accept","application/json").end(function(err,res){return $commentSubmit.disabled=!1,$commentInput.disabled=!1,$commentInput.value="",$(".js-load-more-comment-feed2").click()})})},{"../helper/selector.coffee":41,superagent:116}],51:[function(require,module,exports){var $,$$,ref;ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,module.exports=function(){var $form,formMethod,i,inputCSRF,len,ref1,results;for(ref1=$$("form"),results=[],i=0,len=ref1.length;len>i;i++)$form=ref1[i],formMethod=$form.getAttribute("method"),"post"===(null!=formMethod?formMethod.toLowerCase():void 0)&&"_csrf"!==$form.firstChild.getAttribute("name")?(inputCSRF="<input type='hidden' name='_csrf' value='"+CSRF+"'>",results.push($form.innerHTML=inputCSRF+$form.innerHTML)):results.push(void 0);return results}},{"../helper/selector.coffee":41}],52:[function(require,module,exports){var $,ref,ref1,ref2,ref3;$=require("../helper/selector.coffee").$,document.onclick=function(e){var ref,ref1,ref10,ref11,ref12,ref13,ref14,ref15,ref2,ref3,ref4,ref5,ref6,ref7,ref8,ref9;return(null!=(ref=e.target.parentNode)&&null!=(ref1=ref.classList)?ref1.contains("js-down-article"):void 0)||(null!=(ref2=e.target.classList)?ref2.contains("js-down-article"):void 0)?!1:(null!=(ref3=e.target.parentNode)&&null!=(ref4=ref3.classList)?ref4.contains("js-down-user"):void 0)||(null!=(ref5=e.target.classList)?ref5.contains("js-down-user"):void 0)?!1:(null!=(ref6=e.target.parentNode)&&null!=(ref7=ref6.classList)?ref7.contains("js-down-editor"):void 0)||(null!=(ref8=e.target.classList)?ref8.contains("js-down-editor"):void 0)?!1:(null!=(ref9=e.target.parentNode)&&null!=(ref10=ref9.classList)?ref10.contains("js-down-notif"):void 0)||(null!=(ref11=e.target.classList)?ref11.contains("js-down-notif"):void 0)?!1:(null!=(ref12=$(".js-drop-user"))&&ref12.classList.add("is-hidden"),null!=(ref13=$(".js-drop-editor"))&&ref13.classList.add("is-hidden"),null!=(ref14=$(".js-drop-article"))&&ref14.classList.add("is-hidden"),null!=(ref15=$(".js-drop-notif"))?ref15.classList.add("is-hidden"):void 0)},null!=(ref=$(".js-down-editor"))&&(ref.onclick=function(e){var ref1,ref2,ref3;return null!=(ref1=$(".js-drop-user"))&&null!=(ref2=ref1.classList)&&ref2.add("is-hidden"),null!=(ref3=$(".js-drop-notif"))&&ref3.classList.add("is-hidden"),$(".js-drop-editor").classList.toggle("is-hidden")}),null!=(ref1=$(".js-down-user"))&&(ref1.onclick=function(e){var ref2,ref3,ref4;return null!=(ref2=$(".js-drop-editor"))&&ref2.classList.add("is-hidden"),null!=(ref3=$(".js-drop-article"))&&ref3.classList.add("is-hidden"),null!=(ref4=$(".js-drop-notif"))&&ref4.classList.add("is-hidden"),$(".js-drop-user").classList.toggle("is-hidden")}),null!=(ref2=$(".js-down-article"))&&(ref2.onclick=function(e){var ref3,ref4,ref5;return null!=(ref3=$(".js-drop-user"))&&null!=(ref4=ref3.classList)&&ref4.add("is-hidden"),null!=(ref5=$(".js-drop-notif"))&&ref5.classList.add("is-hidden"),$(".js-drop-article").classList.toggle("is-hidden")}),null!=(ref3=$(".js-down-notif"))&&(ref3.onclick=function(e){var ref4,ref5,ref6,ref7;return null!=(ref4=$(".js-drop-user"))&&null!=(ref5=ref4.classList)&&ref5.add("is-hidden"),null!=(ref6=$(".js-drop-editor"))&&ref6.classList.add("is-hidden"),null!=(ref7=$(".js-drop-article"))&&ref7.classList.add("is-hidden"),$(".js-drop-notif").classList.toggle("is-hidden")})},{"../helper/selector.coffee":41}],53:[function(require,module,exports){var $,$$,$colrightFeed,$topicFeed,$topicSpinner,$trendaFeed,$trendaSpinner,$userFeed,$userSpinner,__,__n,assetUrl,colrightFeed,feedTemplate,feedTemplate2,feedTemplate3,feedTemplate4,i,imgUrl,len,loadFeed,loadFeed2,loadFeed3,loadFeed4,ref,ref1,ref2,ref3,request;if(request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("../helper/langCatalog.coffee"),__=ref1.__,__n=ref1.__n,ref2=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref2.imgUrl,assetUrl=ref2.assetUrl,feedTemplate=require("../../../../code/framesia/views/blocks/tag.jade"),feedTemplate2=require("../../../../code/framesia/views/blocks/post3.jade"),feedTemplate3=require("../../../../code/framesia/views/blocks/col-list.jade"),feedTemplate4=require("../../../../code/framesia/views/blocks/user-list.jade"),$topicFeed=$(".js-topic-feed"),$topicSpinner=$(".js-topic-spinner"),$trendaFeed=$(".js-trenda-feed"),$trendaSpinner=$(".js-trenda-spinner"),$colrightFeed=$(".js-colright-feed"),$userFeed=$(".js-user-feed"),$userSpinner=$(".js-user-spinner"),loadFeed=function(){var isQuery,url;return url="/t/topics",isQuery=$topicFeed.getAttribute("data-query"),isQuery&&(url="/s/topics?q="+isQuery),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,tags;return tags=JSON.parse(res.text),local={tags:tags},feedHtml=feedTemplate(local),$topicFeed.innerHTML=feedHtml,$topicFeed.classList.remove("is-empty"),$topicSpinner.classList.add("is-hidden")})},$topicFeed&&loadFeed(),loadFeed2=function(){var isUser,url;return isUser=$trendaFeed.getAttribute("data-username"),url=isUser?"/u/"+isUser+"/feed-loved-articles":"/t/articles",request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,posts;return posts=JSON.parse(res.text),local={post:posts},feedHtml=feedTemplate2(local),""===feedHtml&&(feedHtml="<div class='i-block-empty'> "+__("No articles")+"</div>"),$trendaFeed.innerHTML=feedHtml,$trendaFeed.classList.remove("is-empty"),$trendaSpinner.classList.add("is-hidden")})},$trendaFeed&&loadFeed2(),loadFeed3=function($colrightFeed){var isColContributed,isColFollow,isQuery,url,username;return username=$colrightFeed.getAttribute("data-username"),isColContributed=$colrightFeed.getAttribute("data-col-contr"),isColFollow=$colrightFeed.getAttribute("data-col-follow"),isQuery=$colrightFeed.getAttribute("data-query"),isColContributed?url="/u/"+username+"/feed-collections":isColFollow?url="/u/"+username+"/feed-following-collections":isQuery&&(url="/s/collections?q="+isQuery+"&all=true"),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,posts;return posts=JSON.parse(res.text),isQuery&&(posts.collections=posts),local=posts,local.IMG_URL=imgUrl,feedHtml=feedTemplate3(local),""===feedHtml&&(feedHtml="<div class='i-block-empty'> "+__("No collections")+"</div>"),$colrightFeed.innerHTML=feedHtml,$colrightFeed.classList.remove("is-empty"),$colrightFeed.parentNode.querySelector(".spinner").classList.add("is-hidden")})},$colrightFeed)for(ref3=$$(".js-colright-feed"),i=0,len=ref3.length;len>i;i++)colrightFeed=ref3[i],loadFeed3(colrightFeed);loadFeed4=function(){var isQuery,url;return isQuery=$userFeed.getAttribute("data-query"),isQuery&&(url="/s/users?q="+isQuery),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,users;return users=JSON.parse(res.text),local={users:users,IMG_URL:imgUrl},feedHtml=feedTemplate4(local),$userFeed.innerHTML=feedHtml,$userFeed.classList.remove("is-empty"),$userSpinner.classList.add("is-hidden")})},$userFeed&&loadFeed4()},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/col-list.jade":130,"../../../../code/framesia/views/blocks/post3.jade":136,"../../../../code/framesia/views/blocks/tag.jade":138,"../../../../code/framesia/views/blocks/user-list.jade":139,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,superagent:116}],54:[function(require,module,exports){var $,$img,loadImage,resizeCropImg;$=require("../helper/selector.coffee").$,loadImage=require("blueimp-load-image-npm"),$(".js-first-time-ava")&&($img=$(".js-first-time-ava"),resizeCropImg=function(img){return $img.src=img.toDataURL("image/jpeg",.9),$(".js-first-time-ava-data").value=img.toDataURL("image/jpeg",.9)},loadImage($img.src,resizeCropImg,{canvas:!0,maxWidth:200,maxHeight:200,crop:!0,crossOrigin:"anonymous"}),$img.onclick=function(e){return $(".js-first-time-ava-input").click()},$(".js-first-time-ava-input").onchange=function(e){return loadImage(e.target.files[0],resizeCropImg,{canvas:!0,maxWidth:200,maxHeight:200,crop:!0})})},{"../helper/selector.coffee":41,"blueimp-load-image-npm":70}],55:[function(require,module,exports){var $,$follow,request;request=require("superagent"),$=require("../helper/selector.coffee").$,$follow=$(".js-follow"),$follow&&(request.get("/f/"+$follow.getAttribute("data-follow-type")+"/"+$follow.getAttribute("data-follow-id")).end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.following?($follow.classList.add("is-following"),$follow.innerHTML="Following"):($follow.classList.remove("is-following"),$follow.innerHTML="Follow")}),$follow.onmouseover=function(e){return $follow.classList.contains("is-following")?$follow.innerHTML="Unfollow":void 0},$follow.onmouseleave=function(e){return $follow.classList.contains("is-following")?$follow.innerHTML="Following":void 0},$follow.onclick=function(e){var followId,followType;return followId=this.getAttribute("data-follow-id"),followType=this.getAttribute("data-follow-type"),this.setAttribute("disabled",!0),this.classList.add("is-disabled"),request.post("/f").send({followId:followId,followType:followType,_csrf:CSRF}).end(function(err,res){var resData;return $follow.removeAttribute("disabled"),$follow.classList.remove("is-disabled"),resData=JSON.parse(res.text),resData.following?($follow.classList.add("is-following"),$follow.innerHTML="Following"):($follow.classList.remove("is-following"),$follow.innerHTML="Follow")})})},{"../helper/selector.coffee":41,superagent:116}],56:[function(require,module,exports){var $,$articleButton,articleId,request;request=require("superagent"),$=require("../helper/selector.coffee").$,$articleButton=$(".js-article-button"),$articleButton&&(articleId=$articleButton.getAttribute("data-article-id"),request.get("/p/"+articleId+"/my-activity").set("Accept","application/json").end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.loved&&$(".js-article-love").classList.add("is-loving"),resData.commented&&$(".js-article-comment").classList.add("is-comment"),resData.responded&&$(".js-article-response").classList.add("is-response"),resData.reposted?$(".js-article-repost").classList.add("is-repost"):void 0}))},{"../helper/selector.coffee":41,superagent:116}],57:[function(require,module,exports){var $,$homeFeed,$homeSpinner,$loadMoreHomeFeed,__,__n,assetUrl,feedTemplate,feedTemplateCol,imgUrl,loadFeed,love,ref,ref1,repost,request;request=require("superagent"),$=require("../helper/selector.coffee").$,ref=require("../helper/langCatalog.coffee"),__=ref.__,__n=ref.__n,love=require("./love.coffee"),repost=require("./repost.coffee"),feedTemplate=require("../../../../code/framesia/views/blocks/post.jade"),feedTemplateCol=require("../../../../code/framesia/views/blocks/post4.jade"),ref1=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref1.imgUrl,assetUrl=ref1.assetUrl,$homeFeed=$(".js-article-feed"),$homeSpinner=$(".js-article-spinner"),$loadMoreHomeFeed=$(".js-load-more-article-feed"),loadFeed=function(){var firstReq,isCollection,isHome,isProfile,isQuery,isStream,lastDate,template,url;return isHome=$homeFeed.getAttribute("data-home"),isStream=$homeFeed.getAttribute("data-stream"),isProfile=$homeFeed.getAttribute("data-article-id"),isCollection=$homeFeed.getAttribute("data-collection-name"),isQuery=$homeFeed.getAttribute("data-query"),$loadMoreHomeFeed.classList.add("is-hidden"),template=feedTemplate,isProfile?url="/p/profile-feed/"+isProfile:isCollection?url="/c/"+isCollection+"/feed-articles":isQuery?url="/s/posts?q="+isQuery:isStream?url="/p/stream-feed":isHome&&(url="/p/home-feed"),$homeFeed.classList.contains("is-empty")?firstReq=!0:isQuery?(lastDate=$homeFeed.childNodes.length,url+="&last="+lastDate):(lastDate=$homeFeed.lastChild.getAttribute("data-published-at"),url+="?last="+lastDate),$homeSpinner.classList.remove("is-hidden"),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,posts;return posts=JSON.parse(res.text),local={post:posts,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=template(local),$homeFeed.innerHTML+=feedHtml,$homeFeed.classList.remove("is-empty"),$loadMoreHomeFeed.classList.remove("is-hidden"),""===feedHtml&&(firstReq===!0&&(feedHtml="<div class='i-block-empty'> "+__("No articles")+"</div>"),$loadMoreHomeFeed.classList.add("is-hidden")),$homeSpinner.classList.add("is-hidden"),love.article(),repost()})},$homeFeed&&(loadFeed(),$loadMoreHomeFeed.onclick=function(e){return loadFeed()})},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/post.jade":134,"../../../../code/framesia/views/blocks/post4.jade":137,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,"./love.coffee":62,"./repost.coffee":66,superagent:116}],58:[function(require,module,exports){var $,$articleFeed,$articleSpinner,$loadMoreArticleFeed,__,__n,article,articleFeed,assetUrl,csrf,feedTemplate,imgUrl,ref,ref1,request;request=require("superagent"),$=require("../helper/selector.coffee").$,ref=require("../helper/langCatalog.coffee"),__=ref.__,__n=ref.__n,article=require("./article.coffee"),csrf=require("./csrf.coffee"),feedTemplate=require("../../../../code/framesia/views/blocks/post-item.jade"),ref1=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref1.imgUrl,assetUrl=ref1.assetUrl,$articleFeed=$(".js-article2-feed"),$articleSpinner=$(".js-article2-spinner"),$loadMoreArticleFeed=$(".js-load-more-article2-feed"),articleFeed=function(){var firstReq,isDraft,lastEdited,url;return isDraft=$articleFeed.getAttribute("data-draft"),$loadMoreArticleFeed.classList.add("is-hidden"),url=isDraft?"/me/feed-drafts":"/me/feed-articles",$articleFeed.classList.contains("is-empty")?firstReq=!0:(lastEdited=$articleFeed.lastChild.getAttribute("data-edited-at"),url+="?last="+lastEdited),$articleSpinner.classList.remove("is-hidden"),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,posts;return posts=JSON.parse(res.text),local={post:posts,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=feedTemplate(local),$loadMoreArticleFeed.classList.remove("is-hidden"),""===feedHtml&&(firstReq===!0&&(feedHtml="<div class='i-block-empty'> "+__("No articles")+"</div>"),$loadMoreArticleFeed.classList.add("is-hidden")),$articleFeed.innerHTML+=feedHtml,$articleFeed.classList.remove("is-empty"),$articleSpinner.classList.add("is-hidden"),csrf(),article["delete"](),article.publish()})},$articleFeed&&(articleFeed(),$loadMoreArticleFeed.onclick=function(e){return articleFeed()})},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/post-item.jade":133,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,"./article.coffee":43,"./csrf.coffee":51,superagent:116}],59:[function(require,module,exports){var $,$$,$commentFeed,$commentSpinner,$commentSpinner2,$loadMoreCommentFeed,$loadMoreCommentFeed2,__,__n,articleId,assetUrl,feedTemplate,imgUrl,loadFeed,love,ref,ref1,ref2,request;request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("../helper/langCatalog.coffee"),__=ref1.__,__n=ref1.__n,love=require("./love.coffee"),feedTemplate=require("../../../../code/framesia/views/blocks/comment-list.jade"),ref2=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref2.imgUrl,assetUrl=ref2.assetUrl,$commentFeed=$(".js-comment-feed"),$commentSpinner=$(".js-comment-spinner"),$commentSpinner2=$(".js-comment-spinner2"),$loadMoreCommentFeed=$(".js-load-more-comment-feed"),$loadMoreCommentFeed2=$(".js-load-more-comment-feed2"),articleId=null!=$commentFeed?$commentFeed.getAttribute("data-article-id"):void 0,loadFeed=function(before){var firstId,firstReq,lastId,url;return $commentFeed.classList.contains("is-empty")?(url="/c/a/"+articleId,firstReq=!0):(lastId=$commentFeed.lastChild.getAttribute("id"),url="/c/a/"+articleId+"?last="+lastId),before===!0?(firstId=$commentFeed.firstChild.getAttribute("id"),url="/c/a/"+articleId+"?first="+firstId,$loadMoreCommentFeed2.classList.add("is-hidden"),$commentSpinner2.classList.remove("is-hidden")):($loadMoreCommentFeed.classList.add("is-hidden"),$commentSpinner.classList.remove("is-hidden")),request.get(url).end(function(err,res){var $delete,$reply,data,feedHtml,i,j,k,len,len1,local,ref3,ref4,results;for(data=JSON.parse(res.text),local={is_login:data.is_login,comments:data.comments,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=feedTemplate(local),before===!0?$loadMoreCommentFeed2.classList.remove("is-hidden"):$loadMoreCommentFeed.classList.remove("is-hidden"),""===feedHtml&&(firstReq===!0&&(feedHtml="<div class='i-block-empty'> "+__("No comment")+"</div>"),before===!0?$loadMoreCommentFeed2.classList.add("is-hidden"):$loadMoreCommentFeed.classList.add("is-hidden")),before===!0?($commentFeed.innerHTML=feedHtml+$commentFeed.innerHTML,$commentSpinner2.classList.add("is-hidden")):($commentFeed.innerHTML+=feedHtml,$commentSpinner.classList.add("is-hidden")),$commentFeed.classList.remove("is-empty"),love.comment(),ref3=$$(".js-comment-reply"),i=j=0,len=ref3.length;len>j;i=++j)$reply=ref3[i],$reply.onclick=function(e){var $input,commentId,self,username;return username=this.getAttribute("data-username"),commentId=this.getAttribute("data-comment-id"),self=this,$input=$(".js-comment-input"),$input.value="@"+username+" ",$input.focus()};for(ref4=$$(".js-comment-delete"),results=[],i=k=0,len1=ref4.length;len1>k;i=++k)$delete=ref4[i],results.push($delete.onclick=function(e){var commentId;return commentId=this.getAttribute("data-comment-id"),$commentFeed.removeChild(this.parentNode.parentNode.parentNode),0===$commentFeed.childNodes.length&&$commentFeed.classList.add("is-empty"),request.post("/c/delete/"+commentId).send({_csrf:CSRF}).end(function(err,res){return console.log})});return results})},$commentFeed&&(loadFeed(),$loadMoreCommentFeed.onclick=function(e){return loadFeed()},$loadMoreCommentFeed2.onclick=function(e){return loadFeed(!0)})},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/comment-list.jade":131,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,"./love.coffee":62,superagent:116}],60:[function(require,module,exports){var $,$loadMoreLovedArticleFeed,$lovedArticleFeed,$lovedArticleSpinner,__,__n,assetUrl,feedTemplate,imgUrl,loadLovedArticleFeed,love,ref,ref1,repost,request;request=require("superagent"),$=require("../helper/selector.coffee").$,ref=require("../helper/langCatalog.coffee"),__=ref.__,__n=ref.__n,love=require("./love.coffee"),repost=require("./repost.coffee"),feedTemplate=require("../../../../code/framesia/views/blocks/post2.jade"),ref1=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref1.imgUrl,assetUrl=ref1.assetUrl,$lovedArticleFeed=$(".js-loved-article-feed"),$lovedArticleSpinner=$(".js-loved-article-spinner"),$loadMoreLovedArticleFeed=$(".js-load-more-loved-article-feed"),loadLovedArticleFeed=function(){var firstReq,loveId,url,username;return username=$lovedArticleFeed.getAttribute("data-username"),$loadMoreLovedArticleFeed.classList.add("is-hidden"),url=username?"/u/"+username+"/feed-loved-articles":"/me/feed-loved-articles",$lovedArticleFeed.classList.contains("is-empty")?firstReq=!0:(loveId=$lovedArticleFeed.lastChild.getAttribute("data-love-id"),url+="?last="+loveId),$lovedArticleSpinner.classList.remove("is-hidden"),request.get(url).set("Accept","application/json").end(function(err,res){var feedHtml,local,posts;return posts=JSON.parse(res.text),local={post:posts,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=feedTemplate(local),$lovedArticleFeed.innerHTML+=feedHtml,$lovedArticleFeed.classList.remove("is-empty"),$loadMoreLovedArticleFeed.classList.remove("is-hidden"),""===feedHtml&&(firstReq===!0&&(feedHtml="<div class='i-block-empty'> "+__("No articles")+"</div>"),$loadMoreLovedArticleFeed.classList.add("is-hidden")),$lovedArticleSpinner.classList.add("is-hidden"),love.article(),repost()})},$lovedArticleFeed&&(loadLovedArticleFeed(),$loadMoreLovedArticleFeed.onclick=function(e){return loadLovedArticleFeed()})},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/post2.jade":135,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,"./love.coffee":62,"./repost.coffee":66,superagent:116}],61:[function(require,module,exports){var $,$header,lastScrollTop,prevDirection;$=require("../helper/selector.coffee").$,$header=$(".b-header"),lastScrollTop=0,prevDirection="down",window.addEventListener("scroll",function(e){var direction,st;return st=window.pageYOffset||document.documentElement.scrollTop,direction=st>lastScrollTop?"down":"up",prevDirection!==direction&&("down"===direction?($header.classList.remove("is-fixed"),st>100&&($header.style.top="-60px")):($header.classList.add("is-fixed"),$header.style.top="0")),lastScrollTop=st,prevDirection=direction})},{"../helper/selector.coffee":41}],62:[function(require,module,exports){var $,$$,ref,request;request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,module.exports={article:function(){var $love,i,len,ref1,results;for(ref1=$$(".js-article-love"),results=[],i=0,len=ref1.length;len>i;i++)$love=ref1[i],results.push($love.onclick=function(e){var articleId,loveCount,self;return articleId=this.getAttribute("data-article-id"),loveCount=1*this.firstChild.innerHTML,self=this,request.post("/l").send({to:articleId,love_type:"Post",_csrf:CSRF}).set("Accept","application/json").end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.err===!1?resData.loving===!0?(self.classList.add("is-loving"),self.firstChild.innerHTML=loveCount+1):(self.classList.remove("is-loving"),self.firstChild.innerHTML=loveCount-1):void 0})});return results},comment:function(){var $love,i,len,ref1,results;for(ref1=$$(".js-comment-love"),results=[],i=0,len=ref1.length;len>i;i++)$love=ref1[i],results.push($love.onclick=function(e){var commentId,loveCount,self;return commentId=this.getAttribute("data-comment-id"),loveCount=1*this.firstChild.innerHTML,self=this,console.log("o"),request.post("/l").send({to:commentId,love_type:"Comment",_csrf:CSRF}).set("Accept","application/json").end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.err===!1?resData.loving===!0?(self.classList.add("is-loving"),self.firstChild.innerHTML=loveCount+1):(self.classList.remove("is-loving"),self.firstChild.innerHTML=loveCount-1):void 0})});return results}}},{"../helper/selector.coffee":41,superagent:116}],63:[function(require,module,exports){var $,$$allHeading,$closeToc,$header,$heading,$jsArticle,$toc,articleId,i,j,len,nodeName,slug,text;if($=require("../helper/selector.coffee").$,$jsArticle=$(".js-article, .js-draft"),$closeToc=$(".js-close-toc"),$toc=$(".js-toc"),$header=$(".b-header"),$jsArticle&&(articleId=$jsArticle.getAttribute("data-article-id")))for(window.addEventListener("scroll",function(e){var isHeaderFixed;return isHeaderFixed=$header.classList.contains("is-fixed"),isHeaderFixed?$toc.classList.add("is-with-header"):$toc.classList.remove("is-with-header")}),$$allHeading=$jsArticle.childNodes,i=0,j=0,len=$$allHeading.length;len>j;j++)$heading=$$allHeading[j],nodeName=$heading.nodeName,"H2"!==nodeName&&"H3"!==nodeName||(i++,text=$heading.textContent,slug=text.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")+("--"+i),$heading.setAttribute("id",slug),"H3"===nodeName?$toc.innerHTML+="<div>\n  <a href='#"+slug+"'>"+text+"</a>\n</div>":$toc.innerHTML+="<b><div>\n  <a href='#"+slug+"'>"+text+"</a>\n</div></b>")},{"../helper/selector.coffee":41}],64:[function(require,module,exports){var $,$$,$loadMoreMenotifFeed,$menotifFeed,$menotifSpinner,$notifFeed,$notifSpinner,__,__n,assetUrl,feedTemplate,i,imgUrl,j,loadFeed,loadFeed2,ref,ref1,ref2,ref3,ref4,request,url;request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,ref1=require("../helper/langCatalog.coffee"),__=ref1.__,__n=ref1.__n,feedTemplate=require("../../../../code/framesia/views/blocks/notif.jade"),ref2=require("../../../../code/framesia/configClient.coffee"),imgUrl=ref2.imgUrl,assetUrl=ref2.assetUrl,$notifFeed=$(".js-notif-feed"),$notifSpinner=$(".js-notif-spinner"),$menotifFeed=$(".js-menotif-feed"),$menotifSpinner=$(".js-menotif-spinner"),url="/me/feed-notif",loadFeed=function(first){return request.get(url).end(function(err,res){var data,feedHtml,local,ref3,ref4,ref5;return data=JSON.parse(res.text),local={notifs:data.notifs,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=feedTemplate(local),""===feedHtml&&(feedHtml="<div class='i-block-empty'> "+__("No notif")+"</div>"),$notifFeed.classList.remove("is-empty"),$notifSpinner.classList.add("is-hidden"),$notifFeed.innerHTML=feedHtml,(null!=(ref3=data.notifs[0])?ref3.is_read:void 0)===!1?null!=(ref4=$(".js-down-notif"))?ref4.classList.add("is-notif"):void 0:null!=(ref5=$(".js-down-notif"))?ref5.classList.remove("is-notif"):void 0})},$notifFeed&&(i=0,j=0,loadFeed(),null!=(ref3=$(".js-down-notif"))&&ref3.addEventListener("click",function(e){return this.classList.contains("is-notif")&&(i=0,j=0),0===i?(loadFeed(),i++):void 0}),null!=(ref4=$(".js-drop-notif"))&&ref4.addEventListener("mouseover",function(e){var $$allItem,$firstItem,isRead,notifId;return 0!==j||(j++,$firstItem=this.querySelector(".b-notif__item"),$$allItem=this.querySelectorAll(".b-notif__item"),notifId=$firstItem.getAttribute("data-notif-id"),isRead=$firstItem.classList.contains("is-read"))?void 0:request.post("/me/read-notif").send({_csrf:CSRF}).end(function(err,res){var $item,k,len,results;for(j=0,$(".js-down-notif").classList.remove("is-notif"),results=[],k=0,len=$$allItem.length;len>k;k++)$item=$$allItem[k],results.push($item.classList.add("is-read"));return results})})),$loadMoreMenotifFeed=$(".js-load-more-menotif-feed"),loadFeed2=function(){var firstReq,last;return $loadMoreMenotifFeed.classList.add("is-hidden"),$menotifFeed.classList.contains("is-empty")?(url=url,firstReq=!0):(last=$menotifFeed.lastChild.getAttribute("data-notif-id"),url="/me/feed-notif?last="+last),$menotifSpinner.classList.remove("is-hidden"),request.get(url).end(function(err,res){var data,feedHtml,local;return data=JSON.parse(res.text),local={notifs:data.notifs,__:__,__n:__n,ASSET_URL:assetUrl,IMG_URL:imgUrl},feedHtml=feedTemplate(local),$loadMoreMenotifFeed.classList.remove("is-hidden"),""===feedHtml&&(firstReq===!0&&(feedHtml="<div class='i-block-empty'> "+__("No articles")+"</div>"),$loadMoreMenotifFeed.classList.add("is-hidden")),$menotifFeed.classList.remove("is-empty"),$menotifSpinner.classList.add("is-hidden"),$menotifFeed.innerHTML+=feedHtml})},$menotifFeed&&(loadFeed2(),$loadMoreMenotifFeed.onclick=function(e){return loadFeed2()})},{"../../../../code/framesia/configClient.coffee":128,"../../../../code/framesia/views/blocks/notif.jade":132,"../helper/langCatalog.coffee":40,"../helper/selector.coffee":41,superagent:116}],65:[function(require,module,exports){var $,$formReportArticle,$inputReportArticle,$reportArticle,request,swal;request=require("superagent"),$=require("../helper/selector.coffee").$,swal=require("sweetalert"),$reportArticle=$(".js-report-article"),$formReportArticle=$(".js-form-report-article"),$inputReportArticle=$(".js-input-report-article"),$reportArticle&&($reportArticle.onclick=function(e){return swal({title:"Why?",type:"input",inputPlaceholder:"Why you report this article? 10 - 200 char",showCancelButton:!0,showConfirmButton:!0},function(inputValue){return inputValue===!1?!1:inputValue.length>200?(swal.showInputError("Too long"),!1):inputValue.length<5?(swal.showInputError("Too short"),!1):($inputReportArticle.value=inputValue,$formReportArticle.submit(),!0)})})},{"../helper/selector.coffee":41,superagent:116,sweetalert:127}],66:[function(require,module,exports){var $,$$,ref,request;request=require("superagent"),ref=require("../helper/selector.coffee"),$=ref.$,$$=ref.$$,module.exports=function(){var $repost,i,len,ref1,results;for(ref1=$$(".js-article-repost"),results=[],i=0,len=ref1.length;len>i;i++)$repost=ref1[i],results.push($repost.onclick=function(e){var articleId,repostCount,self;return articleId=this.getAttribute("data-article-id"),repostCount=1*this.firstChild.innerHTML,self=this,request.post("/p/repost-article").send({article_id:articleId,_csrf:CSRF}).set("Accept","application/json").end(function(err,res){var resData;return resData=JSON.parse(res.text),resData.err===!1?resData.repost===!0?(self.classList.add("is-repost"),self.firstChild.innerHTML=repostCount+1):(self.classList.remove("is-repost"),self.firstChild.innerHTML=repostCount-1):void 0})});return results}},{"../helper/selector.coffee":41,superagent:116}],67:[function(require,module,exports){var $,jsondiffpatch,ref,ref1,request,saveArticle,swal,tag;$=require("../helper/selector.coffee").$,request=require("superagent"),swal=require("sweetalert"),jsondiffpatch=require("jsondiffpatch"),tag=require("./tag.coffee"),null!=(ref=$(".js-save-server"))&&(ref.onclick=function(e){return saveArticle(!1)}),null!=(ref1=$(".js-save-publish"))&&(ref1.onclick=function(e){return saveArticle(!0);
}),saveArticle=function(isPublished){var articleData,articleInit,delta,diffpatcher,postData,type;return $(".js-save").click(),type="new",articleInit=JSON.parse(localStorage.getItem("article-init")),0===articleInit.data.length?(articleData=localStorage.getItem("article"),postData={_csrf:CSRF,tags:JSON.stringify(tag.tags()),data:articleData,is_published:isPublished,is_response:!1},$(".js-respond")&&(postData.is_response=!0,postData.response=$(".js-respond").getAttribute("data-article-id"))):(type="edit",articleData=JSON.parse(localStorage.getItem("article")),diffpatcher=jsondiffpatch.create({objectHash:function(obj){return obj.type},textDiff:{minLength:6e7}}),delta={data:diffpatcher.diff(articleInit.data,articleData.data),img:articleData.img},postData={_csrf:CSRF,tags:JSON.stringify(tag.tags()),data:JSON.stringify(delta),id:window.location.pathname.split("/")[2],is_published:isPublished,title:articleData.title,isTitleCenter:articleData.isTitleCenter,isCoverChanged:articleData.isCoverChanged},articleData.isCoverChanged&&(postData.isCover=articleData.isCover,postData.cover=articleData.cover)),swal({title:"Save?",text:"Send this article? total "+(postData.data.length/1024).toFixed(2)+" KB\n<div class='percent'>\n  <div class='percent-loader' width='0'>\n  </div>\n  <div class='percent-text'>\n  </div>\n</div>",closeOnConfirm:!1,showCancelButton:!0,showConfirmButton:!0,showLoaderOnConfirm:!0},function(confirm){var url;if(confirm){if("new"===type)url="/p/new-article";else{if("edit"!==type)return!1;url="/p/edit-article"}return""===postData.title?swal("Error","Untitled","error"):$(".js-title-input").value.length<3?swal("Error","Title too short!","error"):$(".js-editable").textContent.length<20?swal("Error","Article too short!","error"):request.post(url).send(postData).set("Accept","application/json").on("progress",function(e){var a,percent;return e.percent?(percent=0,a=0,100===e.percent&&0===a?percent=0:(percent=Math.floor(e.percent),a=1),$(".percent-text").innerHTML=percent+"%",$(".percent-loader").width=percent+"%"):void 0}).end(function(err,res){var resData;return resData=JSON.parse(res.text),swal({title:"Success",text:'<a class="text-green" href=\''+resData.urlBack+"/edit'>Continue editing</a> or go to <a class=\"text-green\" href='"+resData.urlBack+"'>your article</a> or go to <a  class=\"text-green\" href='/'>Home</a>",type:"success",allowOutsideClick:!1})})}return swal.close()})}},{"../helper/selector.coffee":41,"./tag.coffee":68,jsondiffpatch:113,superagent:116,sweetalert:127}],68:[function(require,module,exports){var $,$collectionTag,$tags,autoCompleteOptions,dataTags,horsey,insignia,maxTags,request,tagOptions,tagging;$=require("../helper/selector.coffee").$,maxTags=3,insignia=require("insignia"),horsey=require("horsey"),request=require("superagent"),$tags=$(".tags-wrap"),$tags&&(dataTags=$tags.getAttribute("data-tags"),dataTags&&($tags.value=JSON.parse(dataTags).join(",")),tagOptions={delimiter:",",parse:function(value){return value},validate:function(value,tags){var i,isDuplicate,len,tag;if(tags.length<maxTags){for(isDuplicate=!1,i=0,len=tags.length;len>i;i++)tag=tags[i],tag.toLowerCase()===value.toLowerCase()&&(isDuplicate=!0);if(!isDuplicate)return!0}}},tagging=insignia($tags,tagOptions),$tags.addEventListener("keypress",function(e){return 13===e.keyCode?(e.preventDefault(),tagging.convert()):void 0}),autoCompleteOptions={suggestions:function(value,done){return value?request.get("/s/topics?q="+value).end(function(end,res){var i,j,len,len1,tag,tag2,tagLower,tags,tags2,unique;for(tags=JSON.parse(res.text),tags2=[],unique=!0,i=0,len=tags.length;len>i;i++){for(tag=tags[i],tagLower=tag._id.toLowerCase(),j=0,len1=tags2.length;len1>j;j++)tag2=tags2[j],tag2===tagLower&&(unique=!1);unique===!0&&tags2.push(tagLower)}return done(tags2)}):void 0}},horsey($tags,autoCompleteOptions),$tags.addEventListener("horsey-selected",function(e){return tagging.convert()}),$collectionTag=$(".js-collection-tag"),$collectionTag&&$tags.addEventListener("insignia-converted",function(e){return $collectionTag.value=tagging.value()})),module.exports=tagging},{"../helper/selector.coffee":41,horsey:72,insignia:91,superagent:116}],69:[function(require,module,exports){var documentReady;(documentReady=function(){var $,$$,$$imgCoverFull,$$imgCoverSlide,$container,$figcaption,$figure,$imgCoverFull,$imgCoverSlide,article,csrf,i,imgUrl,j,k,l,len,len1,len2,len3,love,ref,ref1,ref2,repost,scroll,swal;for(swal=require("sweetalert"),ref=require("./helper/selector.coffee"),$=ref.$,$$=ref.$$,swal.setDefaults({title:"Framesia",text:"Framesia",html:!0,showCancelButton:!1,showConfirmButton:!1,animation:"slide-from-top",allowOutsideClick:!0,closeOnConfirm:!0}),love=require("./include/love.coffee"),repost=require("./include/repost.coffee"),article=require("./include/article.coffee"),csrf=require("./include/csrf.coffee"),repost(),love.article(),love.comment(),article["delete"](),article.publish(),csrf(),require("./include/headerFix.coffee"),require("./include/drop.coffee"),require("./include/firstTime.coffee"),require("./include/tag.coffee"),require("./include/feedRight.coffee"),require("./include/notif.coffee"),require("./include/comment.coffee"),require("./include/follow.coffee"),require("./include/checkRead.coffee"),require("./include/checkUsername.coffee"),require("./include/saveArticle.coffee"),require("./include/getArticle.coffee"),require("./include/autocompleteUser.coffee"),require("./include/collection.coffee"),require("./include/collectionPeople.coffee"),require("./include/collectionArticle.coffee"),require("./include/addCollection.coffee"),require("./include/getComment.coffee"),require("./include/getLovedArticles.coffee"),require("./include/getArticles2.coffee"),require("./include/getArticles.coffee"),require("./include/report.coffee"),require("./include/makeTableOfContent.coffee"),$$imgCoverFull=$$(".is-cover-full img"),i=0,len=$$imgCoverFull.length;len>i;i++)$imgCoverFull=$$imgCoverFull[i],$container=$imgCoverFull.parentNode,imgUrl=$imgCoverFull.getAttribute("src"),$imgCoverFull.classList.add("is-hidden"),$container.style.backgroundImage="url('"+imgUrl+"')",$container.style.backgroundSize="cover";for($$imgCoverSlide=$$(".is-cover-slide img"),j=0,len1=$$imgCoverSlide.length;len1>j;j++)$imgCoverSlide=$$imgCoverSlide[j],$container=$imgCoverSlide.parentNode,imgUrl=$imgCoverSlide.getAttribute("src"),$imgCoverSlide.classList.add("is-hidden"),$container.style.backgroundImage="url('"+imgUrl+"')",$container.style.backgroundSize="cover";if($(".b-article__cover.is-cover-not-full")&&($(".b-article__cover.is-cover-not-full").parentNode.style.background="#fff"),$(".js-editable")){for(ref1=$$("figure"),k=0,len2=ref1.length;len2>k;k++)$figure=ref1[k],$figure.editable=!1;for(ref2=$$("figcaption"),l=0,len3=ref2.length;len3>l;l++)$figcaption=ref2[l],$figcaption.editable=!0;require("./editor/main.coffee")}return window.location.hash&&"#_=_"===window.location.hash?window.history&&window.history.replaceState?window.history.replaceState("",document.title,window.location.pathname):(scroll={top:document.body.scrollTop,left:document.body.scrollLeft},window.location.hash="",document.body.scrollTop=scroll.top,document.body.scrollLeft=scroll.left):void 0})()},{"./editor/main.coffee":20,"./helper/selector.coffee":41,"./include/addCollection.coffee":42,"./include/article.coffee":43,"./include/autocompleteUser.coffee":44,"./include/checkRead.coffee":45,"./include/checkUsername.coffee":46,"./include/collection.coffee":47,"./include/collectionArticle.coffee":48,"./include/collectionPeople.coffee":49,"./include/comment.coffee":50,"./include/csrf.coffee":51,"./include/drop.coffee":52,"./include/feedRight.coffee":53,"./include/firstTime.coffee":54,"./include/follow.coffee":55,"./include/getArticle.coffee":56,"./include/getArticles.coffee":57,"./include/getArticles2.coffee":58,"./include/getComment.coffee":59,"./include/getLovedArticles.coffee":60,"./include/headerFix.coffee":61,"./include/love.coffee":62,"./include/makeTableOfContent.coffee":63,"./include/notif.coffee":64,"./include/report.coffee":65,"./include/repost.coffee":66,"./include/saveArticle.coffee":67,"./include/tag.coffee":68,sweetalert:127}],70:[function(require,module,exports){arguments[4][21][0].apply(exports,arguments)},{"./load-image":71,dup:21}],71:[function(require,module,exports){arguments[4][22][0].apply(exports,arguments)},{dup:22}],72:[function(require,module,exports){"use strict";function find(el){var entry,i;for(i=0;i<cache.length;i++)if(entry=cache[i],entry.el===el)return entry.api;return null}function horsey(el,options){function retarget(el){inputEvents(!0),attachment=api.attachment=el,textInput="INPUT"===attachment.tagName||"TEXTAREA"===attachment.tagName,anyInput=textInput||isEditable(attachment),inputEvents()}function refreshPosition(){eye&&eye.refresh()}function loading(forceShow){if("function"==typeof suggestions){crossvent.remove(attachment,"focus",loading);var value=textInput?el.value:el.innerHTML;if(value!==suggestionsLoad.value){suggestionsLoad.counter++,suggestionsLoad.value=value;var counter=suggestionsLoad.counter;suggestions(value,function(s){suggestionsLoad.counter===counter&&loaded(s,forceShow)})}}}function loaded(suggestions,forceShow){clear(),suggestions.forEach(add),api.suggestions=suggestions,forceShow&&show(),filtering()}function clear(){for(unselect();ul.lastChild;)ul.removeChild(ul.lastChild)}function add(suggestion){function clickedSuggestion(){var value=getValue(suggestion);set(value),hide(),attachment.focus(),crossvent.fabricate(attachment,"horsey-selected",value)}function filterItem(){var value=textInput?el.value:el.innerHTML;filter(value,suggestion)?li.className=li.className.replace(/ sey-hide/g,""):crossvent.fabricate(li,"horsey-hide")}function hideItem(){hidden(li)||(li.className+=" sey-hide",selection===li&&unselect())}var li=tag("li","sey-item");return render(li,suggestion),crossvent.add(li,"click",clickedSuggestion),crossvent.add(li,"horsey-filter",filterItem),crossvent.add(li,"horsey-hide",hideItem),ul.appendChild(li),api.suggestions.push(suggestion),li}function set(value){return o.anchor?(isText()?api.appendText:api.appendHTML)(value):void userSet(value)}function filter(value,suggestion){if(o.anchor){var il=(isText()?api.filterAnchoredText:api.filterAnchoredHTML)(value,suggestion);return il?userFilter(il.input,il.suggestion):!1}return userFilter(value,suggestion)}function isText(){return isInput(attachment)}function visible(){return-1!==ul.className.indexOf("sey-show")}function hidden(li){return-1!==li.className.indexOf("sey-hide")}function show(){visible()||(ul.className+=" sey-show",eye.refresh(),crossvent.fabricate(attachment,"horsey-show"))}function toggler(e){var left=1===e.which&&!e.metaKey&&!e.ctrlKey;left!==!1&&toggle()}function toggle(){visible()?hide():show()}function select(suggestion){unselect(),suggestion&&(selection=suggestion,selection.className+=" sey-selected")}function unselect(){selection&&(selection.className=selection.className.replace(/ sey-selected/g,""),selection=null)}function move(up,moves){var total=ul.children.length;if(moves>total)return void unselect();if(0!==total){var first=up?"lastChild":"firstChild",next=up?"previousSibling":"nextSibling",suggestion=selection&&selection[next]||ul[first];select(suggestion),hidden(suggestion)&&move(up,moves?moves+1:1)}}function hide(){eye.sleep(),ul.className=ul.className.replace(/ sey-show/g,""),unselect(),crossvent.fabricate(attachment,"horsey-hide")}function keydown(e){var shown=visible(),which=e.which||e.keyCode;which===KEY_DOWN?(anyInput&&o.autoShowOnUpDown&&show(),shown&&(move(),stop(e))):which===KEY_UP?(anyInput&&o.autoShowOnUpDown&&show(),shown&&(move(!0),stop(e))):which===KEY_BACKSPACE?anyInput&&o.autoShowOnUpDown&&show():shown&&(which===KEY_ENTER?(selection?crossvent.fabricate(selection,"click"):hide(),stop(e)):which===KEY_ESC&&(hide(),stop(e)))}function stop(e){e.stopPropagation(),e.preventDefault()}function filtering(){if(visible()){loading(!0),crossvent.fabricate(attachment,"horsey-filter");for(var li=ul.firstChild,count=0;li;)count>=limit&&crossvent.fabricate(li,"horsey-hide"),limit>count&&(crossvent.fabricate(li,"horsey-filter"),-1===li.className.indexOf("sey-hide")&&count++),li=li.nextSibling;selection||move(),selection||hide()}}function deferredFilteringNoEnter(e){var which=e.which||e.keyCode;which!==KEY_ENTER&&deferredFiltering()}function deferredShow(e){var which=e.which||e.keyCode;which!==KEY_ENTER&&setTimeout(show,0)}function horseyEventTarget(e){var target=e.target;if(target===attachment)return!0;for(;target;){if(target===ul||target===attachment)return!0;target=target.parentNode}}function hideOnBlur(e){var which=e.which||e.keyCode;which===KEY_TAB&&hide()}function hideOnClick(e){horseyEventTarget(e)||hide()}function inputEvents(remove){var op=remove?"remove":"add";eye&&(eye.destroy(),eye=null),remove||(eye=bullseye(ul,attachment,{caret:anyInput&&"INPUT"!==attachment.tagName}),visible()||eye.sleep()),remove||anyInput&&doc.activeElement!==attachment?crossvent[op](attachment,"focus",loading):loading(),anyInput?(crossvent[op](attachment,"keypress",deferredShow),crossvent[op](attachment,"keypress",deferredFiltering),crossvent[op](attachment,"keydown",deferredFilteringNoEnter),crossvent[op](attachment,"paste",deferredFiltering),crossvent[op](attachment,"keydown",keydown),o.autoHideOnBlur&&crossvent[op](attachment,"keydown",hideOnBlur)):(crossvent[op](attachment,"click",toggler),crossvent[op](docElement,"keydown",keydown)),o.autoHideOnClick&&crossvent[op](doc,"click",hideOnClick),form&&crossvent[op](form,"submit",hide)}function destroy(){inputEvents(!0),parent.contains(ul)&&parent.removeChild(ul),cache.splice(cache.indexOf(entry),1)}function defaultSetter(value){textInput?el.value=value:el.innerHTML=value}function defaultRenderer(li,suggestion){li.innerText=li.textContent=getText(suggestion)}function defaultFilter(q,suggestion){var text=getText(suggestion)||"",value=getValue(suggestion)||"",needle=q.toLowerCase();return fuzzysearch(needle,text.toLowerCase())||fuzzysearch(needle,value.toLowerCase())}function loopbackToAnchor(text,p){for(var result="",anchored=!1,start=p.start;anchored===!1&&start>=0;)result=text.substr(start-1,p.start-start+1),anchored=ranchorleft.test(result),start--;return{text:anchored?result:null,start:start}}function filterAnchoredText(q,suggestion){var position=sell(el),input=loopbackToAnchor(q,position).text;return input?{input:input,suggestion:suggestion}:void 0}function appendText(value){var current=el.value,position=sell(el),input=loopbackToAnchor(current,position),left=current.substr(0,input.start),right=current.substr(input.start+input.text.length+(position.end-position.start)),before=left+value+" ";el.value=before+right,sell(el,{start:before.length,end:before.length})}function filterAnchoredHTML(){throw new Error("Anchoring in editable elements is disabled by default.")}function appendHTML(){throw new Error("Anchoring in editable elements is disabled by default.")}var cached=find(el);if(cached)return cached;var eye,textInput,anyInput,ranchorleft,ranchorright,o=options||{},parent=o.appendTo||doc.body,render=o.render||defaultRenderer,getText=o.getText||defaultGetText,getValue=o.getValue||defaultGetValue,form=o.form,limit="number"==typeof o.limit?o.limit:1/0,suggestions=o.suggestions,userFilter=o.filter||defaultFilter,userSet=o.set||defaultSetter,ul=tag("ul","sey-list"),selection=null,deferredFiltering=defer(filtering),attachment=el,suggestionsLoad={counter:0,value:null};void 0===o.autoHideOnBlur&&(o.autoHideOnBlur=!0),void 0===o.autoHideOnClick&&(o.autoHideOnClick=!0),void 0===o.autoShowOnUpDown&&(o.autoShowOnUpDown="INPUT"===el.tagName),o.anchor&&(ranchorleft=new RegExp("^"+o.anchor),ranchorright=new RegExp(o.anchor+"$"));var api={add:add,anchor:o.anchor,clear:clear,show:show,hide:hide,toggle:toggle,destroy:destroy,refreshPosition:refreshPosition,appendText:appendText,appendHTML:appendHTML,filterAnchoredText:filterAnchoredText,filterAnchoredHTML:filterAnchoredHTML,defaultAppendText:appendText,defaultFilter:defaultFilter,defaultGetText:defaultGetText,defaultGetValue:defaultGetValue,defaultRenderer:defaultRenderer,defaultSetter:defaultSetter,retarget:retarget,attachment:attachment,list:ul,suggestions:[]},entry={el:el,api:api};return retarget(el),cache.push(entry),parent.appendChild(ul),el.setAttribute("autocomplete","off"),Array.isArray(suggestions)&&loaded(suggestions,!1),api}function isInput(el){return"INPUT"===el.tagName||"TEXTAREA"===el.tagName}function defaultGetValue(suggestion){return defaultGet("value",suggestion)}function defaultGetText(suggestion){return defaultGet("text",suggestion)}function defaultGet(type,value){return value&&void 0!==value[type]?value[type]:value}function tag(type,className){var el=doc.createElement(type);return el.className=className,el}function defer(fn){return function(){setTimeout(fn,0)}}function isEditable(el){var value=el.getAttribute("contentEditable");return"false"===value?!1:"true"===value?!0:el.parentElement?isEditable(el.parentElement):!1}var sell=require("sell"),crossvent=require("crossvent"),bullseye=require("bullseye"),fuzzysearch=require("fuzzysearch"),KEY_BACKSPACE=8,KEY_ENTER=13,KEY_ESC=27,KEY_UP=38,KEY_DOWN=40,KEY_TAB=9,cache=[],doc=document,docElement=doc.documentElement;horsey.find=find,module.exports=horsey},{bullseye:73,crossvent:85,fuzzysearch:87,sell:88}],73:[function(require,module,exports){"use strict";function bullseye(el,target,options){function sleep(){tailorOptions.sleeping=!0}function readNull(){return read()}function read(readings){var bounds=target.getBoundingClientRect(),scrollTop=document.body.scrollTop||document.documentElement.scrollTop;return tailor?(readings=tailor.read(),{x:(readings.absolute?0:bounds.left)+readings.x,y:(readings.absolute?0:bounds.top)+scrollTop+readings.y+20}):{x:bounds.left,y:bounds.top+scrollTop}}function update(readings){write(readings)}function write(readings){if(destroyed)throw new Error("Bullseye can't refresh after being destroyed. Create another instance instead.");if(tailor&&!readings)return tailorOptions.sleeping=!1,void tailor.refresh();var p=read(readings);tailor||target===el||(p.y+=target.offsetHeight),el.style.left=p.x+"px",el.style.top=p.y+"px"}function destroy(){tailor&&tailor.destroy(),crossvent.remove(window,"resize",throttledWrite),destroyed=!0}var o=options,domTarget=target&&target.tagName;domTarget||2!==arguments.length||(o=target),domTarget||(target=el),o||(o={});var destroyed=!1,throttledWrite=throttle(write,30),tailorOptions={update:o.autoupdateToCaret!==!1&&update},tailor=o.caret&&tailormade(target,tailorOptions);return write(),o.tracking!==!1&&crossvent.add(window,"resize",throttledWrite),{read:readNull,refresh:write,destroy:destroy,sleep:sleep}}var crossvent=require("crossvent"),throttle=require("./throttle"),tailormade=require("./tailormade");module.exports=bullseye},{"./tailormade":82,"./throttle":83,crossvent:85}],74:[function(require,module,exports){(function(global){"use strict";var getSelection,doc=global.document,getSelectionRaw=require("./getSelectionRaw"),getSelectionNullOp=require("./getSelectionNullOp"),getSelectionSynthetic=require("./getSelectionSynthetic"),isHost=require("./isHost");getSelection=isHost.method(global,"getSelection")?getSelectionRaw:"object"==typeof doc.selection&&doc.selection?getSelectionSynthetic:getSelectionNullOp,module.exports=getSelection}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./getSelectionNullOp":75,"./getSelectionRaw":76,"./getSelectionSynthetic":77,"./isHost":78}],75:[function(require,module,exports){"use strict";function noop(){}function getSelectionNullOp(){return{removeAllRanges:noop,addRange:noop}}module.exports=getSelectionNullOp},{}],76:[function(require,module,exports){(function(global){"use strict";function getSelectionRaw(){return global.getSelection()}module.exports=getSelectionRaw}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],77:[function(require,module,exports){(function(global){"use strict";function GetSelection(selection){var self=this,range=selection.createRange();this._selection=selection,this._ranges=[],"Control"===selection.type?updateControlSelection(self):isTextRange(range)?updateFromTextRange(self,range):updateEmptySelection(self)}function createControlSelection(sel,ranges){for(var el,controlRange=body.createControlRange(),i=0,len=ranges.length;len>i;++i){el=getSingleElementFromRange(ranges[i]);try{controlRange.add(el)}catch(e){throw new Error("setRanges(): Element could not be added to control selection")}}controlRange.select(),updateControlSelection(sel)}function removeRangeManually(sel,range){var ranges=sel.getAllRanges();sel.removeAllRanges();for(var i=0,len=ranges.length;len>i;++i)isSameRange(range,ranges[i])||sel.addRange(ranges[i]);sel.rangeCount||updateEmptySelection(sel)}function updateAnchorAndFocusFromRange(sel,range){var anchorPrefix="start",focusPrefix="end";sel.anchorNode=range[anchorPrefix+"Container"],sel.anchorOffset=range[anchorPrefix+"Offset"],sel.focusNode=range[focusPrefix+"Container"],sel.focusOffset=range[focusPrefix+"Offset"]}function updateEmptySelection(sel){sel.anchorNode=sel.focusNode=null,sel.anchorOffset=sel.focusOffset=0,sel.rangeCount=0,sel.isCollapsed=!0,sel._ranges.length=0}function rangeContainsSingleElement(rangeNodes){if(!rangeNodes.length||1!==rangeNodes[0].nodeType)return!1;for(var i=1,len=rangeNodes.length;len>i;++i)if(!isAncestorOf(rangeNodes[0],rangeNodes[i]))return!1;return!0}function getSingleElementFromRange(range){var nodes=range.getNodes();if(!rangeContainsSingleElement(nodes))throw new Error("getSingleElementFromRange(): range did not consist of a single element");return nodes[0]}function isTextRange(range){return range&&void 0!==range.text}function updateFromTextRange(sel,range){sel._ranges=[range],updateAnchorAndFocusFromRange(sel,range,!1),sel.rangeCount=1,sel.isCollapsed=range.collapsed}function updateControlSelection(sel){if(sel._ranges.length=0,"None"===sel._selection.type)updateEmptySelection(sel);else{var controlRange=sel._selection.createRange();if(isTextRange(controlRange))updateFromTextRange(sel,controlRange);else{sel.rangeCount=controlRange.length;for(var range,i=0;i<sel.rangeCount;++i)range=doc.createRange(),range.selectNode(controlRange.item(i)),sel._ranges.push(range);sel.isCollapsed=1===sel.rangeCount&&sel._ranges[0].collapsed,updateAnchorAndFocusFromRange(sel,sel._ranges[sel.rangeCount-1],!1)}}}function addRangeToControlSelection(sel,range){for(var controlRange=sel._selection.createRange(),rangeElement=getSingleElementFromRange(range),newControlRange=body.createControlRange(),i=0,len=controlRange.length;len>i;++i)newControlRange.add(controlRange.item(i));try{newControlRange.add(rangeElement)}catch(e){throw new Error("addRange(): Element could not be added to control selection")}newControlRange.select(),updateControlSelection(sel)}function isSameRange(left,right){return left.startContainer===right.startContainer&&left.startOffset===right.startOffset&&left.endContainer===right.endContainer&&left.endOffset===right.endOffset}function isAncestorOf(ancestor,descendant){for(var node=descendant;node.parentNode;){if(node.parentNode===ancestor)return!0;node=node.parentNode}return!1}function getSelection(){return new GetSelection(global.document.selection)}var rangeToTextRange=require("./rangeToTextRange"),doc=global.document,body=doc.body,GetSelectionProto=GetSelection.prototype;GetSelectionProto.removeAllRanges=function(){var textRange;try{this._selection.empty(),"None"!==this._selection.type&&(textRange=body.createTextRange(),textRange.select(),this._selection.empty())}catch(e){}updateEmptySelection(this)},GetSelectionProto.addRange=function(range){"Control"===this._selection.type?addRangeToControlSelection(this,range):(rangeToTextRange(range).select(),this._ranges[0]=range,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,updateAnchorAndFocusFromRange(this,range,!1))},GetSelectionProto.setRanges=function(ranges){this.removeAllRanges();var rangeCount=ranges.length;rangeCount>1?createControlSelection(this,ranges):rangeCount&&this.addRange(ranges[0])},GetSelectionProto.getRangeAt=function(index){if(0>index||index>=this.rangeCount)throw new Error("getRangeAt(): index out of bounds");return this._ranges[index].cloneRange()},GetSelectionProto.removeRange=function(range){if("Control"!==this._selection.type)return void removeRangeManually(this,range);for(var el,controlRange=this._selection.createRange(),rangeElement=getSingleElementFromRange(range),newControlRange=body.createControlRange(),removed=!1,i=0,len=controlRange.length;len>i;++i)el=controlRange.item(i),el!==rangeElement||removed?newControlRange.add(controlRange.item(i)):removed=!0;newControlRange.select(),updateControlSelection(this)},GetSelectionProto.eachRange=function(fn,returnValue){var i=0,len=this._ranges.length;for(i=0;len>i;++i)if(fn(this.getRangeAt(i)))return returnValue},GetSelectionProto.getAllRanges=function(){var ranges=[];return this.eachRange(function(range){ranges.push(range)}),ranges},GetSelectionProto.setSingleRange=function(range){this.removeAllRanges(),this.addRange(range)},module.exports=getSelection}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./rangeToTextRange":79}],78:[function(require,module,exports){"use strict";function isHostMethod(host,prop){var type=typeof host[prop];return"function"===type||!("object"!==type||!host[prop])||"unknown"===type}function isHostProperty(host,prop){return"undefined"!=typeof host[prop]}function many(fn){return function(host,props){for(var i=props.length;i--;)if(!fn(host,props[i]))return!1;return!0}}module.exports={method:isHostMethod,methods:many(isHostMethod),property:isHostProperty,properties:many(isHostProperty)}},{}],79:[function(require,module,exports){(function(global){"use strict";function rangeToTextRange(p){if(p.collapsed)return createBoundaryTextRange({node:p.startContainer,offset:p.startOffset},!0);var startRange=createBoundaryTextRange({node:p.startContainer,offset:p.startOffset},!0),endRange=createBoundaryTextRange({node:p.endContainer,offset:p.endOffset},!1),textRange=body.createTextRange();return textRange.setEndPoint("StartToStart",startRange),textRange.setEndPoint("EndToEnd",endRange),textRange}function isCharacterDataNode(node){var t=node.nodeType;return 3===t||4===t||8===t}function createBoundaryTextRange(p,starting){var bound,parent,workingNode,childNodes,offset=p.offset,range=body.createTextRange(),data=isCharacterDataNode(p.node);return data?(bound=p.node,parent=bound.parentNode):(childNodes=p.node.childNodes,bound=offset<childNodes.length?childNodes[offset]:null,parent=p.node),workingNode=doc.createElement("span"),workingNode.innerHTML="&#feff;",bound?parent.insertBefore(workingNode,bound):parent.appendChild(workingNode),range.moveToElementText(workingNode),range.collapse(!starting),parent.removeChild(workingNode),data&&range[starting?"moveStart":"moveEnd"]("character",offset),range}var doc=global.document,body=doc.body;module.exports=rangeToTextRange}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],80:[function(require,module,exports){"use strict";var getSelection=require("./getSelection"),setSelection=require("./setSelection");module.exports={get:getSelection,set:setSelection}},{"./getSelection":74,"./setSelection":81}],81:[function(require,module,exports){(function(global){"use strict";function setSelection(p){function modernSelection(){var sel=getSelection(),range=doc.createRange();p.startContainer&&(p.endContainer?range.setEnd(p.endContainer,p.endOffset):range.setEnd(p.startContainer,p.startOffset),range.setStart(p.startContainer,p.startOffset),sel.removeAllRanges(),sel.addRange(range))}function oldSelection(){rangeToTextRange(p).select()}doc.createRange?modernSelection():oldSelection()}var getSelection=require("./getSelection"),rangeToTextRange=require("./rangeToTextRange"),doc=global.document;module.exports=setSelection}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./getSelection":74,"./rangeToTextRange":79}],82:[function(require,module,exports){(function(global){"use strict";function tailormade(el,options){function noop(){}function readPosition(){return(textInput?coordsText:coordsHTML)()}function refresh(){return o.sleeping?void 0:(o.update||noop)(readPosition())}function coordsText(){var p=sell(el),context=prepare(),readings=readTextCoords(context,p.start);return doc.body.removeChild(context.mirror),readings}function coordsHTML(){var sel=getSelection();if(sel.rangeCount){var range=sel.getRangeAt(0),needsToWorkAroundNewlineBug="P"===range.startContainer.nodeName&&0===range.startOffset;if(needsToWorkAroundNewlineBug)return{x:range.startContainer.offsetLeft,y:range.startContainer.offsetTop,absolute:!0};if(range.getClientRects){var rects=range.getClientRects();if(rects.length>0)return{x:rects[0].left,y:rects[0].top,absolute:!0}}}return{x:0,y:0}}function readTextCoords(context,p){var rest=doc.createElement("span"),mirror=context.mirror,computed=context.computed;return write(mirror,read(el).substring(0,p)),"INPUT"===el.tagName&&(mirror.textContent=mirror.textContent.replace(/\s/g," ")),write(rest,read(el).substring(p)||"."),mirror.appendChild(rest),{x:rest.offsetLeft+parseInt(computed.borderLeftWidth),y:rest.offsetTop+parseInt(computed.borderTopWidth)}}function read(el){return textInput?el.value:el.innerHTML}function prepare(){function copy(prop){style[prop]=computed[prop]}var computed=win.getComputedStyle?getComputedStyle(el):el.currentStyle,mirror=doc.createElement("div"),style=mirror.style;return doc.body.appendChild(mirror),"INPUT"!==el.tagName&&(style.wordWrap="break-word"),style.whiteSpace="pre-wrap",style.position="absolute",style.visibility="hidden",props.forEach(copy),ff?(style.width=parseInt(computed.width)-2+"px",el.scrollHeight>parseInt(computed.height)&&(style.overflowY="scroll")):style.overflow="hidden",{mirror:mirror,computed:computed}}function write(el,value){textInput?el.textContent=value:el.innerHTML=value}function bind(remove){var op=remove?"remove":"add";crossvent[op](el,"keydown",throttledRefresh),crossvent[op](el,"keyup",throttledRefresh),crossvent[op](el,"input",throttledRefresh),crossvent[op](el,"paste",throttledRefresh),crossvent[op](el,"change",throttledRefresh)}function destroy(){bind(!0)}var textInput="INPUT"===el.tagName||"TEXTAREA"===el.tagName,throttledRefresh=throttle(refresh,30),o=options||{};return bind(),{read:readPosition,refresh:throttledRefresh,destroy:destroy}}var sell=require("sell"),crossvent=require("crossvent"),seleccion=require("seleccion"),throttle=require("./throttle"),getSelection=seleccion.get,props=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing"],win=global,doc=document,ff=null!==win.mozInnerScreenX&&void 0!==win.mozInnerScreenX;module.exports=tailormade}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./throttle":83,crossvent:85,seleccion:80,sell:88}],83:[function(require,module,exports){"use strict";function throttle(fn,boundary){var timer,last=-(1/0);return function(){function unbound(){clearTimeout(timer),timer=null;var next=last+boundary,now=Date.now();now>next?(last=now,fn()):timer=setTimeout(unbound,next-now)}timer||unbound()}}module.exports=throttle},{}],84:[function(require,module,exports){(function(global){function useNative(){try{var p=new NativeCustomEvent("cat",{
detail:{foo:"bar"}});return"cat"===p.type&&"bar"===p.detail.foo}catch(e){}return!1}var NativeCustomEvent=global.CustomEvent;module.exports=useNative()?NativeCustomEvent:"function"==typeof document.createEvent?function(type,params){var e=document.createEvent("CustomEvent");return params?e.initCustomEvent(type,params.bubbles,params.cancelable,params.detail):e.initCustomEvent(type,!1,!1,void 0),e}:function(type,params){var e=document.createEventObject();return e.type=type,params?(e.bubbles=Boolean(params.bubbles),e.cancelable=Boolean(params.cancelable),e.detail=params.detail):(e.bubbles=!1,e.cancelable=!1,e.detail=void 0),e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],85:[function(require,module,exports){(function(global){"use strict";function addEventEasy(el,type,fn,capturing){return el.addEventListener(type,fn,capturing)}function addEventHard(el,type,fn){return el.attachEvent("on"+type,wrap(el,type,fn))}function removeEventEasy(el,type,fn,capturing){return el.removeEventListener(type,fn,capturing)}function removeEventHard(el,type,fn){return el.detachEvent("on"+type,unwrap(el,type,fn))}function fabricateEvent(el,type,model){function makeClassicEvent(){var e;return doc.createEvent?(e=doc.createEvent("Event"),e.initEvent(type,!0,!0)):doc.createEventObject&&(e=doc.createEventObject()),e}function makeCustomEvent(){return new customEvent(type,{detail:model})}var e=-1===eventmap.indexOf(type)?makeCustomEvent():makeClassicEvent();el.dispatchEvent?el.dispatchEvent(e):el.fireEvent("on"+type,e)}function wrapperFactory(el,type,fn){return function(originalEvent){var e=originalEvent||global.event;e.target=e.target||e.srcElement,e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0},e.which=e.which||e.keyCode,fn.call(el,e)}}function wrap(el,type,fn){var wrapper=unwrap(el,type,fn)||wrapperFactory(el,type,fn);return hardCache.push({wrapper:wrapper,element:el,type:type,fn:fn}),wrapper}function unwrap(el,type,fn){var i=find(el,type,fn);if(i){var wrapper=hardCache[i].wrapper;return hardCache.splice(i,1),wrapper}}function find(el,type,fn){var i,item;for(i=0;i<hardCache.length;i++)if(item=hardCache[i],item.element===el&&item.type===type&&item.fn===fn)return i}var customEvent=require("custom-event"),eventmap=require("./eventmap"),doc=document,addEvent=addEventEasy,removeEvent=removeEventEasy,hardCache=[];global.addEventListener||(addEvent=addEventHard,removeEvent=removeEventHard),module.exports={add:addEvent,remove:removeEvent,fabricate:fabricateEvent}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":86,"custom-event":84}],86:[function(require,module,exports){(function(global){"use strict";var eventmap=[],eventname="",ron=/^on/;for(eventname in global)ron.test(eventname)&&eventmap.push(eventname.slice(2));module.exports=eventmap}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],87:[function(require,module,exports){"use strict";function fuzzysearch(needle,haystack){var tlen=haystack.length,qlen=needle.length;if(qlen>tlen)return!1;if(qlen===tlen)return needle===haystack;outer:for(var i=0,j=0;qlen>i;i++){for(var nch=needle.charCodeAt(i);tlen>j;)if(haystack.charCodeAt(j++)===nch)continue outer;return!1}return!0}module.exports=fuzzysearch},{}],88:[function(require,module,exports){"use strict";function easyGet(el){return{start:el.selectionStart,end:el.selectionEnd}}function hardGet(el){function result(start,end){return active!==el&&(active?active.focus():el.blur()),{start:start,end:end}}var active=document.activeElement;active!==el&&el.focus();var range=document.selection.createRange(),bookmark=range.getBookmark(),original=el.value,marker=getUniqueMarker(original),parent=range.parentElement();if(null===parent||!inputs(parent))return result(0,0);range.text=marker+range.text+marker;var contents=el.value;return el.value=original,range.moveToBookmark(bookmark),range.select(),result(contents.indexOf(marker),contents.lastIndexOf(marker)-marker.length)}function getUniqueMarker(contents){var marker;do marker="@@marker."+Math.random()*new Date;while(-1!==contents.indexOf(marker));return marker}function inputs(el){return"INPUT"===el.tagName&&"text"===el.type||"TEXTAREA"===el.tagName}function easySet(el,p){el.selectionStart=parse(el,p.start),el.selectionEnd=parse(el,p.end)}function hardSet(el,p){var range=el.createTextRange();"end"===p.start&&"end"===p.end?(range.collapse(!1),range.select()):(range.collapse(!0),range.moveEnd("character",parse(el,p.end)),range.moveStart("character",parse(el,p.start)),range.select())}function parse(el,value){return"end"===value?el.value.length:value||0}function sell(el,p){return 2===arguments.length&&set(el,p),get(el)}var get=easyGet,set=easySet;document.selection&&document.selection.createRange&&(get=hardGet,set=hardSet),module.exports=sell},{}],89:[function(require,module,exports){"use strict";var crossvent=require("crossvent"),dom=require("./dom"),text=require("./text"),props=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","webkitBoxSizing","mozBoxSizing","boxSizing","padding","border"],offset=20;module.exports=function(el){function remap(){var value,i,c=computed();for(i=0;i<props.length;i++)value=c[props[i]],void 0!==value&&null!==value&&(mirror.style[props[i]]=value);mirror.disabled="disabled",mirror.style.whiteSpace="pre",mirror.style.position="absolute",mirror.style.top=mirror.style.left="-9999em"}function refresh(){var value=el.value;if(value!==mirror.value){text(mirror,value);var width=mirror.offsetWidth+offset;el.style.width=width+"px"}}function bind(remove){var op=remove?"remove":"add";crossvent[op](el,"keydown",refresh),crossvent[op](el,"keyup",refresh),crossvent[op](el,"input",refresh),crossvent[op](el,"paste",refresh),crossvent[op](el,"change",refresh)}function destroy(){bind(!0),mirror.parentElement.removeChild(mirror),el.style.width=""}function computed(){return window.getComputedStyle?window.getComputedStyle(el):el.currentStyle}var mirror=dom("span");return document.body.appendChild(mirror),remap(),bind(),{remap:remap,refresh:refresh,destroy:destroy}}},{"./dom":90,"./text":99,crossvent:93}],90:[function(require,module,exports){"use strict";module.exports=function(tagName,classes){var el=document.createElement(tagName);return classes&&(el.className=classes),el}},{}],91:[function(require,module,exports){"use strict";function find(el){var entry,i;for(i=0;i<cache.length;i++)if(entry=cache[i],entry.el===el)return entry.api;return null}function insignia(el,options){function bind(remove){var op=remove?"remove":"add";crossvent[op](el,"keydown",keydown),crossvent[op](el,"keypress",keypress),crossvent[op](el,"paste",paste),crossvent[op](parent,"click",click),convertOnFocus&&crossvent[op](document.documentElement,"focus",documentfocus,!0)}function destroy(){return bind(!0),el.value=readValue(),el.className=el.className.replace(inputClass,""),parent.className=parent.className.replace(editorClass,""),before.parentElement.removeChild(before),after.parentElement.removeChild(after),cache.splice(cache.indexOf(entry),1),auto.destroy(),api.destroyed=!0,api.destroy=noop(api),api.tags=api.value=noop(null),api}function noop(value){return function(){return value}}function documentfocus(e){e.target!==el&&(_noselect=!0,convert(!0),_noselect=!1)}function click(e){var target=e.target;if(tagRemovalClass.test(target.className))return focusTag(target.parentElement,{start:"end",end:"end",remove:!0}),void shift();for(var top=target,tagged=tagClass.test(top.className);tagged===!1&&top.parentElement;)top=top.parentElement,tagged=tagClass.test(top.className);tagged?focusTag(top,end):target!==el&&(shift(),el.focus())}function shift(){focusTag(after.lastChild,end),evaluate([delimiter],!0)}function convert(all){return evaluate([delimiter],all),all&&each(after,moveLeft),crossvent.fabricate(el,"insignia-converted"),api}function moveLeft(value,tag){before.appendChild(tag)}function keydown(e){var sel=selection(el),key=e.which||e.keyCode||e.charCode;if(key===HOME)before.firstChild?focusTag(before.firstChild,{}):selection(el,{start:0,end:0});else if(key===END)after.lastChild?focusTag(after.lastChild,end):selection(el,end);else if(key===LEFT&&0===sel.start&&before.lastChild)focusTag(before.lastChild,end);else if(key!==BACKSPACE||0!==sel.start||0!==sel.end&&sel.end===el.value.length||!before.lastChild){if(key!==RIGHT||sel.end!==el.value.length||!after.firstChild)return;focusTag(after.firstChild,{})}else focusTag(before.lastChild,end);return e.preventDefault(),!1}function keypress(e){var key=e.which||e.keyCode||e.charCode;return String.fromCharCode(key)===delimiter?(convert(),e.preventDefault(),!1):void 0}function paste(){setTimeout(function(){evaluate()},0)}function evaluate(extras,entirely){var p=selection(el),len=entirely?1/0:p.start,tags=el.value.slice(0,len).concat(extras||[]).split(delimiter);if(!(tags.length<1)){var i,rest=tags.pop()+el.value.slice(len),removal=tags.join(delimiter).length;for(i=0;i<tags.length;i++)createTag(before,tags[i]);cleanup(),el.value=rest,p.start-=removal,p.end-=removal,_noselect!==!0&&selection(el,p),auto.refresh(),crossvent.fabricate(el,"insignia-evaluated")}}function cleanup(){function detect(value,tagElement){validate(value,slice(tags))?tags.push(value):tagElement.parentElement.removeChild(tagElement)}var tags=[];each(before,detect),each(after,detect)}function defaultRenderer(container,value){text(container,value)}function defaultReader(tag){return text(tag)}function createTag(buffer,value){var trimmed=value.trim();if(0!==trimmed.length){var el=dom("span","nsg-tag");render(el,parse(trimmed)),o.deletion&&el.appendChild(dom("span","nsg-tag-remove")),buffer.appendChild(el)}}function focusTag(tag,p){if(tag){evaluate([delimiter],!0);var parent=tag.parentElement;if(parent===before)for(;parent.lastChild!==tag;)after.insertBefore(parent.lastChild,after.firstChild);else for(;parent.firstChild!==tag;)before.appendChild(parent.firstChild);tag.parentElement.removeChild(tag),el.value=p.remove?"":readTag(tag),el.focus(),selection(el,p),auto.refresh()}}function hasSiblings(){var i,all=el.parentElement.children;for(i=0;i<all.length;i++)if(all[i]!==el&&all[i].nodeType===ELEMENT)return!0;return!1}function each(side,fn){var i,tag,children=slice(side.children);for(i=0;i<children.length;i++)tag=children[i],fn(readTag(tag),tag,i)}function readTags(){function add(value){if(value){var tag=parse(value);validate(tag,slice(all))&&all.push(tag)}}var i,all=[],values=el.value.split(delimiter);for(each(before,add),i=0;i<values.length;i++)add(values[i]);return each(after,add),all}function readValue(){return readTags().join(delimiter)}function defaultParse(value){return value.trim().toLowerCase()}function defaultValidate(value,tags){return-1===tags.indexOf(value)}var cached=find(el);if(cached)return cached;var _noselect=document.activeElement!==el,o=options||{},delimiter=o.delimiter||defaultDelimiter;if(1!==delimiter.length)throw new Error("Insignia expected a single-character delimiter string");var any=hasSiblings(el);if(any||!inputTag.test(el.tagName))throw new Error("Insignia expected an input element without any siblings");var parse=o.parse||defaultParse,validate=o.validate||defaultValidate,render=o.render||defaultRenderer,readTag=o.readTag||defaultReader,convertOnFocus=o.convertOnFocus!==!1,before=dom("span","nsg-tags nsg-tags-before"),after=dom("span","nsg-tags nsg-tags-after"),parent=el.parentElement;el.className+=" nsg-input",parent.className+=" nsg-editor",parent.insertBefore(before,el),parent.insertBefore(after,el.nextSibling),bind();var auto=autosize(el),api={tags:readTags,value:readValue,convert:convert,destroy:destroy},entry={el:el,api:api};return evaluate([delimiter],!0),cache.push(entry),_noselect=!1,api}require("./polyfills/String.prototype.trim"),require("./polyfills/Array.prototype.indexOf");var crossvent=require("crossvent"),dom=require("./dom"),text=require("./text"),slice=require("./slice"),autosize=require("./autosize"),selection=require("./selection"),inputTag=/^input$/i,ELEMENT=1,BACKSPACE=8,END=35,HOME=36,LEFT=37,RIGHT=39,tagClass=/\bnsg-tag\b/,tagRemovalClass=/\bnsg-tag-remove\b/,editorClass=/\bnsg-editor\b/g,inputClass=/\bnsg-input\b/g,end={start:"end",end:"end"},cache=[],defaultDelimiter=" ";insignia.find=find,module.exports=insignia},{"./autosize":89,"./dom":90,"./polyfills/Array.prototype.indexOf":95,"./polyfills/String.prototype.trim":96,"./selection":97,"./slice":98,"./text":99,crossvent:93}],92:[function(require,module,exports){arguments[4][84][0].apply(exports,arguments)},{dup:84}],93:[function(require,module,exports){(function(global){"use strict";function addEventEasy(el,type,fn,capturing){return el.addEventListener(type,fn,capturing)}function addEventHard(el,type,fn){return el.attachEvent("on"+type,wrap(el,type,fn))}function removeEventEasy(el,type,fn,capturing){return el.removeEventListener(type,fn,capturing)}function removeEventHard(el,type,fn){var listener=unwrap(el,type,fn);return listener?el.detachEvent("on"+type,listener):void 0}function fabricateEvent(el,type,model){function makeClassicEvent(){var e;return doc.createEvent?(e=doc.createEvent("Event"),e.initEvent(type,!0,!0)):doc.createEventObject&&(e=doc.createEventObject()),e}function makeCustomEvent(){return new customEvent(type,{detail:model})}var e=-1===eventmap.indexOf(type)?makeCustomEvent():makeClassicEvent();el.dispatchEvent?el.dispatchEvent(e):el.fireEvent("on"+type,e)}function wrapperFactory(el,type,fn){return function(originalEvent){var e=originalEvent||global.event;e.target=e.target||e.srcElement,e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0},e.which=e.which||e.keyCode,fn.call(el,e)}}function wrap(el,type,fn){var wrapper=unwrap(el,type,fn)||wrapperFactory(el,type,fn);return hardCache.push({wrapper:wrapper,element:el,type:type,fn:fn}),wrapper}function unwrap(el,type,fn){var i=find(el,type,fn);if(i){var wrapper=hardCache[i].wrapper;return hardCache.splice(i,1),wrapper}}function find(el,type,fn){var i,item;for(i=0;i<hardCache.length;i++)if(item=hardCache[i],item.element===el&&item.type===type&&item.fn===fn)return i}var customEvent=require("custom-event"),eventmap=require("./eventmap"),doc=global.document,addEvent=addEventEasy,removeEvent=removeEventEasy,hardCache=[];global.addEventListener||(addEvent=addEventHard,removeEvent=removeEventHard),module.exports={add:addEvent,remove:removeEvent,fabricate:fabricateEvent}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./eventmap":94,"custom-event":92}],94:[function(require,module,exports){arguments[4][86][0].apply(exports,arguments)},{dup:86}],95:[function(require,module,exports){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(what,start){if(void 0===this||null===this)throw new TypeError;var length=this.length;for(start=+start||0,Math.abs(start)===1/0?start=0:0>start&&(start+=length,0>start&&(start=0));length>start;start++)if(this[start]===what)return start;return-1})},{}],96:[function(require,module,exports){"use strict";if(!String.prototype.trim){var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(rtrim,"")}}},{}],97:[function(require,module,exports){"use strict";function easyGet(el){return{start:el.selectionStart,end:el.selectionEnd}}function hardGet(el){function result(start,end){return active!==el&&(active?active.focus():el.blur()),{start:start,end:end}}var active=document.activeElement;active!==el&&el.focus();var range=document.selection.createRange(),bookmark=range.getBookmark(),original=el.value,marker=getUniqueMarker(original),parent=range.parentElement();if(null===parent||!inputs(parent))return result(0,0);range.text=marker+range.text+marker;var contents=el.value;return el.value=original,range.moveToBookmark(bookmark),range.select(),result(contents.indexOf(marker),contents.lastIndexOf(marker)-marker.length)}function getUniqueMarker(contents){var marker;do marker="@@marker."+Math.random()*new Date;while(-1!==contents.indexOf(marker));return marker}function inputs(el){return inputTag.test(el.tagName)&&"text"===el.type||textareaTag.test(el.tagName)}function easySet(el,p){el.selectionStart=special(el,p.start),el.selectionEnd=special(el,p.end)}function hardSet(el,p){var range=el.createTextRange();"end"===p.start&&"end"===p.end?(range.collapse(!1),range.select()):(range.collapse(!0),range.moveEnd("character",p.end),range.moveStart("character",p.start),range.select())}function special(el,value){return"end"===value?el.value.length:value||0}function selection(el,p){return 2===arguments.length&&set(el,p),get(el)}var get=easyGet,set=easySet,inputTag=/input/i,textareaTag=/textarea/i;document.selection&&document.selection.createRange&&(get=hardGet,set=hardSet),module.exports=selection},{}],98:[function(require,module,exports){"use strict";function slice(collection){var i,result=[];for(i=0;i<collection.length;i++)result.push(collection[i]);return result}module.exports=slice},{}],99:[function(require,module,exports){"use strict";function text(el,value){return 2===arguments.length&&(el.innerText=el.textContent=value),"string"==typeof el.innerText?el.innerText:el.textContent}module.exports=text},{}],100:[function(require,module,exports){var Pipe=require("../pipe").Pipe,Context=function(){};Context.prototype.setResult=function(result){return this.result=result,this.hasResult=!0,this},Context.prototype.exit=function(){return this.exiting=!0,this},Context.prototype.switchTo=function(next,pipe){return"string"==typeof next||next instanceof Pipe?this.nextPipe=next:(this.next=next,pipe&&(this.nextPipe=pipe)),this},Context.prototype.push=function(child,name){return child.parent=this,"undefined"!=typeof name&&(child.childName=name),child.root=this.root||this,child.options=child.options||this.options,this.children?(this.children[this.children.length-1].next=child,this.children.push(child)):(this.children=[child],this.nextAfterChildren=this.next||null,this.next=child),child.next=this,this},exports.Context=Context},{"../pipe":114}],101:[function(require,module,exports){var Context=require("./context").Context,DiffContext=function(left,right){this.left=left,this.right=right,this.pipe="diff"};DiffContext.prototype=new Context,exports.DiffContext=DiffContext},{"./context":100}],102:[function(require,module,exports){var Context=require("./context").Context,PatchContext=function(left,delta){this.left=left,this.delta=delta,this.pipe="patch"};PatchContext.prototype=new Context,exports.PatchContext=PatchContext},{"./context":100}],103:[function(require,module,exports){var Context=require("./context").Context,ReverseContext=function(delta){this.delta=delta,this.pipe="reverse"};ReverseContext.prototype=new Context,exports.ReverseContext=ReverseContext},{"./context":100}],104:[function(require,module,exports){module.exports=function(key,value){var parts;return"string"==typeof value&&(parts=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d*))?(Z|([+\-])(\d{2}):(\d{2}))$/.exec(value))?new Date(Date.UTC(+parts[1],+parts[2]-1,+parts[3],+parts[4],+parts[5],+parts[6],+(parts[7]||0))):value}},{}],105:[function(require,module,exports){var Processor=require("./processor").Processor,Pipe=require("./pipe").Pipe,DiffContext=require("./contexts/diff").DiffContext,PatchContext=require("./contexts/patch").PatchContext,ReverseContext=require("./contexts/reverse").ReverseContext,trivial=require("./filters/trivial"),nested=require("./filters/nested"),arrays=require("./filters/arrays"),dates=require("./filters/dates"),texts=require("./filters/texts"),DiffPatcher=function(options){this.processor=new Processor(options),this.processor.pipe(new Pipe("diff").append(nested.collectChildrenDiffFilter,trivial.diffFilter,dates.diffFilter,texts.diffFilter,nested.objectsDiffFilter,arrays.diffFilter).shouldHaveResult()),this.processor.pipe(new Pipe("patch").append(nested.collectChildrenPatchFilter,arrays.collectChildrenPatchFilter,trivial.patchFilter,texts.patchFilter,nested.patchFilter,arrays.patchFilter).shouldHaveResult()),this.processor.pipe(new Pipe("reverse").append(nested.collectChildrenReverseFilter,arrays.collectChildrenReverseFilter,trivial.reverseFilter,texts.reverseFilter,nested.reverseFilter,arrays.reverseFilter).shouldHaveResult())};DiffPatcher.prototype.options=function(){return this.processor.options.apply(this.processor,arguments)},DiffPatcher.prototype.diff=function(left,right){return this.processor.process(new DiffContext(left,right))},DiffPatcher.prototype.patch=function(left,delta){return this.processor.process(new PatchContext(left,delta))},DiffPatcher.prototype.reverse=function(delta){return this.processor.process(new ReverseContext(delta))},DiffPatcher.prototype.unpatch=function(right,delta){return this.patch(right,this.reverse(delta))},exports.DiffPatcher=DiffPatcher},{"./contexts/diff":101,"./contexts/patch":102,"./contexts/reverse":103,"./filters/arrays":107,"./filters/dates":108,"./filters/nested":110,"./filters/texts":111,"./filters/trivial":112,"./pipe":114,"./processor":115}],106:[function(require,module,exports){exports.isBrowser="undefined"!=typeof window},{}],107:[function(require,module,exports){function arraysHaveMatchByRef(array1,array2,len1,len2){for(var index1=0;len1>index1;index1++)for(var val1=array1[index1],index2=0;len2>index2;index2++){var val2=array2[index2];if(val1===val2)return!0}}function matchItems(array1,array2,index1,index2,context){var value1=array1[index1],value2=array2[index2];if(value1===value2)return!0;if("object"!=typeof value1||"object"!=typeof value2)return!1;var objectHash=context.objectHash;if(!objectHash)return context.matchByPosition&&index1===index2;var hash1,hash2;return"number"==typeof index1?(context.hashCache1=context.hashCache1||[],hash1=context.hashCache1[index1],"undefined"==typeof hash1&&(context.hashCache1[index1]=hash1=objectHash(value1,index1))):hash1=objectHash(value1),"undefined"==typeof hash1?!1:("number"==typeof index2?(context.hashCache2=context.hashCache2||[],hash2=context.hashCache2[index2],"undefined"==typeof hash2&&(context.hashCache2[index2]=hash2=objectHash(value2,index2))):hash2=objectHash(value2),"undefined"==typeof hash2?!1:hash1===hash2)}var DiffContext=require("../contexts/diff").DiffContext,PatchContext=require("../contexts/patch").PatchContext,ReverseContext=require("../contexts/reverse").ReverseContext,lcs=require("./lcs"),ARRAY_MOVE=3,isArray="function"==typeof Array.isArray?Array.isArray:function(a){return a instanceof Array},arrayIndexOf="function"==typeof Array.prototype.indexOf?function(array,item){return array.indexOf(item)}:function(array,item){for(var length=array.length,i=0;length>i;i++)if(array[i]===item)return i;return-1},diffFilter=function(context){if(context.leftIsArray){var index,index1,index2,child,matchContext={objectHash:context.options&&context.options.objectHash,matchByPosition:context.options&&context.options.matchByPosition},commonHead=0,commonTail=0,array1=context.left,array2=context.right,len1=array1.length,len2=array2.length;for(len1>0&&len2>0&&!matchContext.objectHash&&"boolean"!=typeof matchContext.matchByPosition&&(matchContext.matchByPosition=!arraysHaveMatchByRef(array1,array2,len1,len2));len1>commonHead&&len2>commonHead&&matchItems(array1,array2,commonHead,commonHead,matchContext);)index=commonHead,child=new DiffContext(context.left[index],context.right[index]),context.push(child,index),commonHead++;for(;len1>commonTail+commonHead&&len2>commonTail+commonHead&&matchItems(array1,array2,len1-1-commonTail,len2-1-commonTail,matchContext);)index1=len1-1-commonTail,index2=len2-1-commonTail,child=new DiffContext(context.left[index1],context.right[index2]),context.push(child,index2),commonTail++;var result;if(commonHead+commonTail===len1){if(len1===len2)return void context.setResult(void 0).exit();for(result=result||{_t:"a"},index=commonHead;len2-commonTail>index;index++)result[index]=[array2[index]];return void context.setResult(result).exit()}if(commonHead+commonTail===len2){for(result=result||{_t:"a"},index=commonHead;len1-commonTail>index;index++)result["_"+index]=[array1[index],0,0];return void context.setResult(result).exit()}delete matchContext.hashCache1,delete matchContext.hashCache2;var trimmed1=array1.slice(commonHead,len1-commonTail),trimmed2=array2.slice(commonHead,len2-commonTail),seq=lcs.get(trimmed1,trimmed2,matchItems,matchContext),removedItems=[];for(result=result||{_t:"a"},index=commonHead;len1-commonTail>index;index++)arrayIndexOf(seq.indices1,index-commonHead)<0&&(result["_"+index]=[array1[index],0,0],removedItems.push(index));var detectMove=!0;context.options&&context.options.arrays&&context.options.arrays.detectMove===!1&&(detectMove=!1);var includeValueOnMove=!1;context.options&&context.options.arrays&&context.options.arrays.includeValueOnMove&&(includeValueOnMove=!0);var removedItemsLength=removedItems.length;for(index=commonHead;len2-commonTail>index;index++){var indexOnArray2=arrayIndexOf(seq.indices2,index-commonHead);if(0>indexOnArray2){var isMove=!1;if(detectMove&&removedItemsLength>0)for(var removeItemIndex1=0;removedItemsLength>removeItemIndex1;removeItemIndex1++)if(index1=removedItems[removeItemIndex1],matchItems(trimmed1,trimmed2,index1-commonHead,index-commonHead,matchContext)){result["_"+index1].splice(1,2,index,ARRAY_MOVE),includeValueOnMove||(result["_"+index1][0]=""),index2=index,child=new DiffContext(context.left[index1],context.right[index2]),context.push(child,index2),removedItems.splice(removeItemIndex1,1),isMove=!0;break}isMove||(result[index]=[array2[index]])}else index1=seq.indices1[indexOnArray2]+commonHead,index2=seq.indices2[indexOnArray2]+commonHead,child=new DiffContext(context.left[index1],context.right[index2]),context.push(child,index2)}context.setResult(result).exit()}};diffFilter.filterName="arrays";var compare={numerically:function(a,b){return a-b},numericallyBy:function(name){return function(a,b){return a[name]-b[name]}}},patchFilter=function(context){if(context.nested&&"a"===context.delta._t){var index,index1,delta=context.delta,array=context.left,toRemove=[],toInsert=[],toModify=[];for(index in delta)if("_t"!==index)if("_"===index[0]){if(0!==delta[index][2]&&delta[index][2]!==ARRAY_MOVE)throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+delta[index][2]);toRemove.push(parseInt(index.slice(1),10))}else 1===delta[index].length?toInsert.push({index:parseInt(index,10),value:delta[index][0]}):toModify.push({index:parseInt(index,10),delta:delta[index]});for(toRemove=toRemove.sort(compare.numerically),index=toRemove.length-1;index>=0;index--){index1=toRemove[index];var indexDiff=delta["_"+index1],removedValue=array.splice(index1,1)[0];indexDiff[2]===ARRAY_MOVE&&toInsert.push({index:indexDiff[1],value:removedValue})}toInsert=toInsert.sort(compare.numericallyBy("index"));var toInsertLength=toInsert.length;for(index=0;toInsertLength>index;index++){var insertion=toInsert[index];array.splice(insertion.index,0,insertion.value)}var child,toModifyLength=toModify.length;if(toModifyLength>0)for(index=0;toModifyLength>index;index++){var modification=toModify[index];child=new PatchContext(context.left[modification.index],modification.delta),context.push(child,modification.index)}return context.children?void context.exit():void context.setResult(context.left).exit()}};patchFilter.filterName="arrays";var collectChildrenPatchFilter=function(context){if(context&&context.children&&"a"===context.delta._t){for(var child,length=context.children.length,index=0;length>index;index++)child=context.children[index],context.left[child.childName]=child.result;context.setResult(context.left).exit()}};collectChildrenPatchFilter.filterName="arraysCollectChildren";var reverseFilter=function(context){if(!context.nested)return void(context.delta[2]===ARRAY_MOVE&&(context.newName="_"+context.delta[1],context.setResult([context.delta[0],parseInt(context.childName.substr(1),10),ARRAY_MOVE]).exit()));if("a"===context.delta._t){var name,child;for(name in context.delta)"_t"!==name&&(child=new ReverseContext(context.delta[name]),context.push(child,name));context.exit()}};reverseFilter.filterName="arrays";var reverseArrayDeltaIndex=function(delta,index,itemDelta){if("string"==typeof index&&"_"===index[0])return parseInt(index.substr(1),10);if(isArray(itemDelta)&&0===itemDelta[2])return"_"+index;var reverseIndex=+index;for(var deltaIndex in delta){var deltaItem=delta[deltaIndex];if(isArray(deltaItem))if(deltaItem[2]===ARRAY_MOVE){var moveFromIndex=parseInt(deltaIndex.substr(1),10),moveToIndex=deltaItem[1];if(moveToIndex===+index)return moveFromIndex;reverseIndex>=moveFromIndex&&moveToIndex>reverseIndex?reverseIndex++:moveFromIndex>=reverseIndex&&reverseIndex>moveToIndex&&reverseIndex--}else if(0===deltaItem[2]){var deleteIndex=parseInt(deltaIndex.substr(1),10);reverseIndex>=deleteIndex&&reverseIndex++}else 1===deltaItem.length&&reverseIndex>=deltaIndex&&reverseIndex--}return reverseIndex},collectChildrenReverseFilter=function(context){if(context&&context.children&&"a"===context.delta._t){for(var child,length=context.children.length,delta={_t:"a"},index=0;length>index;index++){child=context.children[index];var name=child.newName;"undefined"==typeof name&&(name=reverseArrayDeltaIndex(context.delta,child.childName,child.result)),delta[name]!==child.result&&(delta[name]=child.result)}context.setResult(delta).exit()}};collectChildrenReverseFilter.filterName="arraysCollectChildren",exports.diffFilter=diffFilter,exports.patchFilter=patchFilter,exports.collectChildrenPatchFilter=collectChildrenPatchFilter,exports.reverseFilter=reverseFilter,exports.collectChildrenReverseFilter=collectChildrenReverseFilter},{"../contexts/diff":101,"../contexts/patch":102,"../contexts/reverse":103,"./lcs":109}],108:[function(require,module,exports){var diffFilter=function(context){context.left instanceof Date?(context.right instanceof Date?context.left.getTime()!==context.right.getTime()?context.setResult([context.left,context.right]):context.setResult(void 0):context.setResult([context.left,context.right]),context.exit()):context.right instanceof Date&&context.setResult([context.left,context.right]).exit()};diffFilter.filterName="dates",exports.diffFilter=diffFilter},{}],109:[function(require,module,exports){var defaultMatch=function(array1,array2,index1,index2){return array1[index1]===array2[index2]},lengthMatrix=function(array1,array2,match,context){var x,y,len1=array1.length,len2=array2.length,matrix=[len1+1];for(x=0;len1+1>x;x++)for(matrix[x]=[len2+1],y=0;len2+1>y;y++)matrix[x][y]=0;for(matrix.match=match,x=1;len1+1>x;x++)for(y=1;len2+1>y;y++)match(array1,array2,x-1,y-1,context)?matrix[x][y]=matrix[x-1][y-1]+1:matrix[x][y]=Math.max(matrix[x-1][y],matrix[x][y-1]);return matrix},backtrack=function(matrix,array1,array2,index1,index2,context){if(0===index1||0===index2)return{sequence:[],indices1:[],indices2:[]};if(matrix.match(array1,array2,index1-1,index2-1,context)){var subsequence=backtrack(matrix,array1,array2,index1-1,index2-1,context);return subsequence.sequence.push(array1[index1-1]),subsequence.indices1.push(index1-1),subsequence.indices2.push(index2-1),subsequence}return matrix[index1][index2-1]>matrix[index1-1][index2]?backtrack(matrix,array1,array2,index1,index2-1,context):backtrack(matrix,array1,array2,index1-1,index2,context)},get=function(array1,array2,match,context){context=context||{};var matrix=lengthMatrix(array1,array2,match||defaultMatch,context),result=backtrack(matrix,array1,array2,array1.length,array2.length,context);return"string"==typeof array1&&"string"==typeof array2&&(result.sequence=result.sequence.join("")),result};exports.get=get},{}],110:[function(require,module,exports){
var DiffContext=require("../contexts/diff").DiffContext,PatchContext=require("../contexts/patch").PatchContext,ReverseContext=require("../contexts/reverse").ReverseContext,collectChildrenDiffFilter=function(context){if(context&&context.children){for(var child,length=context.children.length,result=context.result,index=0;length>index;index++)child=context.children[index],"undefined"!=typeof child.result&&(result=result||{},result[child.childName]=child.result);result&&context.leftIsArray&&(result._t="a"),context.setResult(result).exit()}};collectChildrenDiffFilter.filterName="collectChildren";var objectsDiffFilter=function(context){if(!context.leftIsArray&&"object"===context.leftType){var name,child;for(name in context.left)child=new DiffContext(context.left[name],context.right[name]),context.push(child,name);for(name in context.right)"undefined"==typeof context.left[name]&&(child=new DiffContext(void 0,context.right[name]),context.push(child,name));return context.children&&0!==context.children.length?void context.exit():void context.setResult(void 0).exit()}};objectsDiffFilter.filterName="objects";var patchFilter=function(context){if(context.nested&&!context.delta._t){var name,child;for(name in context.delta)child=new PatchContext(context.left[name],context.delta[name]),context.push(child,name);context.exit()}};patchFilter.filterName="objects";var collectChildrenPatchFilter=function(context){if(context&&context.children&&!context.delta._t){for(var child,length=context.children.length,index=0;length>index;index++)child=context.children[index],context.left.hasOwnProperty(child.childName)&&void 0===child.result?delete context.left[child.childName]:context.left[child.childName]!==child.result&&(context.left[child.childName]=child.result);context.setResult(context.left).exit()}};collectChildrenPatchFilter.filterName="collectChildren";var reverseFilter=function(context){if(context.nested&&!context.delta._t){var name,child;for(name in context.delta)child=new ReverseContext(context.delta[name]),context.push(child,name);context.exit()}};reverseFilter.filterName="objects";var collectChildrenReverseFilter=function(context){if(context&&context.children&&!context.delta._t){for(var child,length=context.children.length,delta={},index=0;length>index;index++)child=context.children[index],delta[child.childName]!==child.result&&(delta[child.childName]=child.result);context.setResult(delta).exit()}};collectChildrenReverseFilter.filterName="collectChildren",exports.collectChildrenDiffFilter=collectChildrenDiffFilter,exports.objectsDiffFilter=objectsDiffFilter,exports.patchFilter=patchFilter,exports.collectChildrenPatchFilter=collectChildrenPatchFilter,exports.reverseFilter=reverseFilter,exports.collectChildrenReverseFilter=collectChildrenReverseFilter},{"../contexts/diff":101,"../contexts/patch":102,"../contexts/reverse":103}],111:[function(require,module,exports){var TEXT_DIFF=2,DEFAULT_MIN_LENGTH=60,cachedDiffPatch=null,getDiffMatchPatch=function(){if(!cachedDiffPatch){var instance;if("undefined"!=typeof diff_match_patch)instance="function"==typeof diff_match_patch?new diff_match_patch:new diff_match_patch.diff_match_patch;else if("function"==typeof require)try{var dmpModuleName="diff_match_patch_uncompressed",dmp=require("../../public/external/"+dmpModuleName);instance=new dmp.diff_match_patch}catch(err){instance=null}if(!instance){var error=new Error("text diff_match_patch library not found");throw error.diff_match_patch_not_found=!0,error}cachedDiffPatch={diff:function(txt1,txt2){return instance.patch_toText(instance.patch_make(txt1,txt2))},patch:function(txt1,patch){for(var results=instance.patch_apply(instance.patch_fromText(patch),txt1),i=0;i<results[1].length;i++)if(!results[1][i]){var error=new Error("text patch failed");error.textPatchFailed=!0}return results[0]}}}return cachedDiffPatch},diffFilter=function(context){if("string"===context.leftType){var minLength=context.options&&context.options.textDiff&&context.options.textDiff.minLength||DEFAULT_MIN_LENGTH;if(context.left.length<minLength||context.right.length<minLength)return void context.setResult([context.left,context.right]).exit();var diff=getDiffMatchPatch().diff;context.setResult([diff(context.left,context.right),0,TEXT_DIFF]).exit()}};diffFilter.filterName="texts";var patchFilter=function(context){if(!context.nested&&context.delta[2]===TEXT_DIFF){var patch=getDiffMatchPatch().patch;context.setResult(patch(context.left,context.delta[0])).exit()}};patchFilter.filterName="texts";var textDeltaReverse=function(delta){var i,l,lines,line,lineTmp,lineHeader,lineAdd,lineRemove,header=null,headerRegex=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(lines=delta.split("\n"),i=0,l=lines.length;l>i;i++){line=lines[i];var lineStart=line.slice(0,1);"@"===lineStart?(header=headerRegex.exec(line),lineHeader=i,lineAdd=null,lineRemove=null,lines[lineHeader]="@@ -"+header[3]+","+header[4]+" +"+header[1]+","+header[2]+" @@"):"+"===lineStart?(lineAdd=i,lines[i]="-"+lines[i].slice(1),"+"===lines[i-1].slice(0,1)&&(lineTmp=lines[i],lines[i]=lines[i-1],lines[i-1]=lineTmp)):"-"===lineStart&&(lineRemove=i,lines[i]="+"+lines[i].slice(1))}return lines.join("\n")},reverseFilter=function(context){context.nested||context.delta[2]===TEXT_DIFF&&context.setResult([textDeltaReverse(context.delta[0]),0,TEXT_DIFF]).exit()};reverseFilter.filterName="texts",exports.diffFilter=diffFilter,exports.patchFilter=patchFilter,exports.reverseFilter=reverseFilter},{}],112:[function(require,module,exports){var isArray="function"==typeof Array.isArray?Array.isArray:function(a){return a instanceof Array},diffFilter=function(context){if(context.left===context.right)return void context.setResult(void 0).exit();if("undefined"==typeof context.left){if("function"==typeof context.right)throw new Error("functions are not supported");return void context.setResult([context.right]).exit()}if("undefined"==typeof context.right)return void context.setResult([context.left,0,0]).exit();if("function"==typeof context.left||"function"==typeof context.right)throw new Error("functions are not supported");return context.leftType=null===context.left?"null":typeof context.left,context.rightType=null===context.right?"null":typeof context.right,context.leftType!==context.rightType?void context.setResult([context.left,context.right]).exit():"boolean"===context.leftType||"number"===context.leftType?void context.setResult([context.left,context.right]).exit():("object"===context.leftType&&(context.leftIsArray=isArray(context.left)),"object"===context.rightType&&(context.rightIsArray=isArray(context.right)),context.leftIsArray!==context.rightIsArray?void context.setResult([context.left,context.right]).exit():void 0)};diffFilter.filterName="trivial";var patchFilter=function(context){return"undefined"==typeof context.delta?void context.setResult(context.left).exit():(context.nested=!isArray(context.delta),context.nested?void 0:1===context.delta.length?void context.setResult(context.delta[0]).exit():2===context.delta.length?void context.setResult(context.delta[1]).exit():3===context.delta.length&&0===context.delta[2]?void context.setResult(void 0).exit():void 0)};patchFilter.filterName="trivial";var reverseFilter=function(context){return"undefined"==typeof context.delta?void context.setResult(context.delta).exit():(context.nested=!isArray(context.delta),context.nested?void 0:1===context.delta.length?void context.setResult([context.delta[0],0,0]).exit():2===context.delta.length?void context.setResult([context.delta[1],context.delta[0]]).exit():3===context.delta.length&&0===context.delta[2]?void context.setResult([context.delta[0]]).exit():void 0)};reverseFilter.filterName="trivial",exports.diffFilter=diffFilter,exports.patchFilter=patchFilter,exports.reverseFilter=reverseFilter},{}],113:[function(require,module,exports){var environment=require("./environment"),DiffPatcher=require("./diffpatcher").DiffPatcher;exports.DiffPatcher=DiffPatcher,exports.create=function(options){return new DiffPatcher(options)},exports.dateReviver=require("./date-reviver");var defaultInstance;if(exports.diff=function(){return defaultInstance||(defaultInstance=new DiffPatcher),defaultInstance.diff.apply(defaultInstance,arguments)},exports.patch=function(){return defaultInstance||(defaultInstance=new DiffPatcher),defaultInstance.patch.apply(defaultInstance,arguments)},exports.unpatch=function(){return defaultInstance||(defaultInstance=new DiffPatcher),defaultInstance.unpatch.apply(defaultInstance,arguments)},exports.reverse=function(){return defaultInstance||(defaultInstance=new DiffPatcher),defaultInstance.reverse.apply(defaultInstance,arguments)},environment.isBrowser)exports.homepage="{{package-homepage}}",exports.version="{{package-version}}";else{var packageInfoModuleName="../package.json",packageInfo=require(packageInfoModuleName);exports.homepage=packageInfo.homepage,exports.version=packageInfo.version;var formatterModuleName="./formatters",formatters=require(formatterModuleName);exports.formatters=formatters,exports.console=formatters.console}},{"./date-reviver":104,"./diffpatcher":105,"./environment":106}],114:[function(require,module,exports){var Pipe=function(name){this.name=name,this.filters=[]};Pipe.prototype.process=function(input){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var debug=this.debug,length=this.filters.length,context=input,index=0;length>index;index++){var filter=this.filters[index];if(debug&&this.log("filter: "+filter.filterName),filter(context),"object"==typeof context&&context.exiting){context.exiting=!1;break}}!context.next&&this.resultCheck&&this.resultCheck(context)},Pipe.prototype.log=function(msg){console.log("[jsondiffpatch] "+this.name+" pipe, "+msg)},Pipe.prototype.append=function(){return this.filters.push.apply(this.filters,arguments),this},Pipe.prototype.prepend=function(){return this.filters.unshift.apply(this.filters,arguments),this},Pipe.prototype.indexOf=function(filterName){if(!filterName)throw new Error("a filter name is required");for(var index=0;index<this.filters.length;index++){var filter=this.filters[index];if(filter.filterName===filterName)return index}throw new Error("filter not found: "+filterName)},Pipe.prototype.list=function(){for(var names=[],index=0;index<this.filters.length;index++){var filter=this.filters[index];names.push(filter.filterName)}return names},Pipe.prototype.after=function(filterName){var index=this.indexOf(filterName),params=Array.prototype.slice.call(arguments,1);if(!params.length)throw new Error("a filter is required");return params.unshift(index+1,0),Array.prototype.splice.apply(this.filters,params),this},Pipe.prototype.before=function(filterName){var index=this.indexOf(filterName),params=Array.prototype.slice.call(arguments,1);if(!params.length)throw new Error("a filter is required");return params.unshift(index,0),Array.prototype.splice.apply(this.filters,params),this},Pipe.prototype.clear=function(){return this.filters.length=0,this},Pipe.prototype.shouldHaveResult=function(should){if(should===!1)return void(this.resultCheck=null);if(!this.resultCheck){var pipe=this;return this.resultCheck=function(context){if(!context.hasResult){console.log(context);var error=new Error(pipe.name+" failed");throw error.noResult=!0,error}},this}},exports.Pipe=Pipe},{}],115:[function(require,module,exports){var Processor=function(options){this.selfOptions=options,this.pipes={}};Processor.prototype.options=function(options){return options&&(this.selfOptions=options),this.selfOptions},Processor.prototype.pipe=function(name,pipe){if("string"==typeof name){if("undefined"==typeof pipe)return this.pipes[name];this.pipes[name]=pipe}if(name&&name.name){if(pipe=name,pipe.processor===this)return pipe;this.pipes[pipe.name]=pipe}return pipe.processor=this,pipe},Processor.prototype.process=function(input,pipe){var context=input;context.options=this.options();for(var lastPipe,lastContext,nextPipe=pipe||input.pipe||"default";nextPipe;)"undefined"!=typeof context.nextAfterChildren&&(context.next=context.nextAfterChildren,context.nextAfterChildren=null),"string"==typeof nextPipe&&(nextPipe=this.pipe(nextPipe)),nextPipe.process(context),lastContext=context,lastPipe=nextPipe,nextPipe=null,context&&context.next&&(context=context.next,nextPipe=lastContext.nextPipe||context.pipe||lastPipe);return context.hasResult?context.result:void 0},exports.Processor=Processor},{}],116:[function(require,module,exports){function noop(){}function isHost(obj){var str={}.toString.call(obj);switch(str){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}}function isObject(obj){return obj===Object(obj)}function serialize(obj){if(!isObject(obj))return obj;var pairs=[];for(var key in obj)null!=obj[key]&&pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(obj[key]));return pairs.join("&")}function parseString(str){for(var parts,pair,obj={},pairs=str.split("&"),i=0,len=pairs.length;len>i;++i)pair=pairs[i],parts=pair.split("="),obj[decodeURIComponent(parts[0])]=decodeURIComponent(parts[1]);return obj}function parseHeader(str){var index,line,field,val,lines=str.split(/\r?\n/),fields={};lines.pop();for(var i=0,len=lines.length;len>i;++i)line=lines[i],index=line.indexOf(":"),field=line.slice(0,index).toLowerCase(),val=trim(line.slice(index+1)),fields[field]=val;return fields}function type(str){return str.split(/ *; */).shift()}function params(str){return reduce(str.split(/ *; */),function(obj,str){var parts=str.split(/ *= */),key=parts.shift(),val=parts.shift();return key&&val&&(obj[key]=val),obj},{})}function Response(req,options){options=options||{},this.req=req,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=parseHeader(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}function Request(method,url){var self=this;Emitter.call(this),this._query=this._query||[],this.method=method,this.url=url,this.header={},this._header={},this.on("end",function(){var err=null,res=null;try{res=new Response(self)}catch(e){return err=new Error("Parser is unable to parse the response"),err.parse=!0,err.original=e,self.callback(err)}if(self.emit("response",res),err)return self.callback(err,res);if(res.status>=200&&res.status<300)return self.callback(err,res);var new_err=new Error(res.statusText||"Unsuccessful HTTP response");new_err.original=err,new_err.response=res,new_err.status=res.status,self.callback(new_err,res)})}function request(method,url){return"function"==typeof url?new Request("GET",method).end(url):1==arguments.length?new Request("GET",method):new Request(method,url)}var root,Emitter=require("emitter"),reduce=require("reduce");root="undefined"!=typeof window?window:"undefined"!=typeof self?self:this,request.getXHR=function(){if(!(!root.XMLHttpRequest||root.location&&"file:"==root.location.protocol&&root.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1};var trim="".trim?function(s){return s.trim()}:function(s){return s.replace(/(^\s*|\s*$)/g,"")};request.serializeObject=serialize,request.parseString=parseString,request.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},request.serialize={"application/x-www-form-urlencoded":serialize,"application/json":JSON.stringify},request.parse={"application/x-www-form-urlencoded":parseString,"application/json":JSON.parse},Response.prototype.get=function(field){return this.header[field.toLowerCase()]},Response.prototype.setHeaderProperties=function(header){var ct=this.header["content-type"]||"";this.type=type(ct);var obj=params(ct);for(var key in obj)this[key]=obj[key]},Response.prototype.parse=function(fn){return this.parser=fn,this},Response.prototype.parseBody=function(str){var parse=this.parser||request.parse[this.type];return parse&&str&&(str.length||str instanceof Object)?parse(str):null},Response.prototype.setStatusProperties=function(status){1223===status&&(status=204);var type=status/100|0;this.status=this.statusCode=status,this.statusType=type,this.info=1==type,this.ok=2==type,this.clientError=4==type,this.serverError=5==type,this.error=4==type||5==type?this.toError():!1,this.accepted=202==status,this.noContent=204==status,this.badRequest=400==status,this.unauthorized=401==status,this.notAcceptable=406==status,this.notFound=404==status,this.forbidden=403==status},Response.prototype.toError=function(){var req=this.req,method=req.method,url=req.url,msg="cannot "+method+" "+url+" ("+this.status+")",err=new Error(msg);return err.status=this.status,err.method=method,err.url=url,err},request.Response=Response,Emitter(Request.prototype),Request.prototype.use=function(fn){return fn(this),this},Request.prototype.timeout=function(ms){return this._timeout=ms,this},Request.prototype.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},Request.prototype.abort=function(){return this.aborted?void 0:(this.aborted=!0,this.xhr.abort(),this.clearTimeout(),this.emit("abort"),this)},Request.prototype.set=function(field,val){if(isObject(field)){for(var key in field)this.set(key,field[key]);return this}return this._header[field.toLowerCase()]=val,this.header[field]=val,this},Request.prototype.unset=function(field){return delete this._header[field.toLowerCase()],delete this.header[field],this},Request.prototype.getHeader=function(field){return this._header[field.toLowerCase()]},Request.prototype.type=function(type){return this.set("Content-Type",request.types[type]||type),this},Request.prototype.accept=function(type){return this.set("Accept",request.types[type]||type),this},Request.prototype.auth=function(user,pass){var str=btoa(user+":"+pass);return this.set("Authorization","Basic "+str),this},Request.prototype.query=function(val){return"string"!=typeof val&&(val=serialize(val)),val&&this._query.push(val),this},Request.prototype.field=function(name,val){return this._formData||(this._formData=new root.FormData),this._formData.append(name,val),this},Request.prototype.attach=function(field,file,filename){return this._formData||(this._formData=new root.FormData),this._formData.append(field,file,filename),this},Request.prototype.send=function(data){var obj=isObject(data),type=this.getHeader("Content-Type");if(obj&&isObject(this._data))for(var key in data)this._data[key]=data[key];else"string"==typeof data?(type||this.type("form"),type=this.getHeader("Content-Type"),"application/x-www-form-urlencoded"==type?this._data=this._data?this._data+"&"+data:data:this._data=(this._data||"")+data):this._data=data;return!obj||isHost(data)?this:(type||this.type("json"),this)},Request.prototype.callback=function(err,res){var fn=this._callback;this.clearTimeout(),fn(err,res)},Request.prototype.crossDomainError=function(){var err=new Error("Origin is not allowed by Access-Control-Allow-Origin");err.crossDomain=!0,this.callback(err)},Request.prototype.timeoutError=function(){var timeout=this._timeout,err=new Error("timeout of "+timeout+"ms exceeded");err.timeout=timeout,this.callback(err)},Request.prototype.withCredentials=function(){return this._withCredentials=!0,this},Request.prototype.end=function(fn){var self=this,xhr=this.xhr=request.getXHR(),query=this._query.join("&"),timeout=this._timeout,data=this._formData||this._data;this._callback=fn||noop,xhr.onreadystatechange=function(){if(4==xhr.readyState){var status;try{status=xhr.status}catch(e){status=0}if(0==status){if(self.timedout)return self.timeoutError();if(self.aborted)return;return self.crossDomainError()}self.emit("end")}};var handleProgress=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),self.emit("progress",e)};this.hasListeners("progress")&&(xhr.onprogress=handleProgress);try{xhr.upload&&this.hasListeners("progress")&&(xhr.upload.onprogress=handleProgress)}catch(e){}if(timeout&&!this._timer&&(this._timer=setTimeout(function(){self.timedout=!0,self.abort()},timeout)),query&&(query=request.serializeObject(query),this.url+=~this.url.indexOf("?")?"&"+query:"?"+query),xhr.open(this.method,this.url,!0),this._withCredentials&&(xhr.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof data&&!isHost(data)){var contentType=this.getHeader("Content-Type"),serialize=request.serialize[contentType?contentType.split(";")[0]:""];serialize&&(data=serialize(data))}for(var field in this.header)null!=this.header[field]&&xhr.setRequestHeader(field,this.header[field]);return this.emit("request",this),xhr.send(data),this},Request.prototype.then=function(fulfill,reject){return this.end(function(err,res){err?reject(err):fulfill(res)})},request.Request=Request,request.get=function(url,data,fn){var req=request("GET",url);return"function"==typeof data&&(fn=data,data=null),data&&req.query(data),fn&&req.end(fn),req},request.head=function(url,data,fn){var req=request("HEAD",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req},request.del=function(url,fn){var req=request("DELETE",url);return fn&&req.end(fn),req},request.patch=function(url,data,fn){var req=request("PATCH",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req},request.post=function(url,data,fn){var req=request("POST",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req},request.put=function(url,data,fn){var req=request("PUT",url);return"function"==typeof data&&(fn=data,data=null),data&&req.send(data),fn&&req.end(fn),req},module.exports=request},{emitter:117,reduce:118}],117:[function(require,module,exports){function Emitter(obj){return obj?mixin(obj):void 0}function mixin(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks[event]=this._callbacks[event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){self.off(event,on),fn.apply(this,arguments)}var self=this;return this._callbacks=this._callbacks||{},on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var callbacks=this._callbacks[event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks[event],this;for(var cb,i=0;i<callbacks.length;i++)if(cb=callbacks[i],cb===fn||cb.fn===fn){callbacks.splice(i,1);break}return this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};var args=[].slice.call(arguments,1),callbacks=this._callbacks[event];if(callbacks){callbacks=callbacks.slice(0);for(var i=0,len=callbacks.length;len>i;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks[event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},{}],118:[function(require,module,exports){module.exports=function(arr,fn,initial){for(var idx=0,len=arr.length,curr=3==arguments.length?initial:arr[idx++];len>idx;)curr=fn.call(null,curr,arr[idx],++idx,arr);return curr}},{}],119:[function(require,module,exports){arguments[4][23][0].apply(exports,arguments)},{dup:23}],120:[function(require,module,exports){arguments[4][24][0].apply(exports,arguments)},{"./handle-dom":121,"./handle-swal-dom":123,"./utils":126,dup:24}],121:[function(require,module,exports){arguments[4][25][0].apply(exports,arguments)},{dup:25}],122:[function(require,module,exports){arguments[4][26][0].apply(exports,arguments)},{"./handle-dom":121,"./handle-swal-dom":123,dup:26}],123:[function(require,module,exports){arguments[4][27][0].apply(exports,arguments)},{"./default-params":119,"./handle-dom":121,"./injected-html":124,"./utils":126,dup:27}],124:[function(require,module,exports){arguments[4][28][0].apply(exports,arguments)},{dup:28}],125:[function(require,module,exports){arguments[4][29][0].apply(exports,arguments)},{"./handle-dom":121,"./handle-swal-dom":123,"./utils":126,dup:29}],126:[function(require,module,exports){arguments[4][30][0].apply(exports,arguments)},{dup:30}],127:[function(require,module,exports){arguments[4][31][0].apply(exports,arguments)},{"./modules/default-params":119,"./modules/handle-click":120,"./modules/handle-dom":121,"./modules/handle-key":122,"./modules/handle-swal-dom":123,"./modules/set-params":125,"./modules/utils":126,dup:31}],128:[function(require,module,exports){var assetUrl,imgUrl,siteUrl,url;url="asset.framesia.com",siteUrl="http://framesia.com/",assetUrl="http://"+url+"/asset/frms/",imgUrl="http://"+url+"/fr-img/",module.exports={siteUrl:siteUrl,assetUrl:assetUrl,imgUrl:imgUrl}},{}],129:[function(require,module,exports){(function(global){!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.jade=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function nulls(val){return null!=val&&""!==val}function joinClasses(val){return(Array.isArray(val)?val.map(joinClasses):val&&"object"==typeof val?Object.keys(val).filter(function(key){return val[key]}):[val]).filter(nulls).join(" ")}exports.merge=function merge(a,b){if(1===arguments.length){for(var attrs=a[0],i=1;i<a.length;i++)attrs=merge(attrs,a[i]);return attrs}var ac=a["class"],bc=b["class"];(ac||bc)&&(ac=ac||[],bc=bc||[],Array.isArray(ac)||(ac=[ac]),Array.isArray(bc)||(bc=[bc]),a["class"]=ac.concat(bc).filter(nulls));for(var key in b)"class"!=key&&(a[key]=b[key]);return a},exports.joinClasses=joinClasses,exports.cls=function(classes,escaped){for(var buf=[],i=0;i<classes.length;i++)escaped&&escaped[i]?buf.push(exports.escape(joinClasses([classes[i]]))):buf.push(joinClasses(classes[i]));var text=joinClasses(buf);return text.length?' class="'+text+'"':""},exports.style=function(val){return val&&"object"==typeof val?Object.keys(val).map(function(style){return style+":"+val[style]}).join(";"):val},exports.attr=function(key,val,escaped,terse){return"style"===key&&(val=exports.style(val)),"boolean"==typeof val||null==val?val?" "+(terse?key:key+'="'+key+'"'):"":0==key.indexOf("data")&&"string"!=typeof val?(-1!==JSON.stringify(val).indexOf("&")&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),val&&"function"==typeof val.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+key+"='"+JSON.stringify(val).replace(/'/g,"&apos;")+"'"):escaped?(val&&"function"==typeof val.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+key+'="'+exports.escape(val)+'"'):(val&&"function"==typeof val.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+key+'="'+val+'"')},exports.attrs=function(obj,terse){var buf=[],keys=Object.keys(obj);if(keys.length)for(var i=0;i<keys.length;++i){var key=keys[i],val=obj[key];"class"==key?(val=joinClasses(val))&&buf.push(" "+key+'="'+val+'"'):buf.push(exports.attr(key,val,!1,terse))}return buf.join("")},exports.escape=function(html){var result=String(html).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;");return result===""+html?html:result},exports.rethrow=function rethrow(err,filename,lineno,str){if(!(err instanceof Error))throw err;if(!("undefined"==typeof window&&filename||str))throw err.message+=" on line "+lineno,err;try{str=str||require("fs").readFileSync(filename,"utf8")}catch(ex){rethrow(err,null,lineno)}var context=3,lines=str.split("\n"),start=Math.max(lineno-context,0),end=Math.min(lines.length,lineno+context),context=lines.slice(start,end).map(function(line,i){var curr=i+start+1;return(curr==lineno?"  > ":"    ")+curr+"| "+line}).join("\n");throw err.path=filename,err.message=(filename||"Jade")+":"+lineno+"\n"+context+"\n\n"+err.message,err}},{fs:2}],2:[function(require,module,exports){},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{fs:1}],130:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(IMG_URL,collections,undefined){collections&&function(){var $$obj=collections;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var collection=$$obj[$index];buf.push('<br/><span height="100%" class="i-user__ava--sq"><img'+jade.attr("src",""+IMG_URL+"col/"+collection._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--footer__name text-green"><a'+jade.attr("href","/c/"+collection.username,!0,!1)+">"+jade.escape(null==(jade_interp=collection.name)?"":jade_interp)+'</a></span><p class="i-user--footer__desc">'+jade.escape(null==(jade_interp=collection.description)?"":jade_interp)+'</p><p class="i-user--footer__username"><a'+jade.attr("href","/c/"+collection.username,!0,!1)+">/"+jade.escape(null==(jade_interp=collection.username)?"":jade_interp)+'</a></p><div class="divider"></div><br/>')}else{var $$l=0;for(var $index in $$obj){$$l++;var collection=$$obj[$index];buf.push('<br/><span height="100%" class="i-user__ava--sq"><img'+jade.attr("src",""+IMG_URL+"col/"+collection._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--footer__name text-green"><a'+jade.attr("href","/c/"+collection.username,!0,!1)+">"+jade.escape(null==(jade_interp=collection.name)?"":jade_interp)+'</a></span><p class="i-user--footer__desc">'+jade.escape(null==(jade_interp=collection.description)?"":jade_interp)+'</p><p class="i-user--footer__username"><a'+jade.attr("href","/c/"+collection.username,!0,!1)+">/"+jade.escape(null==(jade_interp=collection.username)?"":jade_interp)+'</a></p><div class="divider"></div><br/>')}}}.call(this)}.call(this,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"collections"in locals_for_with?locals_for_with.collections:"undefined"!=typeof collections?collections:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],131:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],jade_mixins={},locals_for_with=locals||{};return function(Date,IMG_URL,Math,__,__n,comments,is_login,undefined){jade_mixins.time=jade_interp=function(date){this&&this.block,this&&this.attributes||{};date=new Date(date);var monthList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],seconds=Math.floor((1*new Date-1*date)/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24),month=monthList[date.getMonth()],year=date.getFullYear(),date=date.getDate();
days>7?buf.push("<span>at "+jade.escape(null==(jade_interp=date)?"":jade_interp)+" "+jade.escape(null==(jade_interp=month)?"":jade_interp)+" "+jade.escape(null==(jade_interp=year)?"":jade_interp)+"</span>"):days>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d day ago","%d days ago",days))?"":jade_interp)+"</span>"):hours>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d hour ago","%d hours ago",hours))?"":jade_interp)+"</span>"):minutes>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d minute ago","%d minutes ago",minutes))?"":jade_interp)+"</span>"):buf.push("<span>"+jade.escape(null==(jade_interp=__("Just now"))?"":jade_interp)+"</span>")},function(){var $$obj=comments;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var comment=$$obj[$index];buf.push("<div"+jade.attr("id",""+comment._id,!0,!1)+' class="b-comment__item"><div class="i-user--inline"><span class="i-user--inline__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+comment.user._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--inline__name"><a'+jade.attr("href","/"+comment.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=comment.user.name)?"":jade_interp)+'</a></span><span class="b-comment__date i-user--inline__mod">'),jade_mixins.time(comment.created_at),buf.push("</span></div>"),comment.is_published||buf.push('<button class="i-button i-button--small i-button--w-green pull-right is-private">Private</button>'),buf.push('<div class="b-comment__content">'+(null==(jade_interp=comment.content.replace(/@([a-z0-9_]{3,16})/g,"<a href='/$1'>@$1</a>"))?"":jade_interp)+'<div class="b-post__button-wrap">'),is_login?(buf.push("<button"+jade.attr("data-comment-id",""+comment._id,!0,!1)+jade.cls(["b-post__button","js-comment-love",""+(comment.is_loving?"is-loving":"")],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=comment.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button><button'+jade.attr("data-username",""+comment.user.username,!0,!1)+jade.attr("data-comment-id",""+comment._id,!0,!1)+' class="b-post__button js-comment-reply"><i class="f-icon-reply"></i></button>'),comment.is_yours&&buf.push("<button"+jade.attr("data-comment-id",""+comment._id,!0,!1)+' class="b-post__button i-button--small js-comment-delete pull-right"><i class="icon-del"></i></button>')):buf.push('<button class="b-post__button"><b>'+jade.escape(null==(jade_interp=comment.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button>'),buf.push("</div></div></div>")}else{var $$l=0;for(var $index in $$obj){$$l++;var comment=$$obj[$index];buf.push("<div"+jade.attr("id",""+comment._id,!0,!1)+' class="b-comment__item"><div class="i-user--inline"><span class="i-user--inline__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+comment.user._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--inline__name"><a'+jade.attr("href","/"+comment.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=comment.user.name)?"":jade_interp)+'</a></span><span class="b-comment__date i-user--inline__mod">'),jade_mixins.time(comment.created_at),buf.push("</span></div>"),comment.is_published||buf.push('<button class="i-button i-button--small i-button--w-green pull-right is-private">Private</button>'),buf.push('<div class="b-comment__content">'+(null==(jade_interp=comment.content.replace(/@([a-z0-9_]{3,16})/g,"<a href='/$1'>@$1</a>"))?"":jade_interp)+'<div class="b-post__button-wrap">'),is_login?(buf.push("<button"+jade.attr("data-comment-id",""+comment._id,!0,!1)+jade.cls(["b-post__button","js-comment-love",""+(comment.is_loving?"is-loving":"")],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=comment.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button><button'+jade.attr("data-username",""+comment.user.username,!0,!1)+jade.attr("data-comment-id",""+comment._id,!0,!1)+' class="b-post__button js-comment-reply"><i class="f-icon-reply"></i></button>'),comment.is_yours&&buf.push("<button"+jade.attr("data-comment-id",""+comment._id,!0,!1)+' class="b-post__button i-button--small js-comment-delete pull-right"><i class="icon-del"></i></button>')):buf.push('<button class="b-post__button"><b>'+jade.escape(null==(jade_interp=comment.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button>'),buf.push("</div></div></div>")}}}.call(this)}.call(this,"Date"in locals_for_with?locals_for_with.Date:"undefined"!=typeof Date?Date:void 0,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"Math"in locals_for_with?locals_for_with.Math:"undefined"!=typeof Math?Math:void 0,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"__n"in locals_for_with?locals_for_with.__n:"undefined"!=typeof __n?__n:void 0,"comments"in locals_for_with?locals_for_with.comments:"undefined"!=typeof comments?comments:void 0,"is_login"in locals_for_with?locals_for_with.is_login:"undefined"!=typeof is_login?is_login:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],132:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],jade_mixins={},locals_for_with=locals||{};return function(Date,IMG_URL,Math,__,__n,notifs,undefined){jade_mixins.time=jade_interp=function(date){this&&this.block,this&&this.attributes||{};date=new Date(date);var monthList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],seconds=Math.floor((1*new Date-1*date)/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24),month=monthList[date.getMonth()],year=date.getFullYear(),date=date.getDate();days>7?buf.push("<span>at "+jade.escape(null==(jade_interp=date)?"":jade_interp)+" "+jade.escape(null==(jade_interp=month)?"":jade_interp)+" "+jade.escape(null==(jade_interp=year)?"":jade_interp)+"</span>"):days>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d day ago","%d days ago",days))?"":jade_interp)+"</span>"):hours>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d hour ago","%d hours ago",hours))?"":jade_interp)+"</span>"):minutes>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d minute ago","%d minutes ago",minutes))?"":jade_interp)+"</span>"):buf.push("<span>"+jade.escape(null==(jade_interp=__("Just now"))?"":jade_interp)+"</span>")},function(){var $$obj=notifs;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var notif=$$obj[$index],url="",text="",data="";switch(notif.notif_type){case"love-post":url="/p/"+notif.object.post_id.slug,text=__("loved your article"),data=notif.object.post_id.title;break;case"love-comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("loved your comment"),data=notif.object.comment_id.content;break;case"follow":url="/u/"+notif.from.username,text=__("following you");break;case"comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("commented your article"),data=notif.object.comment_id.content;break;case"mention-comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("mentioned you"),data=notif.object.comment_id.content;break;case"repost":url="/p/"+notif.object.post_id.slug,text=__("reposted your article"),data=notif.object.post_id.title;break;case"respond":url="/p/"+notif.object.post_id.slug,text=__("responded your article"),data=notif.object.post_id.title;break;case"":url="/p/"+notif.object.post_id.slug,text=__("responded your article"),data=notif.object.post_id.title}buf.push("<div"+jade.attr("data-notif-id",""+notif._id,!0,!1)+jade.cls(["b-notif__item",""+(1==notif.is_read?"is-read":"")],[null,!0])+"><a"+jade.attr("href",""+url,!0,!1)+'><span class="i-user--inline__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+notif.from._id+"-50.jpg",!0,!1)+'/></span><span class="b-notif__user">'+jade.escape(null==(jade_interp=notif.from.name)?"":jade_interp)+" </span><span> "+jade.escape(null==(jade_interp=text)?"":jade_interp)+"</span><span> &middot;  </span>"),jade_mixins.time(notif.created_at),buf.push('<br/><div class="b-notif__data"><b>'+jade.escape(null==(jade_interp=data)?"":jade_interp)+'</b></div><div class="clear"></div></a></div>')}else{var $$l=0;for(var $index in $$obj){$$l++;var notif=$$obj[$index],url="",text="",data="";switch(notif.notif_type){case"love-post":url="/p/"+notif.object.post_id.slug,text=__("loved your article"),data=notif.object.post_id.title;break;case"love-comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("loved your comment"),data=notif.object.comment_id.content;break;case"follow":url="/u/"+notif.from.username,text=__("following you");break;case"comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("commented your article"),data=notif.object.comment_id.content;break;case"mention-comment":url="/p/"+notif.object.post_id.slug+"?comment="+notif.object.comment_id,text=__("mentioned you"),data=notif.object.comment_id.content;break;case"repost":url="/p/"+notif.object.post_id.slug,text=__("reposted your article"),data=notif.object.post_id.title;break;case"respond":url="/p/"+notif.object.post_id.slug,text=__("responded your article"),data=notif.object.post_id.title;break;case"":url="/p/"+notif.object.post_id.slug,text=__("responded your article"),data=notif.object.post_id.title}buf.push("<div"+jade.attr("data-notif-id",""+notif._id,!0,!1)+jade.cls(["b-notif__item",""+(1==notif.is_read?"is-read":"")],[null,!0])+"><a"+jade.attr("href",""+url,!0,!1)+'><span class="i-user--inline__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+notif.from._id+"-50.jpg",!0,!1)+'/></span><span class="b-notif__user">'+jade.escape(null==(jade_interp=notif.from.name)?"":jade_interp)+" </span><span> "+jade.escape(null==(jade_interp=text)?"":jade_interp)+"</span><span> &middot;  </span>"),jade_mixins.time(notif.created_at),buf.push('<br/><div class="b-notif__data"><b>'+jade.escape(null==(jade_interp=data)?"":jade_interp)+'</b></div><div class="clear"></div></a></div>')}}}.call(this)}.call(this,"Date"in locals_for_with?locals_for_with.Date:"undefined"!=typeof Date?Date:void 0,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"Math"in locals_for_with?locals_for_with.Math:"undefined"!=typeof Math?Math:void 0,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"__n"in locals_for_with?locals_for_with.__n:"undefined"!=typeof __n?__n:void 0,"notifs"in locals_for_with?locals_for_with.notifs:"undefined"!=typeof notifs?notifs:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],133:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],jade_mixins={},locals_for_with=locals||{};return function(Date,Math,__,__n,post,undefined){jade_mixins.time=jade_interp=function(date){this&&this.block,this&&this.attributes||{};date=new Date(date);var monthList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],seconds=Math.floor((1*new Date-1*date)/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24),month=monthList[date.getMonth()],year=date.getFullYear(),date=date.getDate();days>7?buf.push("<span>at "+jade.escape(null==(jade_interp=date)?"":jade_interp)+" "+jade.escape(null==(jade_interp=month)?"":jade_interp)+" "+jade.escape(null==(jade_interp=year)?"":jade_interp)+"</span>"):days>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d day ago","%d days ago",days))?"":jade_interp)+"</span>"):hours>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d hour ago","%d hours ago",hours))?"":jade_interp)+"</span>"):minutes>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d minute ago","%d minutes ago",minutes))?"":jade_interp)+"</span>"):buf.push("<span>"+jade.escape(null==(jade_interp=__("Just now"))?"":jade_interp)+"</span>")},function(){var $$obj=post;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var item=$$obj[$index];buf.push("<div"+jade.attr("data-edited-at",""+item.edited_at,!0,!1)+' class="b-post__item"><div class="i-user__mod"><span>'+jade.escape(null==(jade_interp=__("Created at"))?"":jade_interp)+" "),jade_mixins.time(item.created_at),buf.push("</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span><span>"+jade.escape(null==(jade_interp=__("Last edited at"))?"":jade_interp)+" "),jade_mixins.time(item.edited_at),buf.push("</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span><span>"+jade.escape(null==(jade_interp=item.word_count)?"":jade_interp)+" "+jade.escape(null==(jade_interp=__("words"))?"":jade_interp)+"</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>");var readTime=Math.round(item.reading_time/6e4);buf.push("<span>"+jade.escape(null==(jade_interp=0==readTime?1:readTime)?"":jade_interp)+" "+jade.escape(null==(jade_interp=__("min read"))?"":jade_interp)+"</span><br/><br/></div><a"+jade.attr("href","/p/"+item._id,!0,!1)+'><h2 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h2><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+"</p></a><a"+jade.attr("href","/p/"+item._id+"/edit",!0,!1)+'><button class="i-button i-button--small i-button--w-blue">'+jade.escape(null==(jade_interp=__("Edit"))?"":jade_interp)+"</button></a>"),item.is_published||buf.push('<button class="i-button i-button--small i-button--w-green js-publish-article">'+jade.escape(null==(jade_interp=__("Publish"))?"":jade_interp)+"</button>"),buf.push('<button class="i-button i-button--small i-button--w-red pull-right js-delete-article">'+jade.escape(null==(jade_interp=__("Delete"))?"":jade_interp)+'</button><form method="POST" action="/p/delete-article" class="js-delete-article-form"><input name="id" type="hidden"'+jade.attr("value",""+item._id,!0,!1)+"/>"),item.is_published?buf.push('<input name="url" type="hidden" value="/me/articles"/>'):buf.push('<input name="url" type="hidden" value="/me/drafts"/>'),buf.push("</form>"),item.is_published||buf.push('<form method="POST" action="/p/publish-article" class="js-publish-article-form"><input name="id" type="hidden"'+jade.attr("value",""+item._id,!0,!1)+"/></form>"),buf.push("</div>")}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<div"+jade.attr("data-edited-at",""+item.edited_at,!0,!1)+' class="b-post__item"><div class="i-user__mod"><span>'+jade.escape(null==(jade_interp=__("Created at"))?"":jade_interp)+" "),jade_mixins.time(item.created_at),buf.push("</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span><span>"+jade.escape(null==(jade_interp=__("Last edited at"))?"":jade_interp)+" "),jade_mixins.time(item.edited_at),buf.push("</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span><span>"+jade.escape(null==(jade_interp=item.word_count)?"":jade_interp)+" "+jade.escape(null==(jade_interp=__("words"))?"":jade_interp)+"</span><span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>");var readTime=Math.round(item.reading_time/6e4);buf.push("<span>"+jade.escape(null==(jade_interp=0==readTime?1:readTime)?"":jade_interp)+" "+jade.escape(null==(jade_interp=__("min read"))?"":jade_interp)+"</span><br/><br/></div><a"+jade.attr("href","/p/"+item._id,!0,!1)+'><h2 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h2><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+"</p></a><a"+jade.attr("href","/p/"+item._id+"/edit",!0,!1)+'><button class="i-button i-button--small i-button--w-blue">'+jade.escape(null==(jade_interp=__("Edit"))?"":jade_interp)+"</button></a>"),item.is_published||buf.push('<button class="i-button i-button--small i-button--w-green js-publish-article">'+jade.escape(null==(jade_interp=__("Publish"))?"":jade_interp)+"</button>"),buf.push('<button class="i-button i-button--small i-button--w-red pull-right js-delete-article">'+jade.escape(null==(jade_interp=__("Delete"))?"":jade_interp)+'</button><form method="POST" action="/p/delete-article" class="js-delete-article-form"><input name="id" type="hidden"'+jade.attr("value",""+item._id,!0,!1)+"/>"),item.is_published?buf.push('<input name="url" type="hidden" value="/me/articles"/>'):buf.push('<input name="url" type="hidden" value="/me/drafts"/>'),buf.push("</form>"),item.is_published||buf.push('<form method="POST" action="/p/publish-article" class="js-publish-article-form"><input name="id" type="hidden"'+jade.attr("value",""+item._id,!0,!1)+"/></form>"),buf.push("</div>")}}}.call(this)}.call(this,"Date"in locals_for_with?locals_for_with.Date:"undefined"!=typeof Date?Date:void 0,"Math"in locals_for_with?locals_for_with.Math:"undefined"!=typeof Math?Math:void 0,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"__n"in locals_for_with?locals_for_with.__n:"undefined"!=typeof __n?__n:void 0,"post"in locals_for_with?locals_for_with.post:"undefined"!=typeof post?post:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],134:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],jade_mixins={},locals_for_with=locals||{};return function(Date,IMG_URL,Math,__,__n,post,undefined){jade_mixins.time=jade_interp=function(date){this&&this.block,this&&this.attributes||{};date=new Date(date);var monthList=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],seconds=Math.floor((1*new Date-1*date)/1e3),minutes=Math.floor(seconds/60),hours=Math.floor(minutes/60),days=Math.floor(hours/24),month=monthList[date.getMonth()],year=date.getFullYear(),date=date.getDate();days>7?buf.push("<span>at "+jade.escape(null==(jade_interp=date)?"":jade_interp)+" "+jade.escape(null==(jade_interp=month)?"":jade_interp)+" "+jade.escape(null==(jade_interp=year)?"":jade_interp)+"</span>"):days>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d day ago","%d days ago",days))?"":jade_interp)+"</span>"):hours>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d hour ago","%d hours ago",hours))?"":jade_interp)+"</span>"):minutes>=1?buf.push("<span>"+jade.escape(null==(jade_interp=__n("%d minute ago","%d minutes ago",minutes))?"":jade_interp)+"</span>"):buf.push("<span>"+jade.escape(null==(jade_interp=__("Just now"))?"":jade_interp)+"</span>")},jade_mixins.read=jade_interp=function(reading_time){var readTime=(this&&this.block,this&&this.attributes||{},(reading_time/6e4).toFixed(1));buf.push("<span>"+jade.escape(null==(jade_interp=readTime)?"":jade_interp)+" "+jade.escape(null==(jade_interp=__("min read"))?"":jade_interp)+"</span>")},function(){var $$obj=post;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var item=$$obj[$index];buf.push("<div"+jade.attr("data-published-at",""+item.published_at,!0,!1)+' class="b-post__item">'),1==item.is_repost?(buf.push('<div class="b-post__head"><div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span>  <i class="f-icon-repost"></i> '+jade.escape(null==(jade_interp=__("suggested"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.repost.reading_time),buf.push('</span><div class="clear"></div></div></div><div class="b-post__repost"><a'+jade.attr("href","/p/"+item.repost.slug,!0,!1)+'><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.repost.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.repost.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.repost.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.repost.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.repost.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div><div class="clear"></div>')):1==item.is_response?(buf.push('<div class="b-post__head"><div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span>  <i class="f-icon-reply"></i> '+jade.escape(null==(jade_interp=__("responded"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.reading_time),buf.push('</span><div class="clear"></div></div></div><div class="b-post__response"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-post__response__content"><h3 class="b-post__title">'+(null==(jade_interp=item.response.title)?"":jade_interp)+'</h3><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.response.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.response.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.response.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div>'),item.is_cover&&buf.push('<div class="b-post__right"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"post/"+item._id+"-cover.jpg",!0,!1)+' alt="" class="b-post__cover"/></a></div>'),buf.push("<div"+jade.cls(["b-post__left",item.is_cover?"":"is-full"],[null,!0])+"><a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p></a><div class="b-post__button-wrap"><button'+jade.attr("data-article-id",""+item._id,!0,!1)+jade.cls(["b-post__button","js-article-love",item.is_loving?"is-loving":""],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=item.love_count)?"":jade_interp)+'</b><i class="f-icon-love">        </i></button></div></div><div class="clear"></div>')):(buf.push('<div class="b-post__head">'),item.from_collection&&item.from_collection.length>0&&(buf.push('<div class="b-post__from">'),function(){var $$obj=item.from_collection;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var col=$$obj[$index];buf.push("<a"+jade.attr("href","/c/"+col.username,!0,!1)+'><i class="f-icon-book"></i><b>'+jade.escape(null==(jade_interp=col.name)?"":jade_interp)+"</b></a>")}else{var $$l=0;for(var $index in $$obj){$$l++;var col=$$obj[$index];buf.push("<a"+jade.attr("href","/c/"+col.username,!0,!1)+'><i class="f-icon-book"></i><b>'+jade.escape(null==(jade_interp=col.name)?"":jade_interp)+"</b></a>")}}}.call(this),buf.push("</div>")),buf.push('<div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span> '+jade.escape(null==(jade_interp=__("published"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.reading_time),buf.push('</span><div class="clear"></div></div></div>'),item.is_cover&&buf.push('<div class="b-post__right"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"post/"+item._id+"-cover.jpg",!0,!1)+' alt="" class="b-post__cover"/></a></div>'),buf.push("<div"+jade.cls(["b-post__left",item.is_cover?"":"is-full"],[null,!0])+"><a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p></a><div class="b-post__button-wrap"><button'+jade.attr("data-article-id",""+item._id,!0,!1)+jade.cls(["b-post__button","js-article-love",item.is_loving?"is-loving":""],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=item.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button></div></div><div class="clear"></div>')),buf.push("</div>")}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<div"+jade.attr("data-published-at",""+item.published_at,!0,!1)+' class="b-post__item">'),1==item.is_repost?(buf.push('<div class="b-post__head"><div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span>  <i class="f-icon-repost"></i> '+jade.escape(null==(jade_interp=__("suggested"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.repost.reading_time),buf.push('</span><div class="clear"></div></div></div><div class="b-post__repost"><a'+jade.attr("href","/p/"+item.repost.slug,!0,!1)+'><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.repost.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.repost.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.repost.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.repost.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.repost.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div><div class="clear"></div>')):1==item.is_response?(buf.push('<div class="b-post__head"><div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span>  <i class="f-icon-reply"></i> '+jade.escape(null==(jade_interp=__("responded"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.reading_time),buf.push('</span><div class="clear"></div></div></div><div class="b-post__response"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-post__response__content"><h3 class="b-post__title">'+(null==(jade_interp=item.response.title)?"":jade_interp)+'</h3><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.response.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.response.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.response.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div>'),item.is_cover&&buf.push('<div class="b-post__right"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"post/"+item._id+"-cover.jpg",!0,!1)+' alt="" class="b-post__cover"/></a></div>'),buf.push("<div"+jade.cls(["b-post__left",item.is_cover?"":"is-full"],[null,!0])+"><a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p></a><div class="b-post__button-wrap"><button'+jade.attr("data-article-id",""+item._id,!0,!1)+jade.cls(["b-post__button","js-article-love",item.is_loving?"is-loving":""],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=item.love_count)?"":jade_interp)+'</b><i class="f-icon-love">        </i></button></div></div><div class="clear"></div>')):(buf.push('<div class="b-post__head">'),item.from_collection&&item.from_collection.length>0&&(buf.push('<div class="b-post__from">'),function(){var $$obj=item.from_collection;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var col=$$obj[$index];buf.push("<a"+jade.attr("href","/c/"+col.username,!0,!1)+'><i class="f-icon-book"></i><b>'+jade.escape(null==(jade_interp=col.name)?"":jade_interp)+"</b></a>")}else{var $$l=0;for(var $index in $$obj){$$l++;var col=$$obj[$index];buf.push("<a"+jade.attr("href","/c/"+col.username,!0,!1)+'><i class="f-icon-book"></i><b>'+jade.escape(null==(jade_interp=col.name)?"":jade_interp)+"</b></a>")}}}.call(this),buf.push("</div>")),buf.push('<div class="i-user--inline"><span class="i-user--inline__ava"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"ava/"+item.user._id+"-50.jpg",!0,!1)+'/></a></span><span class="i-user--inline__name"><a'+jade.attr("href","/u/"+item.user.username,!0,!1)+">"+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</a></span><span class="i-user--inline__mod"><span> '+jade.escape(null==(jade_interp=__("published"))?"":jade_interp)+"  </span>"),jade_mixins.time(item.published_at),buf.push("<span>&nbsp;&nbsp;&middot;&nbsp;&nbsp;</span>"),jade_mixins.read(item.reading_time),buf.push('</span><div class="clear"></div></div></div>'),item.is_cover&&buf.push('<div class="b-post__right"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+"><img"+jade.attr("src",""+IMG_URL+"post/"+item._id+"-cover.jpg",!0,!1)+' alt="" class="b-post__cover"/></a></div>'),buf.push("<div"+jade.cls(["b-post__left",item.is_cover?"":"is-full"],[null,!0])+"><a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p></a><div class="b-post__button-wrap"><button'+jade.attr("data-article-id",""+item._id,!0,!1)+jade.cls(["b-post__button","js-article-love",item.is_loving?"is-loving":""],[null,null,!0])+"><b>"+jade.escape(null==(jade_interp=item.love_count)?"":jade_interp)+'</b><i class="f-icon-love"></i></button></div></div><div class="clear"></div>')),buf.push("</div>")}}}.call(this)}.call(this,"Date"in locals_for_with?locals_for_with.Date:"undefined"!=typeof Date?Date:void 0,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"Math"in locals_for_with?locals_for_with.Math:"undefined"!=typeof Math?Math:void 0,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"__n"in locals_for_with?locals_for_with.__n:"undefined"!=typeof __n?__n:void 0,"post"in locals_for_with?locals_for_with.post:"undefined"!=typeof post?post:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],135:[function(require,module,exports){var jade=require("jade/runtime");
module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(__,post,undefined){(function(){var $$obj=post;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var item=$$obj[$index];buf.push("<div"+jade.attr("data-love-id",""+item.loveId,!0,!1)+' class="b-post__item"><div class="b-post__repost"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div><div class="clear"></div></div>')}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<div"+jade.attr("data-love-id",""+item.loveId,!0,!1)+' class="b-post__item"><div class="b-post__repost"><a'+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></a></div><div class="clear"></div></div>')}}}).call(this)}.call(this,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"post"in locals_for_with?locals_for_with.post:"undefined"!=typeof post?post:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],136:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(post,undefined){(function(){var $$obj=post;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var item=$$obj[$index];buf.push("<a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-notif__item"><h5 class="b-notif__title">'+jade.escape(null==(jade_interp=item.title)?"":jade_interp)+'</h5><p class="b-notif__subtitle">'+jade.escape(null==(jade_interp=item.subtitle)?"":jade_interp)+"</p><a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><div class="b-notif__user">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+' </div></a><div class="clear"></div></div></a>')}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<a"+jade.attr("href","/p/"+item.slug,!0,!1)+'><div class="b-notif__item"><h5 class="b-notif__title">'+jade.escape(null==(jade_interp=item.title)?"":jade_interp)+'</h5><p class="b-notif__subtitle">'+jade.escape(null==(jade_interp=item.subtitle)?"":jade_interp)+"</p><a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><div class="b-notif__user">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+' </div></a><div class="clear"></div></div></a>')}}}).call(this)}.call(this,"post"in locals_for_with?locals_for_with.post:"undefined"!=typeof post?post:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],137:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(IMG_URL,__,post,undefined){(function(){var $$obj=post;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var item=$$obj[$index];buf.push("<a"+jade.attr("href","/p/"+item.slug,!0,!1)+jade.attr("data-published-at",""+item.published_at,!0,!1)+'><div class="b-post__repost--half">'),1==item.is_cover&&buf.push('<div class="is-half img"><img'+jade.attr("src",""+IMG_URL+"/post/"+item._id+"-medium-cover.jpg",!0,!1)+"/></div>"),buf.push('<div class="is-half"><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></div><div class="clear"></div></div><div class="clear"></div></a>')}else{var $$l=0;for(var $index in $$obj){$$l++;var item=$$obj[$index];buf.push("<a"+jade.attr("href","/p/"+item.slug,!0,!1)+jade.attr("data-published-at",""+item.published_at,!0,!1)+'><div class="b-post__repost--half">'),1==item.is_cover&&buf.push('<div class="is-half img"><img'+jade.attr("src",""+IMG_URL+"/post/"+item._id+"-medium-cover.jpg",!0,!1)+"/></div>"),buf.push('<div class="is-half"><div class="b-post__repost__content"><h3 class="b-post__title">'+(null==(jade_interp=item.title)?"":jade_interp)+'</h3><p class="b-post__subtitle">'+(null==(jade_interp=item.subtitle)?"":jade_interp)+'</p><p class="i-user--inline i-user--inline__mod">'+jade.escape(null==(jade_interp=__("By"))?"":jade_interp)+"  <a"+jade.attr("href","/u/"+item.user.username,!0,!1)+'><span class="text-red">'+jade.escape(null==(jade_interp=item.user.name)?"":jade_interp)+'</span></a><span style="margin:5px">&middot;</span><b>'+jade.escape(null==(jade_interp=item.love_count||0)?"":jade_interp)+' <span class="text-red">&#9825;</span></b></p></div></div><div class="clear"></div></div><div class="clear"></div></a>')}}}).call(this),buf.push("")}.call(this,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"__"in locals_for_with?locals_for_with.__:"undefined"!=typeof __?__:void 0,"post"in locals_for_with?locals_for_with.post:"undefined"!=typeof post?post:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],138:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(tags,undefined){buf.push('<div class="tag-col is-center">'),function(){var $$obj=tags;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var tag=$$obj[$index];buf.push("<a"+jade.attr("href","/s?q="+tag._id+"&type=topic",!0,!1)+'><div class="nsg-tag">'+jade.escape(null==(jade_interp=tag._id)?"":jade_interp)+"  </div></a>")}else{var $$l=0;for(var $index in $$obj){$$l++;var tag=$$obj[$index];buf.push("<a"+jade.attr("href","/s?q="+tag._id+"&type=topic",!0,!1)+'><div class="nsg-tag">'+jade.escape(null==(jade_interp=tag._id)?"":jade_interp)+"  </div></a>")}}}.call(this),buf.push("</div>")}.call(this,"tags"in locals_for_with?locals_for_with.tags:"undefined"!=typeof tags?tags:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0),buf.join("")}},{"jade/runtime":129}],139:[function(require,module,exports){var jade=require("jade/runtime");module.exports=function(locals){var jade_interp,buf=[],locals_for_with=locals||{};return function(IMG_URL,undefined,users){users&&function(){var $$obj=users;if("number"==typeof $$obj.length)for(var $index=0,$$l=$$obj.length;$$l>$index;$index++){var user=$$obj[$index];buf.push('<br/><span height="100%" class="i-user__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+user._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--footer__name text-red"><a'+jade.attr("href","/u/"+user.username,!0,!1)+">"+jade.escape(null==(jade_interp=user.name)?"":jade_interp)+'</a></span><p class="i-user--footer__desc">'+jade.escape(null==(jade_interp=user.description)?"":jade_interp)+'</p><p class="i-user--footer__username"><a'+jade.attr("href","/u/"+user.username,!0,!1)+">/"+jade.escape(null==(jade_interp=user.username)?"":jade_interp)+'</a></p><div class="divider"></div><br/>')}else{var $$l=0;for(var $index in $$obj){$$l++;var user=$$obj[$index];buf.push('<br/><span height="100%" class="i-user__ava"><img'+jade.attr("src",""+IMG_URL+"ava/"+user._id+"-50.jpg",!0,!1)+'/></span><span class="i-user--footer__name text-red"><a'+jade.attr("href","/u/"+user.username,!0,!1)+">"+jade.escape(null==(jade_interp=user.name)?"":jade_interp)+'</a></span><p class="i-user--footer__desc">'+jade.escape(null==(jade_interp=user.description)?"":jade_interp)+'</p><p class="i-user--footer__username"><a'+jade.attr("href","/u/"+user.username,!0,!1)+">/"+jade.escape(null==(jade_interp=user.username)?"":jade_interp)+'</a></p><div class="divider"></div><br/>')}}}.call(this)}.call(this,"IMG_URL"in locals_for_with?locals_for_with.IMG_URL:"undefined"!=typeof IMG_URL?IMG_URL:void 0,"undefined"in locals_for_with?locals_for_with.undefined:void 0,"users"in locals_for_with?locals_for_with.users:"undefined"!=typeof users?users:void 0),buf.join("")}},{"jade/runtime":129}]},{},[69]);